(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[9897],{"./public/app/plugins/datasource/elasticsearch/module.ts":(e,t,s)=>{"use strict";s.r(t),s.d(t,{plugin:()=>Ns});var r=s("./packages/grafana-data/src/index.ts"),n=s("./.yarn/cache/lodash-npm-4.17.21-6382451519-eb835a2e51.zip/node_modules/lodash/lodash.js"),i=s("./.yarn/cache/rxjs-npm-7.5.1-ce59cbb6a3-78e3eecb16.zip/node_modules/rxjs/dist/esm5/internal/lastValueFrom.js"),a=s("./.yarn/cache/rxjs-npm-7.5.1-ce59cbb6a3-78e3eecb16.zip/node_modules/rxjs/dist/esm5/internal/observable/throwError.js"),l=s("./.yarn/cache/rxjs-npm-7.5.1-ce59cbb6a3-78e3eecb16.zip/node_modules/rxjs/dist/esm5/internal/observable/generate.js"),o=s("./.yarn/cache/rxjs-npm-7.5.1-ce59cbb6a3-78e3eecb16.zip/node_modules/rxjs/dist/esm5/internal/observable/of.js"),c=s("./.yarn/cache/rxjs-npm-7.5.1-ce59cbb6a3-78e3eecb16.zip/node_modules/rxjs/dist/esm5/internal/operators/map.js"),d=s("./.yarn/cache/rxjs-npm-7.5.1-ce59cbb6a3-78e3eecb16.zip/node_modules/rxjs/dist/esm5/internal/operators/catchError.js"),u=s("./.yarn/cache/rxjs-npm-7.5.1-ce59cbb6a3-78e3eecb16.zip/node_modules/rxjs/dist/esm5/internal/operators/mergeMap.js"),m=s("./.yarn/cache/rxjs-npm-7.5.1-ce59cbb6a3-78e3eecb16.zip/node_modules/rxjs/dist/esm5/internal/operators/skipWhile.js"),p=s("./.yarn/cache/rxjs-npm-7.5.1-ce59cbb6a3-78e3eecb16.zip/node_modules/rxjs/dist/esm5/internal/operators/throwIfEmpty.js"),h=s("./.yarn/cache/rxjs-npm-7.5.1-ce59cbb6a3-78e3eecb16.zip/node_modules/rxjs/dist/esm5/internal/operators/first.js"),g=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/index.js"),f=s("./packages/grafana-runtime/src/index.ts");class v extends r.LanguageProvider{constructor(e,t){var s,r,n;super(),n=void 0,(r="datasource")in(s=this)?Object.defineProperty(s,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[r]=n,this.datasource=e,Object.assign(this,t)}importFromAbstractQuery(e){return{metrics:[{id:"1",type:"logs"}],query:this.getElasticsearchQuery(e.labelMatchers),refId:e.refId}}getElasticsearchQuery(e){return e.map((e=>{switch(e.operator){case r.AbstractLabelOperator.Equal:return e.name+':"'+e.value+'"';case r.AbstractLabelOperator.NotEqual:return"NOT "+e.name+':"'+e.value+'"';case r.AbstractLabelOperator.EqualRegEx:return e.name+":/"+e.value+"/";case r.AbstractLabelOperator.NotEqualRegEx:return"NOT "+e.name+":/"+e.value+"/"}})).join(" AND ")}}var b=s("./public/app/core/utils/flatten.ts");const y=e=>{var t;return"ewma"===(null===(t=e.settings)||void 0===t?void 0:t.model)},j=e=>{var t;return"holt"===(null===(t=e.settings)||void 0===t?void 0:t.model)},_=e=>{var t;return"holt_winters"===(null===(t=e.settings)||void 0===t?void 0:t.model)},x=e=>{var t;return["holt","ewma","holt_winters"].includes((null===(t=e.settings)||void 0===t?void 0:t.model)||"")},E=e=>R[e.type].requiresField,I=e=>R[e.type].isPipelineAgg,w=e=>R[e.type].supportsMultipleBucketPaths,S=e=>R[e.type].supportsMissing,O=e=>R[e.type].hasSettings,$=e=>R[e.type].supportsInlineScript,N=["count","avg","sum","min","max","extended_stats","percentiles","cardinality","raw_document","raw_data","logs","moving_avg","moving_fn","derivative","serial_diff","cumulative_sum","bucket_script","rate","top_metrics"],A=e=>({name:e,pipelineAgg:""}),F=e=>`var${Math.max(0,...e.map((e=>{var t;return parseInt((null===(t=e.name.match("^var(\\d+)$"))||void 0===t?void 0:t[1])||"0",10)})))+1}`,R={count:{label:"Count",requiresField:!1,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!1,hasMeta:!1,supportsInlineScript:!1,defaults:{}},avg:{label:"Average",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},sum:{label:"Sum",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},max:{label:"Max",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},min:{label:"Min",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},extended_stats:{label:"Extended Stats",requiresField:!0,supportsMissing:!0,supportsInlineScript:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!0,defaults:{meta:{std_deviation_bounds_lower:!0,std_deviation_bounds_upper:!0}}},percentiles:{label:"Percentiles",requiresField:!0,supportsMissing:!0,supportsInlineScript:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{settings:{percents:["25","50","75","95","99"]}}},cardinality:{label:"Unique Count",requiresField:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{}},moving_avg:{label:"Moving Average",requiresField:!0,isPipelineAgg:!0,versionRange:">=2.0.0 <8.0.0",supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{model:"simple",window:"5"}}},moving_fn:{label:"Moving Function",requiresField:!0,isPipelineAgg:!0,supportsMultipleBucketPaths:!1,supportsInlineScript:!1,supportsMissing:!1,hasMeta:!1,hasSettings:!0,versionRange:">=7.0.0",defaults:{}},derivative:{label:"Derivative",requiresField:!0,isPipelineAgg:!0,versionRange:">=2.0.0",supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{}},serial_diff:{label:"Serial Difference",requiresField:!0,isPipelineAgg:!0,versionRange:">=2.0.0",supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{lag:"1"}}},cumulative_sum:{label:"Cumulative Sum",requiresField:!0,isPipelineAgg:!0,versionRange:">=2.0.0",supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{}},bucket_script:{label:"Bucket Script",requiresField:!1,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!0,versionRange:">=2.0.0",hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{pipelineVariables:[A(F([]))]}},raw_document:{label:"Raw Document (legacy)",requiresField:!1,isSingleMetric:!0,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{size:"500"}}},raw_data:{label:"Raw Data",requiresField:!1,isSingleMetric:!0,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{size:"500"}}},logs:{label:"Logs",requiresField:!1,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,isSingleMetric:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{limit:"500"}}},top_metrics:{label:"Top Metrics",xpack:!0,requiresField:!1,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,versionRange:">=7.7.0",hasMeta:!1,defaults:{settings:{order:"desc"}}},rate:{label:"Rate",xpack:!0,versionRange:">=7.10.0",requiresField:!0,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!0,hasMeta:!1,defaults:{}}},k={moving_avg:[{label:"window",default:5},{label:"model",default:"simple"},{label:"predict"},{label:"minimize",default:!1}],moving_fn:[{label:"window",default:5},{label:"script"}],derivative:[{label:"unit"}],serial_diff:[{label:"lag"}],cumulative_sum:[{label:"format"}],bucket_script:[]},z=(e,t)=>{const s=t.filter((t=>{var s;return w(t)?null===(s=t.pipelineVariables)||void 0===s?void 0:s.some((t=>t.pipelineAgg===e.id)):E(t)&&e.id===t.field}));return[...s,...s.flatMap((e=>z(e,t)))]},L=[{label:"Avg",value:"avg"},{label:"Min",value:"min"},{label:"Max",value:"max"},{label:"Sum",value:"sum"},{label:"Count",value:"count"},{label:"Std Dev",value:"std_deviation"},{label:"Std Dev Upper",value:"std_deviation_bounds_upper"},{label:"Std Dev Lower",value:"std_deviation_bounds_lower"}],T=[{label:"Simple",value:"simple"},{label:"Linear",value:"linear"},{label:"Exponentially Weighted",value:"ewma"},{label:"Holt Linear",value:"holt"},{label:"Holt Winters",value:"holt_winters"}],M="@HIGHLIGHT@",P="@/HIGHLIGHT@";function C(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1";return{type:"count",id:e}}function D(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1";return{type:"date_histogram",id:e,settings:{interval:"auto"}}}const q=(e,t)=>e.find((e=>e.id===t));function V(e,t){var s;return!(null==e||null===(s=e.metrics)||void 0===s||!s.some((e=>e.type===t)))}var B=s("./public/app/core/table_model.ts");const G=e=>E(e)?`${R[e.type].label} ${e.field}`:R[e.type].label,U=e=>Object.entries(e).reduce(((e,t)=>{let[s,r]=t;if(null==r)return Object.assign({},e);if(Array.isArray(r)&&0===r.length)return Object.assign({},e);if(0===(null==r?void 0:r.length))return Object.assign({},e);if(!Array.isArray(r)&&"object"==typeof r){const t=U(r);return 0===Object.keys(t).length?Object.assign({},e):Object.assign({},e,{[s]:t})}return Object.assign({},e,{[s]:r})}),{}),H=e=>{const t=e.match(/^(\d+)/);return t?t[1]:void 0},W=e=>{var t,s,r,n;return("object"==typeof(null===(t=e.settings)||void 0===t?void 0:t.script)?null===(s=e.settings)||void 0===s||null===(r=s.script)||void 0===r?void 0:r.inline:null===(n=e.settings)||void 0===n?void 0:n.script)||""},Q=e=>{if("string"==typeof e)return(0,g.valid)(e)||"5.0.0";switch(e){case 2:return"2.0.0";case 56:return"5.6.0";case 60:return"6.0.0";case 70:return"7.0.0";default:return"5.0.0"}};const X=`${M}([^@]+)${P}`;class Y{constructor(e,t){var s,r,n;n=()=>{const e=[];for(let t=0;t<this.response.responses.length;t++){const s=this.response.responses[t],r=this.targets[t];if(s.error)throw this.getErrorFromElasticResponse(this.response,s.error);if(s.hits&&s.hits.hits.length>0&&this.processHits(s.hits,e,r),s.aggregations){const r=s.aggregations,n=this.targets[t],i=[],a=new B.Z;a.refId=n.refId,this.processBuckets(r,n,i,a,{},0),this.trimDatapoints(i,n),this.nameSeries(i,n);for(let t=0;t<i.length;t++)e.push(i[t]);a.rows.length>0&&e.push(a)}}return{data:e}},(r="processResponseToSeries")in(s=this)?Object.defineProperty(s,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[r]=n,this.targets=e,this.response=t,this.targets=e,this.response=t}processMetrics(e,t,s,r){let n;for(let o=0;o<t.metrics.length;o++){const c=t.metrics[o];if(!c.hide)switch(c.type){case"count":n={datapoints:[],metric:"count",props:r,refId:t.refId};for(let t=0;t<e.buckets.length;t++){const s=e.buckets[t],r=s.doc_count;n.datapoints.push([r,s.key])}s.push(n);break;case"percentiles":{if(0===e.buckets.length)break;const i=e.buckets[0][c.id].values;for(const a in i){n={datapoints:[],metric:"p"+a,props:r,field:c.field,refId:t.refId};for(let t=0;t<e.buckets.length;t++){const s=e.buckets[t],r=s[c.id].values;n.datapoints.push([r[a],s.key])}s.push(n)}break}case"extended_stats":for(const i in c.meta)if(c.meta[i]){n={datapoints:[],metric:i,props:r,field:c.field,refId:t.refId};for(let t=0;t<e.buckets.length;t++){const s=e.buckets[t],r=s[c.id];r.std_deviation_bounds_upper=r.std_deviation_bounds.upper,r.std_deviation_bounds_lower=r.std_deviation_bounds.lower,n.datapoints.push([r[i],s.key])}s.push(n)}break;case"top_metrics":var i,a;if(null!==(i=c.settings)&&void 0!==i&&null!==(a=i.metrics)&&void 0!==a&&a.length)for(const i of null===(l=c.settings)||void 0===l?void 0:l.metrics){var l;n={datapoints:[],metric:c.type,props:r,refId:t.refId,field:i};for(let t=0;t<e.buckets.length;t++){const s=e.buckets[t],r=s[c.id].top.map((e=>e.metrics[i]?e.metrics[i]:null)),a=[r[r.length-1],s.key];n.datapoints.push(a)}s.push(n)}break;default:n={datapoints:[],metric:c.type,metricId:c.id,props:r,refId:t.refId},E(c)&&(n.field=c.field);for(let t=0;t<e.buckets.length;t++){const s=e.buckets[t],r=s[c.id];void 0!==r&&(r.normalized_value?n.datapoints.push([r.normalized_value,s.key]):n.datapoints.push([r.value,s.key]))}s.push(n)}}}processAggregationDocs(e,t,s,r,i){if(0===r.columns.length){for(const e of(0,n.keys)(i))r.addColumn({text:e,filterable:!0});r.addColumn({text:t.field,filterable:!0})}const a=(e,t,s)=>{r.addColumn({text:t}),e.push(s)},l=(0,n.isArray)(e.buckets)?e.buckets:[e.buckets];for(const e of l){const t=[];for(const e of(0,n.values)(i))t.push(e);t.push(e.key);for(const r of s.metrics||[])switch(r.type){case"count":a(t,this.getMetricName(r.type),e.doc_count);break;case"extended_stats":for(const s in r.meta){if(!r.meta[s])continue;const n=e[r.id];n.std_deviation_bounds_upper=n.std_deviation_bounds.upper,n.std_deviation_bounds_lower=n.std_deviation_bounds.lower,a(t,this.getMetricName(s),n[s])}break;case"percentiles":{const s=e[r.id].values;for(const e in s)a(t,`p${e} ${r.field}`,s[e]);break}case"top_metrics":{var o;const s=this.getMetricName(r.type);if(null!==(o=r.settings)&&void 0!==o&&o.metrics)for(const n of r.settings.metrics){a(t,r.settings.metrics.length>1?`${s} ${n}`:s,e[r.id].top[0].metrics[n])}break}default:{let i=this.getMetricName(r.type);(0,n.filter)(s.metrics,{type:r.type}).length>1&&(E(r)&&(i+=" "+r.field),"bucket_script"===r.type&&(i=W(r))),a(t,i,e[r.id].value);break}}r.rows.push(t)}}processBuckets(e,t,s,r,i,a){let l,o,c,d;const u=t.bucketAggs.length-1;for(d in e)if(o=(0,n.find)(t.bucketAggs,{id:d}),c=e[d],o)if(a===u)"date_histogram"===o.type?this.processMetrics(c,t,s,i):this.processAggregationDocs(c,o,t,r,i);else for(const e in c.buckets)l=c.buckets[e],i=(0,n.clone)(i),void 0!==l.key?i[o.field]=l.key:i.filter=e,l.key_as_string&&(i[o.field]=l.key_as_string),this.processBuckets(l,t,s,r,i,a+1)}getMetricName(e){const t=Object.entries(R).filter((t=>{let[s]=t;return s===e})).map((e=>{let[t,s]=e;return s}))[0];if(t)return t.label;const s=L.find((t=>t.value===e));return s?s.label:e}getSeriesName(e,t,s){let r=this.getMetricName(e.metric);if(t.alias){const s=/\{\{([\s\S]+?)\}\}/g;return t.alias.replace(s,((t,s,n)=>{const i=s||n;return 0===i.indexOf("term ")?e.props[i.substring(5)]:void 0!==e.props[i]?e.props[i]:"metric"===i?r:"field"===i?e.field||"":t}))}if(e.metric in k)if(e.metric&&function(e){return!!R[e].supportsMultipleBucketPaths}(e.metric)){const s=(0,n.find)(t.metrics,{id:e.metricId});if(s&&s.settings.script){r=W(s);for(const e of s.pipelineVariables){const s=(0,n.find)(t.metrics,{id:e.pipelineAgg});s&&(r=r.replace("params."+e.name,G(s)))}}else r="Unset"}else{const s=(0,n.find)(t.metrics,{id:e.field});s?r+=" "+G(s):r="Unset"}else e.field&&(r+=" "+e.field);if(0===(0,n.keys)(e.props).length)return r;let i="";for(const t in e.props)i+=e.props[t]+" ";return s?i.trim()+" "+r:i.trim()}nameSeries(e,t){var s;const r=(0,n.uniq)((0,n.map)(e,"metric")).length,i=(null===(s=t.metrics)||void 0===s?void 0:s.filter((e=>"top_metrics"===e.type))).some((e=>{var t,s;return((null==e||null===(t=e.settings)||void 0===t||null===(s=t.metrics)||void 0===s?void 0:s.length)||0)>1}));for(let s=0;s<e.length;s++){const n=e[s];n.target=this.getSeriesName(n,t,r>1||i)}}processHits(e,t,s){const r="number"==typeof e.total?e.total:e.total.value,n={target:s.refId,type:"docs",refId:s.refId,datapoints:[],total:r,filterable:!0};let i,a,l,o;for(o=0;o<e.hits.length;o++){if(a=e.hits[o],l={_id:a._id,_type:a._type,_index:a._index,sort:a.sort,highlight:a.highlight},a._source)for(i in a._source)l[i]=a._source[i];for(i in a.fields)l[i]=a.fields[i];n.datapoints.push(l)}t.push(n)}trimDatapoints(e,t){const s=(0,n.find)(t.bucketAggs,{type:"date_histogram"});if(s&&s.settings&&s.settings.trimEdges){const t=s.settings.trimEdges;for(const s in e){const r=e[s];r.datapoints.length>2*t&&(r.datapoints=r.datapoints.slice(t,r.datapoints.length-t))}}}getErrorFromElasticResponse(e,t){const s={};return s.data=JSON.stringify(t,null,4),t.root_cause&&t.root_cause.length>0&&t.root_cause[0].reason?s.message=t.root_cause[0].reason:s.message=t.reason||"Unknown elastic error response",e.$$config&&(s.config=e.$$config),s}getTimeSeries(){return this.targets.some((e=>V(e,"raw_data")))?this.processResponseToDataFrames(!1):this.processResponseToSeries()}getLogs(e,t){return this.processResponseToDataFrames(!0,e,t)}processResponseToDataFrames(e,t,s){const i=[];for(let l=0;l<this.response.responses.length;l++){const o=this.response.responses[l];if(o.error)throw this.getErrorFromElasticResponse(this.response,o.error);if(o.hits){const{propNames:r,docs:c}=Z(o.hits.hits),d=c.length?J(r.map(ee(c)),e,this.targets[0].timeField,t,s):J([],e);e&&K(d,"logs");for(const e of c){if(s&&(e.level=e[s]),e.highlight){var a;const t=new RegExp(X,"g"),s=new RegExp(X),r=Object.keys(e.highlight).flatMap((r=>e.highlight[r].flatMap((e=>{const r=e.match(t);return r?r.map((e=>{const t=e.match(s);return t&&t[1]||null})):[]})))).filter(n.identity),i=null!==(a=d.meta)&&void 0!==a&&a.searchWords?(0,n.uniq)([...d.meta.searchWords,...r]):[...r];d.meta=d.meta?Object.assign({},d.meta,{searchWords:i}):{searchWords:i}}d.add(e)}const u=this.targets[l];d.refId=u.refId,i.push(d)}if(o.aggregations){const t=o.aggregations,s=this.targets[l],n=[],a=new B.Z;if(this.processBuckets(t,s,n,a,{},0),this.trimDatapoints(n,s),this.nameSeries(n,s),a.rows.length>0){const e=(0,r.toDataFrame)(a);e.refId=s.refId,i.push(e)}for(let t=0;t<n.length;t++){let a=(0,r.toDataFrame)(n[t]);e&&K(a,"graph"),a.refId=s.refId,i.push(a)}}}return{data:i}}}const Z=e=>{const t=[];let s=[];for(const r of e){const e=r._source?(0,b.default)(r._source):{},n=Object.assign({_id:r._id,_type:r._type,_index:r._index,sort:r.sort,highlight:r.highlight,_source:Object.assign({},e)},e);for(const e of Object.keys(n))-1===s.indexOf(e)&&s.push(e);t.push(n)}return s.sort(),{docs:t,propNames:s}},J=(e,t,s,n,i)=>{const a=new r.MutableDataFrame({fields:[]});if(s&&a.addField({config:{filterable:!0},name:s,type:r.FieldType.time}),n){const e=a.addField({name:n,type:r.FieldType.string});a.setParser(e,(e=>e||""))}if(i){const e=a.addField({name:"level",type:r.FieldType.string});a.setParser(e,(e=>e||""))}const l=a.fields.map((e=>e.name));for(const[s,r]of e){if(l.includes(s))continue;if(!t&&"_source"===s)continue;const e=a.addField({config:{filterable:!0},name:s,type:r});a.setParser(e,(e=>e||""))}return a},K=(e,t)=>{let s=e;s.meta?s.meta.preferredVisualisationType=t:s.meta={preferredVisualisationType:t}},ee=e=>t=>{var s;return[t,te(null===(s=e.find((e=>void 0!==e[t])))||void 0===s?void 0:s[t])]},te=e=>{switch(typeof e){case"number":return r.FieldType.number;case"string":return r.FieldType.string;default:return r.FieldType.other}};const se={Hourly:{startOf:"hour",amount:"hours"},Daily:{startOf:"day",amount:"days"},Weekly:{startOf:"isoWeek",amount:"weeks"},Monthly:{startOf:"month",amount:"months"},Yearly:{startOf:"year",amount:"years"}};class re{constructor(e,t){var s,r,n;n="en",(r="dateLocale")in(s=this)?Object.defineProperty(s,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[r]=n,this.pattern=e,this.interval=t}getIndexForToday(){return this.interval?(0,r.toUtc)().locale(this.dateLocale).format(this.pattern):this.pattern}getIndexList(e,t){if(!this.interval)return this.pattern;const s=se[this.interval],n=(0,r.dateTime)(e||(0,r.dateTime)(t).add(-7,s.amount)).utc().startOf(s.startOf),i=(0,r.dateTime)(t||(0,r.dateTime)(e).add(7,s.amount)).utc().startOf(s.startOf).valueOf(),a=[];for(;n.valueOf()<=i;)a.push(n.locale(this.dateLocale).format(this.pattern)),n.add(1,s.amount);return a}}function ne(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class ie{constructor(e){ne(this,"timeField",void 0),ne(this,"esVersion",void 0),this.timeField=e.timeField,this.esVersion=e.esVersion}getRangeFilter(){const e={};return e[this.timeField]={gte:"$timeFrom",lte:"$timeTo",format:"epoch_millis"},e}buildTermsAgg(e,t,s){var r;if(t.terms={field:e.field},!e.settings)return t;const n=null!==(r=e.settings)&&void 0!==r&&r.size?parseInt(e.settings.size,10):500;if(t.terms.size=0===n?500:n,void 0!==e.settings.orderBy){t.terms.order={},"_term"===e.settings.orderBy&&(0,g.gte)(this.esVersion,"6.0.0")?t.terms.order._key=e.settings.order:t.terms.order[e.settings.orderBy]=e.settings.order;const r=H(e.settings.orderBy);if(r)for(let n of s.metrics||[])if(n.id===r){"count"===n.type?t.terms.order={_count:e.settings.order}:E(n)&&(t.aggs={},t.aggs[n.id]={[n.type]:{field:n.field}});break}}return void 0!==e.settings.min_doc_count&&(t.terms.min_doc_count=parseInt(e.settings.min_doc_count,10),isNaN(t.terms.min_doc_count)&&(t.terms.min_doc_count=e.settings.min_doc_count)),e.settings.missing&&(t.terms.missing=e.settings.missing),t}getDateHistogramAgg(e){const t={},s=e.settings||{};t.field=e.field||this.timeField,t.min_doc_count=s.min_doc_count||0,t.extended_bounds={min:"$timeFrom",max:"$timeTo"},t.format="epoch_millis",s.timeZone&&s.timeZone!==r.InternalTimeZones.utc&&(t.time_zone=s.timeZone),""!==s.offset&&(t.offset=s.offset);const n="auto"===s.interval?"$__interval":s.interval;return(0,g.gte)(this.esVersion,"8.0.0")?t.fixed_interval=n:t.interval=n,t}getHistogramAgg(e){const t={},s=e.settings||{};return t.interval=s.interval,t.field=e.field,t.min_doc_count=s.min_doc_count||0,t}getFiltersAgg(e){const t={};for(let{query:r,label:n}of(null===(s=e.settings)||void 0===s?void 0:s.filters)||[]){var s;t[n||r]={query_string:{query:r,analyze_wildcard:!0}}}return t}documentQuery(e,t){return e.size=t,e.sort=[{[this.timeField]:{order:"desc",unmapped_type:"boolean"}},{_doc:{order:"desc"}}],(0,g.lt)(this.esVersion,"5.0.0")&&(e.fields=["*","_source"]),e.script_fields={},e}addAdhocFilters(e,t){if(!t)return;let s,r,n,i;for(s=0;s<t.length;s++)switch(r=t[s],n={},n[r.key]=r.value,i={},i[r.key]={query:r.value},r.operator){case"=":e.query.bool.must||(e.query.bool.must=[]),e.query.bool.must.push({match_phrase:i});break;case"!=":e.query.bool.must_not||(e.query.bool.must_not=[]),e.query.bool.must_not.push({match_phrase:i});break;case"<":n[r.key]={lt:r.value},e.query.bool.filter.push({range:n});break;case">":n[r.key]={gt:r.value},e.query.bool.filter.push({range:n});break;case"=~":e.query.bool.filter.push({regexp:n});break;case"!~":e.query.bool.filter.push({bool:{must_not:{regexp:n}}})}}build(e,t){var s,r,n,i,a,l,o,c,d;let u,m,p,h,g;e.metrics=e.metrics||[C()],e.bucketAggs=e.bucketAggs||[D()],e.timeField=this.timeField;const f={size:0,query:{bool:{filter:[{range:this.getRangeFilter()}]}}};if(e.query&&""!==e.query&&(f.query.bool.filter=[...f.query.bool.filter,{query_string:{analyze_wildcard:!0,query:e.query}}]),this.addAdhocFilters(f,t),0===e.bucketAggs.length&&(u=e.metrics[0],!u||"raw_document"!==u.type&&"raw_data"!==u.type))throw{message:"Invalid query"};if("raw_document"===(null===(s=e.metrics)||void 0===s||null===(r=s[0])||void 0===r?void 0:r.type)||"raw_data"===(null===(n=e.metrics)||void 0===n||null===(i=n[0])||void 0===i?void 0:i.type)){var v;u=e.metrics[0];const t=null!==(v=u.settings)&&void 0!==v&&v.size?parseInt(u.settings.size,10):500;return this.documentQuery(f,t||500)}for(g=f,m=0;m<e.bucketAggs.length;m++){const t=e.bucketAggs[m],s={};switch(t.type){case"date_histogram":s.date_histogram=this.getDateHistogramAgg(t);break;case"histogram":s.histogram=this.getHistogramAgg(t);break;case"filters":s.filters={filters:this.getFiltersAgg(t)};break;case"terms":this.buildTermsAgg(t,s,e);break;case"geohash_grid":var b;s.geohash_grid={field:t.field,precision:null===(b=t.settings)||void 0===b?void 0:b.precision}}g.aggs=g.aggs||{},g.aggs[t.id]=s,g=s}for(g.aggs={},m=0;m<e.metrics.length;m++){if(u=e.metrics[m],"count"===u.type)continue;const t={};let s={};if(I(u))if(w(u)){if(!u.pipelineVariables)continue;for(s={buckets_path:{}},p=0;p<u.pipelineVariables.length;p++)if(h=u.pipelineVariables[p],h.name&&h.pipelineAgg&&/^\d*$/.test(h.pipelineAgg)){const t=q(e.metrics,h.pipelineAgg);t&&("count"===t.type?s.buckets_path[h.name]="_count":s.buckets_path[h.name]=h.pipelineAgg)}}else{if(!u.field||!/^\d*$/.test(u.field))continue;{const t=q(e.metrics,u.field);t&&(s="count"===t.type?{buckets_path:"_count"}:{buckets_path:u.field})}}else E(u)&&(s={field:u.field});if(O(u))switch(Object.entries(u.settings||{}).filter((e=>{let[t,s]=e;return null!==s})).forEach((e=>{let[t,r]=e;s[t]="script"===t?this.buildScript(W(u)):r})),u.type){case"moving_avg":s=Object.assign({},s,void 0!==(null===(a=s)||void 0===a?void 0:a.window)&&{window:this.toNumber(s.window)},void 0!==(null===(l=s)||void 0===l?void 0:l.predict)&&{predict:this.toNumber(s.predict)},x(u)&&{settings:Object.assign({},s.settings,Object.fromEntries(Object.entries(s.settings||{}).filter((e=>{let[t]=e;return["alpha","beta","gamma","period"].includes(t)})).filter((e=>{let[t,s]=e;return void 0!==s})).map((e=>{let[t,s]=e;return[t,this.toNumber(s)]}))))});break;case"serial_diff":s=Object.assign({},s,void 0!==s.lag&&{lag:this.toNumber(s.lag)});break;case"top_metrics":var y,j;if(s={metrics:null===(o=u.settings)||void 0===o||null===(c=o.metrics)||void 0===c?void 0:c.map((e=>({field:e}))),size:1},null!==(d=u.settings)&&void 0!==d&&d.orderBy)s.sort=[{[null===(y=u.settings)||void 0===y?void 0:y.orderBy]:null===(j=u.settings)||void 0===j?void 0:j.order}]}t[u.type]=s,g.aggs[u.id]=t}return f}buildScript(e){return(0,g.gte)(this.esVersion,"5.6.0")?e:{inline:e}}toNumber(e){const t=parseFloat(`${e}`);return isNaN(t)?e:t}getTermsQuery(e){const t={size:0,query:{bool:{filter:[{range:this.getRangeFilter()}]}}};e.query&&t.query.bool.filter.push({query_string:{analyze_wildcard:!0,query:e.query}});let s=500;e.size&&(s=e.size),t.aggs={1:{terms:{field:e.field,size:s,order:{}}}};const{orderBy:r="key",order:n=("doc_count"===r?"desc":"asc")}=e;if(["asc","desc"].indexOf(n)<0)throw{message:`Invalid query sort order ${n}`};switch(r){case"key":case"term":const e=(0,g.gte)(this.esVersion,"6.0.0")?"_key":"_term";t.aggs[1].terms.order[e]=n;break;case"doc_count":t.aggs[1].terms.order._count=n;break;default:throw{message:`Invalid query sort type ${r}`}}return t}getLogsQuery(e,t,s){let r={size:0,query:{bool:{filter:[{range:this.getRangeFilter()}]}}};return this.addAdhocFilters(r,s),e.query&&r.query.bool.filter.push({query_string:{analyze_wildcard:!0,query:e.query}}),r=this.documentQuery(r,t),Object.assign({},r,{aggs:this.build(e,null).aggs,highlight:{fields:{"*":{}},pre_tags:[M],post_tags:[P],fragment_size:2147483647}})}}var ae=s("./public/app/features/templating/template_srv.ts");const le={terms:{label:"Terms",requiresField:!0,defaultSettings:{min_doc_count:"1",size:"10",order:"desc",orderBy:"_term"}},filters:{label:"Filters",requiresField:!1,defaultSettings:{filters:[{label:"",query:"*"}]}},geohash_grid:{label:"Geo Hash Grid",requiresField:!0,defaultSettings:{precision:"3"}},date_histogram:{label:"Date Histogram",requiresField:!0,defaultSettings:{interval:"auto",min_doc_count:"0",trimEdges:"0",timeZone:r.InternalTimeZones.utc}},histogram:{label:"Histogram",requiresField:!0,defaultSettings:{interval:"1000",min_doc_count:"0"}}},oe=[{label:"Term value",value:"_term"},{label:"Doc Count",value:"_count"}],ce=[{label:"Top",value:"desc"},{label:"Bottom",value:"asc"}],de=[{label:"No limit",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"5",value:"5"},{label:"10",value:"10"},{label:"15",value:"15"},{label:"20",value:"20"}],ue=e=>le[e.type].requiresField,me=["date_histogram","histogram","terms","filters","geohash_grid"];var pe=s("./public/app/core/logs_model.ts");function he(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const ge=["_index","_type","_id","_source","_size","_field_names","_ignored","_routing","_meta"];class fe extends r.DataSourceApi{constructor(e){var t,s;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,ae.J)();super(e),he(this,"basicAuth",void 0),he(this,"withCredentials",void 0),he(this,"url",void 0),he(this,"name",void 0),he(this,"index",void 0),he(this,"timeField",void 0),he(this,"esVersion",void 0),he(this,"xpack",void 0),he(this,"interval",void 0),he(this,"maxConcurrentShardRequests",void 0),he(this,"queryBuilder",void 0),he(this,"indexPattern",void 0),he(this,"logMessageField",void 0),he(this,"logLevelField",void 0),he(this,"dataLinks",void 0),he(this,"languageProvider",void 0),he(this,"includeFrozen",void 0),he(this,"getLogRowContext",(async(e,t)=>{var s;const a=e.dataFrame.fields.find((e=>"sort"===e.name)),l=(null==a?void 0:a.values.get(e.rowIndex))||[e.timeEpochMs],o="FORWARD"===(null==t?void 0:t.direction)?"asc":"desc",c="FORWARD"===(null==t?void 0:t.direction)?this.getQueryHeader("query_then_fetch",(0,r.dateTime)(e.timeEpochMs)):this.getQueryHeader("query_then_fetch",void 0,(0,r.dateTime)(e.timeEpochMs)),d=null!==(s=null==t?void 0:t.limit)&&void 0!==s?s:10,u=[c,JSON.stringify({size:d,query:{bool:{filter:[{range:{[this.timeField]:{["FORWARD"===(null==t?void 0:t.direction)?"gte":"lte"]:e.timeEpochMs,format:"epoch_millis"}}}]}},sort:[{[this.timeField]:o},{_doc:o}],search_after:l})].join("\n")+"\n",m=this.getMultiSearchUrl(),p=await(0,i.n)(this.post(m,u)),h=[{refId:`${e.dataFrame.refId}`,metrics:[{type:"logs",id:"1"}]}],g=new Y(h,function(e,t){if("desc"===t)return e;const s=e.responses[0];return Object.assign({},e,{responses:[Object.assign({},s,{hits:Object.assign({},s.hits,{hits:s.hits.hits.reverse()})})]})}(p,o)),f=g.getLogs(this.logMessageField,this.logLevelField),v=(0,n.first)(f.data);if(!v)return{data:[]};const b=v.fields.find((e=>e.name===this.timeField)),y=v.fields.find((e=>e.name===this.logMessageField));return b&&y?{data:[Object.assign({},v,{fields:[...v.fields,Object.assign({},b,{name:"ts"}),Object.assign({},y,{name:"line"})]})]}:f})),this.templateSrv=a,this.basicAuth=e.basicAuth,this.withCredentials=e.withCredentials,this.url=e.url,this.name=e.name,this.index=null!==(t=e.database)&&void 0!==t?t:"";const l=e.jsonData||{};this.timeField=l.timeField,this.esVersion=Q(l.esVersion),this.xpack=Boolean(l.xpack),this.indexPattern=new re(this.index,l.interval),this.interval=l.timeInterval,this.maxConcurrentShardRequests=l.maxConcurrentShardRequests,this.queryBuilder=new ie({timeField:this.timeField,esVersion:this.esVersion}),this.logMessageField=l.logMessageField||"",this.logLevelField=l.logLevelField||"",this.dataLinks=l.dataLinks||[],this.includeFrozen=null!==(s=l.includeFrozen)&&void 0!==s&&s,""===this.logMessageField&&(this.logMessageField=void 0),""===this.logLevelField&&(this.logLevelField=void 0),this.languageProvider=new v(this)}request(e,t,s,r){const n={url:this.url+"/"+t,method:e,data:s,headers:r};return(this.basicAuth||this.withCredentials)&&(n.withCredentials=!0),this.basicAuth&&(n.headers={Authorization:this.basicAuth}),(0,f.getBackendSrv)().fetch(n).pipe((0,c.U)((e=>(e.data.$$config=e.config,e.data))),(0,d.K)((e=>{if(e.data){var t,s,r;const n=null!==(t=null!==(s=null===(r=e.data.error)||void 0===r?void 0:r.reason)&&void 0!==s?s:e.data.message)&&void 0!==t?t:"Unknown error";return(0,a._)({message:"Elasticsearch error: "+n,error:e.data.error})}return(0,a._)(e)})))}async importFromAbstractQueries(e){return e.map((e=>this.languageProvider.importFromAbstractQuery(e)))}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,r.getDefaultTimeRange)(),s=this.indexPattern.getIndexList(t.from,t.to);Array.isArray(s)||(s=[this.indexPattern.getIndexForToday()]);const n=s.map((t=>t+e));return this.requestAllIndices(n)}requestAllIndices(e){const t=e.length;return(0,l.R)({initialState:0,condition:e=>e<Math.min(t,7),iterate:e=>e+1}).pipe((0,u.z)((s=>this.request("GET",e[t-s-1]).pipe((0,d.K)((e=>(0,o.of)({err:e})))))),(0,m.n)((e=>{var t;return 404===(null==e||null===(t=e.err)||void 0===t?void 0:t.status)})),(0,p.T)((()=>"Could not find an available index for this time range.")),(0,h.P)(),(0,c.U)((e=>{if(e.err)throw e.err;return e})))}post(e,t){return this.request("POST",e,t,{"Content-Type":"application/x-ndjson"})}annotationQuery(e){const t=e.annotation,s=t.timeField||"@timestamp",a=t.timeEndField||null,l=t.query,o=t.tagsField||"tags",d=t.textField||null,u=[],m={};if(m[s]={from:e.range.from.valueOf(),to:e.range.to.valueOf(),format:"epoch_millis"},u.push({range:m}),a){const t={};t[a]={from:e.range.from.valueOf(),to:e.range.to.valueOf(),format:"epoch_millis"},u.push({range:t})}const p=this.interpolateLuceneQuery(l),h={bool:{filter:[{bool:{should:u,minimum_should_match:1}}]}};p&&h.bool.filter.push({query_string:{query:p}});const f={query:h,size:1e4};(0,g.lt)(this.esVersion,"5.0.0")&&(f.fields=[s,"_source"]);const v={search_type:"query_then_fetch",ignore_unavailable:!0};t.index?v.index=t.index:v.index=this.indexPattern.getIndexList(e.range.from,e.range.to);const b=JSON.stringify(v)+"\n"+JSON.stringify(f)+"\n";return(0,i.n)(this.post("_msearch",b).pipe((0,c.U)((e=>{const i=[],l=e.responses[0].hits.hits,c=(e,t)=>{if(!t)return;const s=t.split(".");let r=e;for(let e=0;e<s.length;e++)if(r=r[s[e]],!r)return console.log("could not find field in annotation: ",t),"";return r};for(let e=0;e<l.length;e++){const u=l[e]._source;let m=c(u,s);if(void 0!==l[e].fields){const t=l[e].fields;((0,n.isString)(t[s])||(0,n.isNumber)(t[s]))&&(m=t[s])}const p={annotation:t,time:(0,r.toUtc)(m).valueOf(),text:c(u,d),tags:c(u,o)};if(a){const e=c(u,a);e&&(p.timeEnd=(0,r.toUtc)(e).valueOf())}if(t.titleField){const e=c(u,t.titleField);e&&(p.text=e+"\n"+p.text)}"string"==typeof p.tags&&(p.tags=p.tags.split(",")),i.push(p)}return i}))))}interpolateLuceneQuery(e,t){return this.templateSrv.replace(e,t,"lucene")}interpolateVariablesInQueries(e,t){const s=e=>{var s,r;return"filters"===e.type?Object.assign({},e,{settings:Object.assign({},e.settings,{filters:null===(s=e.settings)||void 0===s||null===(r=s.filters)||void 0===r?void 0:r.map((e=>Object.assign({},e,{query:this.interpolateLuceneQuery(e.query,t)||"*"})))})}):e},r=e.map((e=>{var r;return Object.assign({},e,{datasource:this.getRef(),query:this.interpolateLuceneQuery(e.query||"",t),bucketAggs:null===(r=e.bucketAggs)||void 0===r?void 0:r.map(s)})}));return JSON.parse(this.templateSrv.replace(JSON.stringify(r),t))}testDatasource(){return(0,i.n)(this.getFields(["date"]).pipe((0,u.z)((e=>(0,n.find)(e,{text:this.timeField})?(0,o.of)({status:"success",message:"Index OK. Time field name OK."}):(0,o.of)({status:"error",message:"No date field named "+this.timeField+" found"}))),(0,d.K)((e=>(console.error(e),e.message?(0,o.of)({status:"error",message:e.message}):(0,o.of)({status:"error",message:e.status}))))))}getQueryHeader(e,t,s){const r={search_type:e,ignore_unavailable:!0,index:this.indexPattern.getIndexList(t,s)};return(0,g.satisfies)(this.esVersion,">=5.6.0 <7.0.0")&&(r.max_concurrent_shard_requests=this.maxConcurrentShardRequests),JSON.stringify(r)}getQueryDisplayText(e){const t=e.metrics,s=e.bucketAggs;let r="";return e.query&&(r+="Query: "+e.query+", "),r+="Metrics: ",r+=null==t?void 0:t.reduce(((e,t)=>{let s=R[t.type].label+"(";return E(t)&&(s+=t.field),w(t)&&(s+=W(t).replace(new RegExp("params.","g"),"")),s+="), ",`${e} ${s}`}),""),r+=null==s?void 0:s.reduce(((e,t,s)=>{let r="";return 0===s&&(r+=" Group by: "),r+=le[t.type].label+"(",ue(t)&&(r+=t.field),`${e} ${r}), `}),""),e.alias&&(r+="Alias: "+e.alias),r}showContextToggle(){return(0,g.gte)(this.esVersion,"5.0.0")}getLogsVolumeDataProvider(e){if(!e.targets.some((e=>{var t;return 1===(null===(t=e.metrics)||void 0===t?void 0:t.length)&&"logs"===e.metrics[0].type})))return;const t=(0,n.cloneDeep)(e);return t.targets=t.targets.map((e=>{var t;const s=[],n=null!==(t=this.timeField)&&void 0!==t?t:"@timestamp";this.logLevelField&&s.push({id:"2",type:"terms",settings:{min_doc_count:"0",size:"0",order:"desc",orderBy:"_count",missing:r.LogLevel.unknown},field:this.logLevelField}),s.push({id:"3",type:"date_histogram",settings:{interval:"auto",min_doc_count:"0",trimEdges:"0"},field:n});return{refId:e.refId,query:e.query,metrics:[{type:"count",id:"1"}],timeField:n,bucketAggs:s}})),(0,pe.Bz)(this,t,{range:e.range,targets:e.targets,extractLevel:e=>(0,r.getLogLevelFromKey)(e.name||"")})}query(e){let t="";const s=this.interpolateVariablesInQueries((0,n.cloneDeep)(e.targets),e.scopedVars),r=[];let i=s.some((e=>V(e,"logs")));const a=this.templateSrv.getAdhocFilters(this.name),l=[];for(const n of s){if(n.hide)continue;let s;if(V(n,"logs")){var d,u,m;n.bucketAggs=[D()];const e=null===(d=n.metrics)||void 0===d?void 0:d.find((e=>"logs"===e.type)),t=null!==(u=e.settings)&&void 0!==u&&u.limit?parseInt(null===(m=e.settings)||void 0===m?void 0:m.limit,10):500;l.push(t),n.metrics=[],s=this.queryBuilder.getLogsQuery(n,t,a)}else l.push(),n.alias&&(n.alias=this.interpolateLuceneQuery(n.alias,e.scopedVars)),s=this.queryBuilder.build(n,a);const i=JSON.stringify(s),o=0===s.size&&(0,g.lt)(this.esVersion,"5.0.0")?"count":"query_then_fetch";t+=this.getQueryHeader(o,e.range.from,e.range.to)+"\n",t+=i+"\n",r.push(n)}if(0===r.length)return(0,o.of)({data:[]});t=t.replace(/"\$timeFrom"/g,e.range.from.valueOf().toString()),t=t.replace(/"\$timeTo"/g,e.range.to.valueOf().toString()),t=this.templateSrv.replace(t,e.scopedVars);const p=this.getMultiSearchUrl();return this.post(p,t).pipe((0,c.U)((e=>{const t=new Y(r,e);if(i){const e=t.getLogs(this.logMessageField,this.logLevelField);return e.data.forEach(((e,t)=>{!function(e,t,s){s&&(e.meta=Object.assign({},e.meta,{limit:s}));if(!t.length)return;for(const s of e.fields){const e=t.filter((e=>new RegExp(e.field).test(s.name)));0!==e.length&&(s.config=s.config||{},s.config.links=[...(s.config.links,e.map(ve))])}}(e,this.dataLinks,l[t])})),e}return t.getTimeSeries()})))}isMetadataField(e){return ge.includes(e)}getFields(e,t){const s={float:"number",double:"number",integer:"number",long:"number",date:"date",date_nanos:"date",string:"string",text:"string",scaled_float:"number",nested:"nested",histogram:"number"};return this.get("/_mapping",t).pipe((0,c.U)((t=>{const r=(t,r)=>!this.isMetadataField(r)&&(!e||0===e.length||(e.includes(t.type)||e.includes(s[t.type]))),i=[],a={};function l(e){for(const t in e){const s=e[t];if((0,n.isObject)(s.properties)&&(i.push(t),l(s.properties)),(0,n.isObject)(s.fields)&&(i.push(t),l(s.fields)),(0,n.isString)(s.type)){const e=i.concat(t).join(".");r(s,t)&&(a[e]={text:e,type:s.type})}}i.pop()}for(const e in t){const s=t[e];if(s&&s.mappings){const e=s.mappings;if((0,g.lt)(this.esVersion,"7.0.0"))for(const t in e){l(e[t].properties)}else{l(e.properties)}}}return(0,n.map)(a,(e=>e))})))}getTerms(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,r.getDefaultTimeRange)();const s=(0,g.gte)(this.esVersion,"5.0.0")?"query_then_fetch":"count",i=this.getQueryHeader(s,t.from,t.to);let a=JSON.stringify(this.queryBuilder.getTermsQuery(e));a=a.replace(/\$timeFrom/g,t.from.valueOf().toString()),a=a.replace(/\$timeTo/g,t.to.valueOf().toString()),a=i+"\n"+a+"\n";const l=this.getMultiSearchUrl();return this.post(l,a).pipe((0,c.U)((e=>{if(!e.responses[0].aggregations)return[];const t=e.responses[0].aggregations[1].buckets;return(0,n.map)(t,(e=>({text:e.key_as_string||e.key,value:e.key})))})))}getMultiSearchUrl(){const e=new URLSearchParams;return(0,g.gte)(this.esVersion,"7.0.0")&&this.maxConcurrentShardRequests&&e.append("max_concurrent_shard_requests",`${this.maxConcurrentShardRequests}`),(0,g.gte)(this.esVersion,"6.6.0")&&this.xpack&&this.includeFrozen&&e.append("ignore_throttled","false"),("_msearch?"+e.toString()).replace(/\?$/,"")}metricFindQuery(e,t){const s=null==t?void 0:t.range,r=JSON.parse(e);if(e){if("fields"===r.find)return r.type=this.interpolateLuceneQuery(r.type),(0,i.n)(this.getFields(r.type,s));if("terms"===r.find)return r.field=this.interpolateLuceneQuery(r.field),r.query=this.interpolateLuceneQuery(r.query),(0,i.n)(this.getTerms(r,s))}return Promise.resolve([])}getTagKeys(){return(0,i.n)(this.getFields())}getTagValues(e){return(0,i.n)(this.getTerms({field:e.key}))}targetContainsTemplate(e){if(this.templateSrv.variableExists(e.query)||this.templateSrv.variableExists(e.alias))return!0;for(const t of e.bucketAggs)if(this.templateSrv.variableExists(t.field)||this.objectContainsTemplate(t.settings))return!0;for(const t of e.metrics)if(this.templateSrv.variableExists(t.field)||this.objectContainsTemplate(t.settings)||this.objectContainsTemplate(t.meta))return!0;return!1}isPrimitive(e){return null==e||!!["string","number","boolean"].some((e=>"boolean"===e))}objectContainsTemplate(e){if(!e)return!1;for(const t of Object.keys(e))if(this.isPrimitive(e[t])){if(this.templateSrv.variableExists(e[t]))return!0}else if(Array.isArray(e[t])){for(const s of e[t])if(this.objectContainsTemplate(s))return!0}else if(this.objectContainsTemplate(e[t]))return!0;return!1}}function ve(e){const t=(0,f.getDataSourceSrv)();if(e.datasourceUid){var s;const r=t.getInstanceSettings(e.datasourceUid);return{title:e.urlDisplayLabel||"",url:"",internal:{query:{query:e.url},datasourceUid:e.datasourceUid,datasourceName:null!==(s=null==r?void 0:r.name)&&void 0!==s?s:"Data source not found"}}}return{title:e.urlDisplayLabel||"",url:e.url}}var be=s("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),ye=s("./packages/grafana-ui/src/index.ts");const je=e=>{var t;const s=Q(e.jsonData.esVersion);return Object.assign({},e,{jsonData:Object.assign({},e.jsonData,{timeField:e.jsonData.timeField||"@timestamp",esVersion:s,maxConcurrentShardRequests:e.jsonData.maxConcurrentShardRequests||Fe(s),logMessageField:e.jsonData.logMessageField||"",logLevelField:e.jsonData.logLevelField||"",includeFrozen:null!==(t=e.jsonData.includeFrozen)&&void 0!==t&&t})})},_e=e=>Boolean(e);var xe,Ee=s("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const Ie=[{label:"No pattern",value:"none"},{label:"Hourly",value:"Hourly",example:"[logstash-]YYYY.MM.DD.HH"},{label:"Daily",value:"Daily",example:"[logstash-]YYYY.MM.DD"},{label:"Weekly",value:"Weekly",example:"[logstash-]GGGG.WW"},{label:"Monthly",value:"Monthly",example:"[logstash-]YYYY.MM"},{label:"Yearly",value:"Yearly",example:"[logstash-]YYYY"}],we=[{label:"2.x",value:"2.0.0"},{label:"5.x",value:"5.0.0"},{label:"5.6+",value:"5.6.0"},{label:"6.0+",value:"6.0.0"},{label:"7.0+",value:"7.0.0"},{label:"7.7+",value:"7.7.0"},{label:"7.10+",value:"7.10.0"},{label:"8.0+",value:"8.0.0",description:"support for Elasticsearch 8 is currently experimental"}],Se=e=>{var t;let{value:s,onChange:r}=e;const n=we.find((e=>e.value===s.jsonData.esVersion)),i=!n&&(0,g.valid)(s.jsonData.esVersion)?{label:s.jsonData.esVersion,value:s.jsonData.esVersion}:void 0;return(0,Ee.jsx)(Ee.Fragment,{children:(0,Ee.jsxs)(ye.FieldSet,{label:"Elasticsearch details",children:[(0,Ee.jsx)(ye.InlineField,{label:"Index name",labelWidth:26,children:(0,Ee.jsx)(ye.Input,{id:"es_config_indexName",value:s.database||"",onChange:Oe("database",s,r),width:24,placeholder:"es-index-name",required:!0})}),(0,Ee.jsx)(ye.InlineField,{label:"Pattern",labelWidth:26,children:(0,Ee.jsx)(ye.Select,{inputId:"es_config_indexPattern",value:Ie.find((e=>e.value===(void 0===s.jsonData.interval?"none":s.jsonData.interval))),options:Ie,onChange:Ae(s,r),width:24,menuShouldPortal:!0})}),(0,Ee.jsx)(ye.InlineField,{label:"Time field name",labelWidth:26,children:(0,Ee.jsx)(ye.Input,{id:"es_config_timeField",value:s.jsonData.timeField||"",onChange:$e("timeField",s,r),width:24,placeholder:"@timestamp",required:!0})}),(0,Ee.jsx)(ye.InlineField,{label:"ElasticSearch version",labelWidth:26,children:(0,Ee.jsx)(ye.Select,{inputId:"es_config_version",options:[i,...we].filter(_e),onChange:e=>{const t=function(e,t){if(5===e&&(0,g.lt)(t,"7.0.0"))return 256;if(256===e&&(0,g.gte)(t,"7.0.0"))return 5;return e||Fe(t)}(s.jsonData.maxConcurrentShardRequests,e.value);r(Object.assign({},s,{jsonData:Object.assign({},s.jsonData,{esVersion:e.value,maxConcurrentShardRequests:t})}))},value:n||i,width:24,menuShouldPortal:!0})}),(0,g.gte)(s.jsonData.esVersion,"5.6.0")&&(0,Ee.jsx)(ye.InlineField,{label:"Max concurrent Shard Requests",labelWidth:26,children:(0,Ee.jsx)(ye.Input,{id:"es_config_shardRequests",value:s.jsonData.maxConcurrentShardRequests||"",onChange:$e("maxConcurrentShardRequests",s,r),width:24})}),(0,Ee.jsx)(ye.InlineField,{label:"Min time interval",labelWidth:26,tooltip:(0,Ee.jsxs)(Ee.Fragment,{children:["A lower limit for the auto group by time interval. Recommended to be set to write frequency, for example"," ",xe||(xe=(0,Ee.jsx)("code",{children:"1m"}))," if your data is written every minute."]}),error:"Value is not valid, you can use number with time unit specifier: y, M, w, d, h, m, s",invalid:!!s.jsonData.timeInterval&&!/^\d+(ms|[Mwdhmsy])$/.test(s.jsonData.timeInterval),children:(0,Ee.jsx)(ye.Input,{id:"es_config_minTimeInterval",value:s.jsonData.timeInterval||"",onChange:$e("timeInterval",s,r),width:24,placeholder:"10s"})}),(0,Ee.jsx)(ye.InlineField,{label:"X-Pack enabled",labelWidth:26,children:(0,Ee.jsx)(ye.InlineSwitch,{id:"es_config_xpackEnabled",checked:s.jsonData.xpack||!1,onChange:Ne("xpack",s,r)})}),(0,g.gte)(s.jsonData.esVersion,"6.6.0")&&s.jsonData.xpack&&(0,Ee.jsx)(ye.InlineField,{label:"Include Frozen Indices",labelWidth:26,children:(0,Ee.jsx)(ye.InlineSwitch,{id:"es_config_frozenIndices",checked:null!==(t=s.jsonData.includeFrozen)&&void 0!==t&&t,onChange:Ne("includeFrozen",s,r)})})]})})},Oe=(e,t,s)=>r=>{s(Object.assign({},t,{[e]:r.currentTarget.value}))},$e=(e,t,s)=>r=>{s(Object.assign({},t,{jsonData:Object.assign({},t.jsonData,{[e]:r.currentTarget.value})}))},Ne=(e,t,s)=>r=>{s(Object.assign({},t,{jsonData:Object.assign({},t.jsonData,{[e]:r.currentTarget.checked})}))},Ae=(e,t)=>s=>{const{database:r}=e,n="none"===s.value?void 0:s.value;if(!r||0===r.length||r.startsWith("[logstash-]")){let s="";if(void 0!==n){const e=Ie.find((e=>e.value===n));var i;if(e)s=null!==(i=e.example)&&void 0!==i?i:""}t(Object.assign({},e,{database:s,jsonData:Object.assign({},e.jsonData,{interval:n})}))}else t(Object.assign({},e,{jsonData:Object.assign({},e.jsonData,{interval:n})}))};function Fe(e){return(0,g.gte)(e,"7.0.0")?5:256}const Re=e=>{const{value:t,onChange:s}=e,r=e=>r=>{s(Object.assign({},t,{[e]:r.currentTarget.value}))};return(0,Ee.jsxs)(ye.FieldSet,{label:"Logs",children:[(0,Ee.jsx)(ye.InlineField,{label:"Message field name",labelWidth:22,children:(0,Ee.jsx)(ye.Input,{id:"es_logs-config_logMessageField",value:t.logMessageField,onChange:r("logMessageField"),placeholder:"_source",width:24})}),(0,Ee.jsx)(ye.InlineField,{label:"Level field name",labelWidth:22,children:(0,Ee.jsx)(ye.Input,{id:"es_logs-config_logLevelField",value:t.logLevelField,onChange:r("logLevelField"),width:24})})]})};var ke=s("./.yarn/__virtual__/@emotion-css-virtual-72c314ddb1/0/cache/@emotion-css-npm-11.7.1-25ff8755a7-ac1f56656f.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),ze=s("./.yarn/__virtual__/react-use-virtual-00326e70ba/0/cache/react-use-npm-17.3.2-a032cbeb01-7379460f51.zip/node_modules/react-use/esm/usePrevious.js");const{FormField:Le,Switch:Te}=ye.LegacyForms,Me=(0,ye.stylesFactory)((()=>({firstRow:ke.css`
    display: flex;
  `,nameField:ke.css`
    flex: 2;
  `,regexField:ke.css`
    flex: 3;
  `,row:ke.css`
    display: flex;
    align-items: baseline;
  `,urlField:ke.css`
    flex: 1;
  `,urlDisplayLabelField:ke.css`
    flex: 1;
  `}))),Pe=e=>{const{value:t,onChange:s,onDelete:r,suggestions:n,className:i}=e,a=Me(),[l,o]=function(e){const[t,s]=(0,be.useState)(!!e),r=(0,ze.Z)(e);return(0,be.useEffect)((()=>{r||!e||t||s(!0),r&&!e&&t&&s(!1)}),[r,e,t]),[t,s]}(t.datasourceUid),c=e=>r=>{s(Object.assign({},t,{[e]:r.currentTarget.value}))};return(0,Ee.jsxs)("div",{className:i,children:[(0,Ee.jsxs)("div",{className:a.firstRow+" gf-form",children:[(0,Ee.jsx)(Le,{className:a.nameField,labelWidth:6,inputWidth:null,label:"Field",type:"text",value:t.field,tooltip:"Can be exact field name or a regex pattern that will match on the field name.",onChange:c("field")}),(0,Ee.jsx)(ye.Button,{variant:"destructive",title:"Remove field",icon:"times",onClick:e=>{e.preventDefault(),r()}})]}),(0,Ee.jsxs)("div",{className:"gf-form",children:[(0,Ee.jsx)(Le,{label:l?"Query":"URL",labelWidth:6,inputEl:(0,Ee.jsx)(ye.DataLinkInput,{placeholder:l?"${__value.raw}":"http://example.com/${__value.raw}",value:t.url||"",onChange:e=>s(Object.assign({},t,{url:e})),suggestions:n}),className:a.urlField}),(0,Ee.jsx)(Le,{className:a.urlDisplayLabelField,inputWidth:null,label:"URL Label",type:"text",value:t.urlDisplayLabel,onChange:c("urlDisplayLabel"),tooltip:"Use to override the button label."})]}),(0,Ee.jsxs)("div",{className:a.row,children:[(0,Ee.jsx)(Te,{labelClass:"width-6",label:"Internal link",checked:l,onChange:()=>{l&&s(Object.assign({},t,{datasourceUid:void 0})),o(!l)}}),l&&(0,Ee.jsx)(f.DataSourcePicker,{tracing:!0,onChange:e=>{s(Object.assign({},t,{datasourceUid:e.uid}))},current:t.datasourceUid})]})]})};var Ce;const De=e=>({infoText:ke.css`
      padding-bottom: ${e.spacing(2)};
      color: ${e.colors.text.secondary};
    `,dataLink:ke.css`
      margin-bottom: ${e.spacing(1)};
    `}),qe=e=>{const{value:t,onChange:s}=e,n=(0,ye.useStyles2)(De);return(0,Ee.jsxs)(Ee.Fragment,{children:[Ce||(Ce=(0,Ee.jsx)("h3",{className:"page-heading",children:"Data links"})),(0,Ee.jsx)("div",{className:n.infoText,children:"Add links to existing fields. Links will be shown in log row details next to the field value."}),t&&t.length>0&&(0,Ee.jsx)("div",{className:"gf-form-group",children:t.map(((e,i)=>(0,Ee.jsx)(Pe,{className:n.dataLink,value:e,onChange:e=>{const r=[...t];r.splice(i,1,e),s(r)},onDelete:()=>{const e=[...t];e.splice(i,1),s(e)},suggestions:[{value:r.DataLinkBuiltInVars.valueRaw,label:"Raw value",documentation:"Raw value of the field",origin:r.VariableOrigin.Value}]},i)))}),(0,Ee.jsx)(ye.Button,{variant:"secondary",className:ke.css`
          margin-right: 10px;
        `,icon:"plus",onClick:e=>{e.preventDefault();const r=[...t||[],{field:"",url:""}];s(r)},children:"Add"})]})};var Ve,Be=s("./public/app/core/config.ts");const Ge=(e,t,s)=>(0,be.useCallback)((r=>{e(s(t,r))}),[e,t,s]),Ue=(0,be.createContext)(void 0),He=()=>{const e=(0,be.useContext)(Ue);if(!e)throw new Error("Use DispatchContext first.");return e};var We=s("./.yarn/__virtual__/@reduxjs-toolkit-virtual-37b359704c/0/cache/@reduxjs-toolkit-npm-1.7.1-608aebbd36-77e027b948.zip/node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js");const Qe=(0,We.PH)("init"),Xe=(0,We.PH)("change_query"),Ye=(0,We.PH)("change_alias_pattern"),Ze=(e,t)=>Xe.match(t)?t.payload:Qe.match(t)?e||"":e,Je=(e,t)=>Ye.match(t)?t.payload:Qe.match(t)?e||"":e,Ke=(0,We.PH)("@metrics/add"),et=(0,We.PH)("@metrics/remove"),tt=(0,We.PH)("@metrics/toggle_visibility"),st=(0,We.PH)("@metrics/change_field"),rt=(0,We.PH)("@metrics/change_type"),nt=(0,We.PH)("@metrics/change_attr"),it=(0,We.PH)("@metrics/change_setting"),at=(0,We.PH)("@metrics/change_meta"),lt=(e,t)=>{if(Ke.match(t))return[...e,C(t.payload)];if(et.match(t)){const s=e.find((e=>e.id===t.payload)),r=[s,...z(s,e)],n=e.filter((e=>!r.some((t=>t.id===e.id))));return 0===n.length?[C("1")]:n}return rt.match(t)?e.filter((e=>!R[t.payload.type].isSingleMetric||e.id===t.payload.id)).map((e=>e.id!==t.payload.id?e:Object.assign({id:e.id,type:t.payload.type},R[t.payload.type].defaults))):st.match(t)?e.map((e=>{if(e.id!==t.payload.id)return e;const s=Object.assign({},e,{field:t.payload.field});return I(e)?Object.assign({},s,{pipelineAgg:t.payload.field}):s})):tt.match(t)?e.map((e=>e.id!==t.payload?e:Object.assign({},e,{hide:!e.hide}))):it.match(t)?e.map((e=>{if(e.id!==t.payload.metric.id)return e;if(O(e)){const s=U(Object.assign({},e.settings,{[t.payload.settingName]:t.payload.newValue}));return Object.assign({},e,{settings:Object.assign({},s)})}return e})):at.match(t)?e.map((e=>e.id!==t.payload.metric.id?e:(e=>R[e.type].hasMeta)(e)?Object.assign({},e,{meta:Object.assign({},e.meta,{[t.payload.meta]:t.payload.newValue})}):e)):nt.match(t)?e.map((e=>e.id!==t.payload.metric.id?e:Object.assign({},e,{[t.payload.attribute]:t.payload.newValue}))):Qe.match(t)?null!=e&&e.length?e:[C("1")]:e},ot=(0,We.PH)("@bucketAggs/add"),ct=(0,We.PH)("@bucketAggs/remove"),dt=(0,We.PH)("@bucketAggs/change_type"),ut=(0,We.PH)("@bucketAggs/change_field"),mt=(0,We.PH)("@bucketAggs/change_setting"),pt=(0,be.createContext)(void 0),ht=(0,be.createContext)(void 0),gt=(0,be.createContext)(void 0),ft=e=>{let{children:t,onChange:s,onRunQuery:r,query:n,datasource:i,range:a}=e;const l=(0,be.useCallback)((e=>{s(e),r()}),[s,r]),o=(c={query:Ze,alias:Je,metrics:lt,bucketAggs:(d=i.timeField,(e,t)=>{if(ot.match(t)){const s={id:t.payload,type:"terms",settings:le.terms.defaultSettings},r=e[e.length-1];return"date_histogram"===(null==r?void 0:r.type)?[...e.slice(0,e.length-1),s,r]:[...e,s]}return ct.match(t)?e.filter((e=>e.id!==t.payload)):dt.match(t)?e.map((e=>e.id!==t.payload.id?e:{id:e.id,type:t.payload.newType,settings:le[t.payload.newType].defaultSettings})):ut.match(t)?e.map((e=>e.id!==t.payload.id?e:Object.assign({},e,{field:t.payload.newField}))):rt.match(t)?R[t.payload.type].isSingleMetric?[]:0===e.length?[Object.assign({},D("2"),{field:d})]:e:mt.match(t)?e.map((e=>{if(e.id!==t.payload.bucketAgg.id)return e;const s=U(Object.assign({},e.settings,{[t.payload.settingName]:t.payload.newValue}));return Object.assign({},e,{settings:Object.assign({},s)})})):Qe.match(t)?null!=e&&e.length?e:[Object.assign({},D("2"),{field:d})]:e})},(e,t)=>{const s={};for(const r in c)s[r]=c[r](e[r],t);return s});var c,d;const u=Ge((e=>l(Object.assign({},n,e,{timeField:i.timeField}))),n,o);return n.metrics&&n.bucketAggs&&void 0!==n.query?(0,Ee.jsx)(pt.Provider,{value:i,children:(0,Ee.jsx)(ht.Provider,{value:n,children:(0,Ee.jsx)(gt.Provider,{value:a,children:(0,Ee.jsx)(Ue.Provider,{value:u,children:t})})})}):(u(Qe()),null)},vt=e=>()=>{const t=(0,be.useContext)(e);if(!t)throw new Error("use ElasticsearchProvider first.");return t},bt=vt(ht),yt=vt(pt),jt=vt(gt),_t=["iconName","onClick","className","label"];const xt=ke.css`
  clip: rect(0 0 0 0);
  clip-path: inset(50%);
  height: 1px;
  overflow: hidden;
  position: absolute;
  white-space: nowrap;
  width: 1px;
`,Et=e=>{let{iconName:t,onClick:s,className:r,label:n}=e,i=function(e,t){if(null==e)return{};var s,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)s=i[r],t.indexOf(s)>=0||(n[s]=e[s]);return n}(e,_t);return(0,Ee.jsxs)("button",Object.assign({className:(0,ke.cx)("gf-form-label gf-form-label--btn query-part",r),onClick:s},i,{children:[(0,Ee.jsx)("span",{className:xt,children:n}),(0,Ee.jsx)(ye.Icon,{name:t,"aria-hidden":"true"})]}))},It=e=>{let{index:t,onAdd:s,onRemove:r,elements:n}=e;return(0,Ee.jsxs)("div",{className:ke.css`
        display: flex;
      `,children:[0===t&&(0,Ee.jsx)(Et,{iconName:"plus",onClick:s,label:"add"}),n.length>=2&&(0,Ee.jsx)(Et,{iconName:"minus",onClick:r,label:"remove"})]})},wt=ke.css`
  white-space: nowrap;
`,St=e=>({label:G(e),value:e}),Ot=e=>{let{options:t,onChange:s,className:r,value:n}=e;const i=t.find((e=>e.id===n));return(0,Ee.jsx)(ye.Segment,{className:(0,ke.cx)(r,wt),options:(a=t,a.map(St)),onChange:s,placeholder:"Select Metric",value:i?St(i):void 0});var a},$t=(0,We.PH)("@pipelineVariables/add"),Nt=(0,We.PH)("@pipelineVariables/remove"),At=(0,We.PH)("@pipelineVariables/rename"),Ft=(0,We.PH)("@pipelineVariables/change_metric"),Rt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return $t.match(t)?[...e,A(F(e))]:Nt.match(t)?e.slice(0,t.payload).concat(e.slice(t.payload+1)):At.match(t)?e.map(((e,s)=>s!==t.payload.index?e:Object.assign({},e,{name:t.payload.newName}))):Ft.match(t)?e.map(((e,s)=>s!==t.payload.index?e:Object.assign({},e,{pipelineAgg:t.payload.newMetric}))):e};function kt(e){let{label:t,settingName:s,metric:r,placeholder:i,tooltip:a}=e;const l=He(),[o]=(0,be.useState)((0,n.uniqueId)("es-field-id-")),c=r.settings;let d=(null==c?void 0:c[s])||"";return"script"===s&&(d=W(r)),(0,Ee.jsx)(ye.InlineField,{label:t,labelWidth:16,tooltip:a,children:(0,Ee.jsx)(ye.Input,{id:o,placeholder:i,onBlur:e=>l(it({metric:r,settingName:s,newValue:e.target.value})),defaultValue:d})})}var zt;const Lt=e=>{var t;let{value:s,previousMetrics:r}=e;const i=He(),a=Ge((e=>i(nt({metric:s,attribute:"pipelineVariables",newValue:e}))),s.pipelineVariables,Rt);return(0,be.useEffect)((()=>{var e;null!==(e=s.pipelineVariables)&&void 0!==e&&e.length||a($t())}),[a,null===(t=s.pipelineVariables)||void 0===t?void 0:t.length]),(0,Ee.jsxs)(Ee.Fragment,{children:[(0,Ee.jsxs)("div",{className:ke.css`
          display: flex;
        `,children:[zt||(zt=(0,Ee.jsx)(ye.InlineLabel,{width:16,children:"Variables"})),(0,Ee.jsx)("div",{className:ke.css`
            display: grid;
            grid-template-columns: 1fr auto;
            row-gap: 4px;
            margin-bottom: 4px;
          `,children:s.pipelineVariables.map(((e,t)=>(0,Ee.jsxs)(be.Fragment,{children:[(0,Ee.jsxs)("div",{className:ke.css`
                  display: grid;
                  column-gap: 4px;
                  grid-template-columns: auto auto;
                `,children:[(0,Ee.jsx)(ye.Input,{"aria-label":"Variable name",defaultValue:e.name,placeholder:"Variable Name",onBlur:e=>a(At({newName:e.target.value,index:t}))}),(0,Ee.jsx)(Ot,{onChange:e=>a(Ft({newMetric:e.value.id,index:t})),options:r,value:e.pipelineAgg})]}),(0,Ee.jsx)(It,{index:t,elements:s.pipelineVariables||[],onAdd:()=>a($t()),onRemove:()=>a(Nt(t))})]},(0,n.uniqueId)("es-bs-"))))})]}),(0,Ee.jsx)(kt,{label:"Script",metric:s,settingName:"script",tooltip:"Elasticsearch v5.0 and above: Scripting language is Painless. Use params.<var> to reference a variable. Elasticsearch pre-v5.0: Scripting language is per default Groovy if not changed. For Groovy use <var> to reference a variable.",placeholder:"params.var1 / params.var2"})]})},Tt=ke.css`
  min-width: 150px;
`,Mt=e=>{let{label:t,children:s,hidden:r=!1}=e;const[n,i]=(0,be.useState)(!1),a=((e,t)=>({wrapper:ke.css`
      max-width: 500px;
      display: flex;
      flex-direction: column;
    `,settingsWrapper:ke.css`
      padding-top: ${e.spacing(.5)};
    `,icon:ke.css`
      margin-right: ${e.spacing(.5)};
    `,button:ke.css`
      justify-content: start;
      ${t&&ke.css`
        color: ${e.colors.text.disabled};
      `}
    `}))((0,ye.useTheme2)(),r);return(0,Ee.jsx)(ye.InlineSegmentGroup,{children:(0,Ee.jsxs)("div",{className:(0,ke.cx)(a.wrapper),children:[(0,Ee.jsxs)("button",{className:(0,ke.cx)("gf-form-label query-part",a.button,Tt),onClick:()=>i(!n),"aria-expanded":n,children:[(0,Ee.jsx)(ye.Icon,{name:n?"angle-down":"angle-right","aria-hidden":"true",className:a.icon}),t]}),n&&(0,Ee.jsx)("div",{className:a.settingsWrapper,children:s})]})})},Pt=e=>{var t,s,r,i,a,l,o,c,d,u,m,p;let{metric:h}=e;const g=He(),{current:f}=(0,be.useRef)((0,n.uniqueId)("es-moving-avg-"));return(0,Ee.jsxs)(Ee.Fragment,{children:[(0,Ee.jsx)(ye.InlineField,{label:"Model",labelWidth:16,children:(0,Ee.jsx)(ye.Select,{inputId:`${f}-model`,menuShouldPortal:!0,onChange:e=>g(it({metric:h,settingName:"model",newValue:e.value})),options:T,value:null===(t=h.settings)||void 0===t?void 0:t.model})}),(0,Ee.jsx)(kt,{label:"Window",settingName:"window",metric:h,placeholder:"5"}),(0,Ee.jsx)(kt,{label:"Predict",settingName:"predict",metric:h}),(y(h)||j(h)||_(h))&&(0,Ee.jsx)(ye.InlineField,{label:"Alpha",labelWidth:16,children:(0,Ee.jsx)(ye.Input,{id:`${f}-alpha`,onBlur:e=>{var t;return g(it({metric:h,settingName:"settings",newValue:Object.assign({},null===(t=h.settings)||void 0===t?void 0:t.settings,{alpha:e.target.value})}))},defaultValue:null===(s=h.settings)||void 0===s||null===(r=s.settings)||void 0===r?void 0:r.alpha})}),(j(h)||_(h))&&(0,Ee.jsx)(ye.InlineField,{label:"Beta",labelWidth:16,children:(0,Ee.jsx)(ye.Input,{id:`${f}-beta`,onBlur:e=>{var t;return g(it({metric:h,settingName:"settings",newValue:Object.assign({},null===(t=h.settings)||void 0===t?void 0:t.settings,{beta:e.target.value})}))},defaultValue:null===(i=h.settings)||void 0===i||null===(a=i.settings)||void 0===a?void 0:a.beta})}),_(h)&&(0,Ee.jsxs)(Ee.Fragment,{children:[(0,Ee.jsx)(ye.InlineField,{label:"Gamma",labelWidth:16,children:(0,Ee.jsx)(ye.Input,{id:`${f}-gamma`,onBlur:e=>{var t;return g(it({metric:h,settingName:"settings",newValue:Object.assign({},null===(t=h.settings)||void 0===t?void 0:t.settings,{gamma:e.target.value})}))},defaultValue:null===(l=h.settings)||void 0===l||null===(o=l.settings)||void 0===o?void 0:o.gamma})}),(0,Ee.jsx)(ye.InlineField,{label:"Period",labelWidth:16,children:(0,Ee.jsx)(ye.Input,{id:`${f}-period`,onBlur:e=>{var t;return g(it({metric:h,settingName:"settings",newValue:Object.assign({},null===(t=h.settings)||void 0===t?void 0:t.settings,{period:e.target.value})}))},defaultValue:null===(c=h.settings)||void 0===c||null===(d=c.settings)||void 0===d?void 0:d.period})}),(0,Ee.jsx)(ye.InlineField,{label:"Pad",labelWidth:16,children:(0,Ee.jsx)(ye.InlineSwitch,{id:`${f}-pad`,onChange:e=>{var t;return g(it({metric:h,settingName:"settings",newValue:Object.assign({},null===(t=h.settings)||void 0===t?void 0:t.settings,{pad:e.target.checked})}))},checked:!(null===(u=h.settings)||void 0===u||null===(m=u.settings)||void 0===m||!m.pad)})})]}),(y(h)||j(h)||_(h))&&(0,Ee.jsx)(ye.InlineField,{label:"Minimize",labelWidth:16,children:(0,Ee.jsx)(ye.InlineSwitch,{id:`${f}-minimize`,onChange:e=>g(it({metric:h,settingName:"minimize",newValue:e.target.checked})),checked:!(null===(p=h.settings)||void 0===p||!p.minimize)})})]})},Ct=e=>{if(t=e,N.includes(t))return"cardinality"===e?[]:["number"];var t;if((e=>me.includes(e))(e))switch(e){case"date_histogram":return["date"];case"geohash_grid":return["geo_point"];case"histogram":return["number"];default:return[]}return[]},Dt=e=>{let{text:t}=e;return{label:t,value:t}},qt=e=>{const t=yt(),s=jt(),r=Array.isArray(e)?e:Ct(e);let n;return async e=>(n||(n=await(0,i.n)(t.getFields(r,s))),n.filter((t=>{let{text:s}=t;return void 0===e||s.includes(e)})).map(Dt))},Vt=e=>({value:e,label:e}),Bt=e=>{var t,s,r,n;let{metric:i}=e;const a=He(),l=qt(["number","date"]),o=qt(i.type);return(0,Ee.jsxs)(Ee.Fragment,{children:[(0,Ee.jsx)(ye.InlineField,{label:"Metrics",labelWidth:16,children:(0,Ee.jsx)(ye.AsyncMultiSelect,{menuShouldPortal:!0,onChange:e=>a(it({metric:i,settingName:"metrics",newValue:e.map((e=>e.value))})),loadOptions:o,value:null===(t=i.settings)||void 0===t||null===(s=t.metrics)||void 0===s?void 0:s.map(Vt),closeMenuOnSelect:!1,defaultOptions:!0})}),(0,Ee.jsx)(ye.InlineField,{label:"Order",labelWidth:16,children:(0,Ee.jsx)(ye.Select,{menuShouldPortal:!0,onChange:e=>a(it({metric:i,settingName:"order",newValue:e.value})),options:ce,value:null===(r=i.settings)||void 0===r?void 0:r.order})}),(0,Ee.jsx)(ye.InlineField,{label:"Order By",labelWidth:16,className:ke.css`
          & > div {
            width: 100%;
          }
        `,children:(0,Ee.jsx)(ye.SegmentAsync,{className:ke.css`
            margin-right: 0;
          `,loadOptions:l,onChange:e=>a(it({metric:i,settingName:"orderBy",newValue:e.value})),placeholder:"Select Field",value:null===(n=i.settings)||void 0===n?void 0:n.orderBy})})]})},Gt={labelWidth:16},Ut=e=>{var t,s,r,i,a,l,o;let{metric:c,previousMetrics:d}=e;const{current:u}=(0,be.useRef)((0,n.uniqueId)("es-setting-")),m=He(),p=(e=>{var t,s,r;switch(e.type){case"cardinality":var n;return`Precision threshold: ${(null===(n=e.settings)||void 0===n?void 0:n.precision_threshold)||""}`;case"percentiles":var i;return null!==(t=e.settings)&&void 0!==t&&t.percents&&(null===(s=e.settings)||void 0===s||null===(r=s.percents)||void 0===r?void 0:r.length)>=1?`Values: ${null===(i=e.settings)||void 0===i?void 0:i.percents}`:"Percents: Default";case"extended_stats":{const t=Object.entries(e.meta||{}).map((e=>{var t;let[s,r]=e;return r&&(null===(t=L.find((e=>t=>t.value===e)(s)))||void 0===t?void 0:t.label)})).filter(Boolean);return`Stats: ${t.length>0?t.join(", "):"None selected"}`}case"raw_document":case"raw_data":var a;return`Size: ${(null===(a=e.settings)||void 0===a?void 0:a.size)||500}`;default:return"Options"}})(c),h=bt();return(0,Ee.jsxs)(Mt,{label:p,hidden:c.hide,children:["derivative"===c.type&&(0,Ee.jsx)(kt,{label:"Unit",metric:c,settingName:"unit"}),"serial_diff"===c.type&&(0,Ee.jsx)(kt,{label:"Lag",metric:c,settingName:"lag",placeholder:"1"}),"cumulative_sum"===c.type&&(0,Ee.jsx)(kt,{label:"Format",metric:c,settingName:"format"}),"moving_avg"===c.type&&(0,Ee.jsx)(Pt,{metric:c}),"moving_fn"===c.type&&(0,Ee.jsxs)(Ee.Fragment,{children:[(0,Ee.jsx)(kt,{label:"Window",metric:c,settingName:"window"}),(0,Ee.jsx)(kt,{label:"Script",metric:c,settingName:"script"}),(0,Ee.jsx)(kt,{label:"Shift",metric:c,settingName:"shift"})]}),"top_metrics"===c.type&&(0,Ee.jsx)(Bt,{metric:c}),"bucket_script"===c.type&&(0,Ee.jsx)(Lt,{value:c,previousMetrics:d}),("raw_data"===c.type||"raw_document"===c.type)&&(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Size"},Gt,{children:(0,Ee.jsx)(ye.Input,{id:`ES-query-${h.refId}_metric-${c.id}-size`,onBlur:e=>m(it({metric:c,settingName:"size",newValue:e.target.value})),defaultValue:null!==(t=null===(s=c.settings)||void 0===s?void 0:s.size)&&void 0!==t?t:null===(r=R.raw_data.defaults.settings)||void 0===r?void 0:r.size})})),"logs"===c.type&&(0,Ee.jsx)(kt,{label:"Limit",metric:c,settingName:"limit",placeholder:"500"}),"cardinality"===c.type&&(0,Ee.jsx)(kt,{label:"Precision Threshold",metric:c,settingName:"precision_threshold"}),"extended_stats"===c.type&&(0,Ee.jsxs)(Ee.Fragment,{children:[L.map((e=>{var t,s,r;return(0,Ee.jsx)(Ht,{stat:e,onChange:t=>m(at({metric:c,meta:e.value,newValue:t})),value:void 0!==(null===(t=c.meta)||void 0===t?void 0:t[e.value])?!(null===(s=c.meta)||void 0===s||!s[e.value]):!(null===(r=R.extended_stats.defaults.meta)||void 0===r||!r[e.value])},e.value)})),(0,Ee.jsx)(kt,{label:"Sigma",metric:c,settingName:"sigma",placeholder:"3"})]}),"percentiles"===c.type&&(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Percentiles"},Gt,{children:(0,Ee.jsx)(ye.Input,{id:`${u}-percentiles-percents`,onBlur:e=>m(it({metric:c,settingName:"percents",newValue:e.target.value.split(",").filter(Boolean)})),defaultValue:(null===(i=c.settings)||void 0===i?void 0:i.percents)||(null===(a=R.percentiles.defaults.settings)||void 0===a?void 0:a.percents),placeholder:"1,5,25,50,75,95,99"})})),"rate"===c.type&&(0,Ee.jsxs)(Ee.Fragment,{children:[(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Unit"},Gt,{"data-testid":"unit-select",children:(0,Ee.jsx)(ye.Select,{menuShouldPortal:!0,id:`ES-query-${h.refId}_metric-${c.id}-unit`,onChange:e=>m(it({metric:c,settingName:"unit",newValue:e.value})),options:[{value:"second",label:"Second"},{value:"minute",label:"Minute"},{value:"hour",label:"Hour"},{value:"day",label:"Day"},{value:"week",label:"Week"},{value:"month",label:"Month"},{value:"quarter",label:"Quarter"},{value:"Year",label:"Year"}],value:null===(l=c.settings)||void 0===l?void 0:l.unit})})),(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Mode"},Gt,{"data-testid":"mode-select",children:(0,Ee.jsx)(ye.Select,{menuShouldPortal:!0,id:`ES-query-${h.refId}_metric-${c.id}-mode`,onChange:e=>m(it({metric:c,settingName:"mode",newValue:e.value})),options:[{value:"sum",label:"Sum"},{value:"value_count",label:"Value count"}],value:null===(o=c.settings)||void 0===o?void 0:o.unit})}))]}),$(c)&&(0,Ee.jsx)(kt,{label:"Script",metric:c,settingName:"script",placeholder:"_value * 1"}),S(c)&&(0,Ee.jsx)(kt,{label:"Missing",metric:c,settingName:"missing",tooltip:"The missing parameter defines how documents that are missing a value should be treated. By default they will be ignored but it is also possible to treat them as if they had a value"})]})},Ht=e=>{let{stat:t,onChange:s,value:r}=e;const[i]=(0,be.useState)((0,n.uniqueId)("es-field-id-"));return(0,be.createElement)(ye.InlineField,Object.assign({label:t.label},Gt,{key:t.value}),(0,Ee.jsx)(ye.InlineSwitch,{id:i,onChange:e=>s(e.target.checked),value:r}))},Wt=e=>!R[e.type].isPipelineAgg,Qt=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.some(Wt);return Object.entries(R).filter((e=>{let[s,{versionRange:r="*"}]=e;return(0,g.satisfies)(t,r)})).filter((e=>{let[t,s]=e;return r||!s.isPipelineAgg})).filter((e=>{let[t,r]=e;return!r.xpack||s})).map((e=>{let[t,{label:s}]=e;return{label:s,value:t}}))},Xt=e=>{let{value:t}=e;const s=(r=(0,ye.useTheme2)(),{color:(n=!!t.hide)&&ke.css`
        &,
        &:hover,
        label,
        a {
          color: ${n?r.colors.text.disabled:r.colors.text.primary};
        }
      `});var r,n;const i=yt(),a=bt(),l=He(),o=qt(t.type),c=(0,be.useCallback)((async()=>{const e=await o();return $(t)?[{label:"None"},...e]:e}),[o,t]),d=a.metrics.slice(0,a.metrics.findIndex((e=>e.id===t.id)));return(0,Ee.jsxs)(Ee.Fragment,{children:[(0,Ee.jsxs)(ye.InlineSegmentGroup,{children:[(0,Ee.jsx)(ye.Segment,{className:(0,ke.cx)(s.color,Tt),options:Qt(d,i.esVersion,i.xpack),onChange:e=>l(rt({id:t.id,type:e.value})),value:(u=t,{label:R[u.type].label,value:u.type})}),E(t)&&!I(t)&&(0,Ee.jsx)(ye.SegmentAsync,{className:(0,ke.cx)(s.color,Tt),loadOptions:c,onChange:e=>l(st({id:t.id,field:e.value})),placeholder:"Select Field",value:t.field}),I(t)&&!w(t)&&(0,Ee.jsx)(Ot,{className:(0,ke.cx)(s.color,Tt),onChange:e=>{var s;return l(st({id:t.id,field:null===(s=e.value)||void 0===s?void 0:s.id}))},options:d,value:t.field})]}),O(t)&&(0,Ee.jsx)(Ut,{metric:t,previousMetrics:d})]});var u},Yt=e=>{let{children:t,label:s,onRemoveClick:r,onHideClick:i,hidden:a=!1}=e;const l=(0,ye.useStyles2)(Zt);return(0,Ee.jsxs)(ye.InlineFieldRow,{children:[(0,Ee.jsx)(ye.InlineSegmentGroup,{children:(0,Ee.jsxs)(ye.InlineLabel,{width:17,as:"div",children:[(0,Ee.jsx)("span",{children:s}),(0,Ee.jsxs)("span",{className:l.iconWrapper,children:[i&&(0,Ee.jsx)(ye.IconButton,{name:a?"eye-slash":"eye",onClick:i,surface:"header",size:"sm","aria-pressed":a,"aria-label":"hide metric",className:l.icon}),(0,Ee.jsx)(ye.IconButton,{name:"trash-alt",surface:"header",size:"sm",className:l.icon,onClick:r||n.noop,disabled:!r,"aria-label":"remove metric"})]})]})}),t]})},Zt=e=>({iconWrapper:ke.css`
      display: flex;
    `,icon:ke.css`
      color: ${e.colors.text.secondary};
      margin-left: ${e.spacing(.25)};
    `}),Jt=e=>{let{nextId:t}=e;const s=He(),{metrics:r}=bt(),n=(null==r?void 0:r.length)||0;return(0,Ee.jsx)(Ee.Fragment,{children:null==r?void 0:r.map(((e,r)=>(0,Ee.jsxs)(Yt,{label:`Metric (${e.id})`,hidden:e.hide,onHideClick:()=>s(tt(e.id)),onRemoveClick:n>1&&(()=>s(et(e.id))),children:[(0,Ee.jsx)(Xt,{value:e}),!R[e.type].isSingleMetric&&0===r&&(0,Ee.jsx)(Et,{iconName:"plus",onClick:()=>s(Ke(t)),label:"add"})]},`${e.type}-${e.id}`)))})},Kt=(0,We.PH)("@bucketAggregations/filter/add"),es=(0,We.PH)("@bucketAggregations/filter/remove"),ts=(0,We.PH)("@bucketAggregations/filter/change"),ss=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return Kt.match(t)?[...e,{label:"",query:"*"}]:es.match(t)?e.slice(0,t.payload).concat(e.slice(t.payload+1)):ts.match(t)?e.map(((e,s)=>s!==t.payload.index?e:t.payload.filter)):e},rs=e=>{var t,s,r,i;let{bucketAgg:a}=e;const{current:l}=(0,be.useRef)((0,n.uniqueId)("es-filters-")),o=He(),c=Ge((e=>o(mt({bucketAgg:a,settingName:"filters",newValue:e}))),null===(t=a.settings)||void 0===t?void 0:t.filters,ss);return(0,be.useEffect)((()=>{var e,t;null!==(e=a.settings)&&void 0!==e&&null!==(t=e.filters)&&void 0!==t&&t.length||c(Kt())}),[c,null===(s=a.settings)||void 0===s||null===(r=s.filters)||void 0===r?void 0:r.length]),(0,Ee.jsx)(Ee.Fragment,{children:(0,Ee.jsx)("div",{className:ke.css`
          display: flex;
          flex-direction: column;
        `,children:null===(i=a.settings)||void 0===i?void 0:i.filters.map(((e,t)=>{var s;return(0,Ee.jsxs)("div",{className:ke.css`
              display: flex;
            `,children:[(0,Ee.jsx)(ye.InlineField,{label:"Query",labelWidth:8,children:(0,Ee.jsx)("div",{className:ke.css`
                  width: 150px;
                `,children:(0,Ee.jsx)(ye.QueryField,{placeholder:"Lucene Query",portalOrigin:"elasticsearch",onBlur:()=>{},onChange:s=>c(ts({index:t,filter:Object.assign({},e,{query:s})})),query:e.query})})}),(0,Ee.jsx)(ye.InlineField,{label:"Label",labelWidth:8,children:(0,Ee.jsx)(ye.Input,{width:16,id:`${l}-label-${t}`,placeholder:"Label",onBlur:s=>c(ts({index:t,filter:Object.assign({},e,{label:s.target.value})})),defaultValue:e.label})}),(0,Ee.jsx)(It,{index:t,elements:(null===(s=a.settings)||void 0===s?void 0:s.filters)||[],onAdd:()=>c(Kt()),onRemove:()=>c(es(t))})]},t)}))})})},ns=e=>t=>t.value===e,is=e=>{let{options:t,value:s,onChange:r}=e;const[n,i]=(0,be.useState)(((e,t)=>{return void 0===t||e.some((s=t,e=>{let{value:t}=e;return t===s}))?e:[...e,{value:t,label:t}];var s})(t,s));return{onCreateOption:e=>{var t;t=e,i([...n,{value:t,label:t}]),r({value:e})},onChange:r,allowCustomValue:!0,options:n,value:s}},as=[{label:"auto",value:"auto"},{label:"10s",value:"10s"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"20m",value:"20m"},{label:"1h",value:"1h"},{label:"1d",value:"1d"}],ls=(e,t,s)=>{var r;return!s.some((r=e,e=>{let{value:t}=e;return t===r}))&&e.trim().length>0},os=(e,t)=>{var s;return(null===(s=e.value)||void 0===s?void 0:s.startsWith(t))||!1},cs=e=>{var t,s,i,a,l,o,c,d,u,m;let{bucketAgg:p}=e;const h=He(),{current:g}=(0,be.useRef)((0,n.uniqueId)("es-date_histogram-"));return(0,Ee.jsxs)(Ee.Fragment,{children:[(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Interval"},gs,{children:(0,Ee.jsx)(ye.Select,Object.assign({menuShouldPortal:!0,inputId:(0,n.uniqueId)("es-date_histogram-interval"),isValidNewOption:ls,filterOption:os},is({options:as,value:(null===(t=p.settings)||void 0===t?void 0:t.interval)||(null===(s=le.date_histogram.defaultSettings)||void 0===s?void 0:s.interval),onChange:e=>{let{value:t}=e;return h(mt({bucketAgg:p,settingName:"interval",newValue:t}))}})))})),(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Min Doc Count"},gs,{children:(0,Ee.jsx)(ye.Input,{id:`${g}-min_doc_count`,onBlur:e=>h(mt({bucketAgg:p,settingName:"min_doc_count",newValue:e.target.value})),defaultValue:(null===(i=p.settings)||void 0===i?void 0:i.min_doc_count)||(null===(a=le.date_histogram.defaultSettings)||void 0===a?void 0:a.min_doc_count)})})),(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Trim Edges"},gs,{tooltip:"Trim the edges on the timeseries datapoints",children:(0,Ee.jsx)(ye.Input,{id:`${g}-trime_edges`,onBlur:e=>h(mt({bucketAgg:p,settingName:"trimEdges",newValue:e.target.value})),defaultValue:(null===(l=p.settings)||void 0===l?void 0:l.trimEdges)||(null===(o=le.date_histogram.defaultSettings)||void 0===o?void 0:o.trimEdges)})})),(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Offset"},gs,{tooltip:"Change the start value of each bucket by the specified positive (+) or negative offset (-) duration, such as 1h for an hour, or 1d for a day",children:(0,Ee.jsx)(ye.Input,{id:`${g}-offset`,onBlur:e=>h(mt({bucketAgg:p,settingName:"offset",newValue:e.target.value})),defaultValue:(null===(c=p.settings)||void 0===c?void 0:c.offset)||(null===(d=le.date_histogram.defaultSettings)||void 0===d?void 0:d.offset)})})),(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Timezone"},gs,{children:(0,Ee.jsx)(ye.TimeZonePicker,{value:(null===(u=p.settings)||void 0===u?void 0:u.timeZone)||(null===(m=le.date_histogram.defaultSettings)||void 0===m?void 0:m.timeZone),includeInternal:[r.InternalTimeZones.utc],onChange:e=>{h(mt({bucketAgg:p,settingName:"timeZone",newValue:e}))}})}))]})},ds=e=>{var t,s,r,i,a,l,o,c,d,u;let{bucketAgg:m}=e;const{metrics:p}=bt(),h=hs(p),{current:g}=(0,be.useRef)((0,n.uniqueId)("es-terms-")),f=He();return(0,Ee.jsxs)(Ee.Fragment,{children:[(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Order"},gs,{children:(0,Ee.jsx)(ye.Select,{inputId:`${g}-order`,menuShouldPortal:!0,onChange:e=>f(mt({bucketAgg:m,settingName:"order",newValue:e.value})),options:ce,value:(null===(t=m.settings)||void 0===t?void 0:t.order)||(null===(s=le.terms.defaultSettings)||void 0===s?void 0:s.order)})})),(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Size"},gs,{children:(0,Ee.jsx)(ye.Select,Object.assign({inputId:`${g}-size`,menuShouldPortal:!0},is({options:de,value:(null===(r=m.settings)||void 0===r?void 0:r.size)||(null===(i=le.terms.defaultSettings)||void 0===i?void 0:i.size),onChange(e){let{value:t}=e;f(mt({bucketAgg:m,settingName:"size",newValue:t}))}})))})),(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Min Doc Count"},gs,{children:(0,Ee.jsx)(ye.Input,{id:`${g}-min_doc_count`,onBlur:e=>f(mt({bucketAgg:m,settingName:"min_doc_count",newValue:e.target.value})),defaultValue:(null===(a=m.settings)||void 0===a?void 0:a.min_doc_count)||(null===(l=le.terms.defaultSettings)||void 0===l?void 0:l.min_doc_count)})})),(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Order By"},gs,{children:(0,Ee.jsx)(ye.Select,{inputId:`${g}-order_by`,menuShouldPortal:!0,onChange:e=>f(mt({bucketAgg:m,settingName:"orderBy",newValue:e.value})),options:h,value:(null===(o=m.settings)||void 0===o?void 0:o.orderBy)||(null===(c=le.terms.defaultSettings)||void 0===c?void 0:c.orderBy)})})),(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Missing"},gs,{children:(0,Ee.jsx)(ye.Input,{id:`${g}-missing`,onBlur:e=>f(mt({bucketAgg:m,settingName:"missing",newValue:e.target.value})),defaultValue:(null===(d=m.settings)||void 0===d?void 0:d.missing)||(null===(u=le.terms.defaultSettings)||void 0===u?void 0:u.missing)})}))]})};function us(e){if(!e.meta)return[];return Object.keys(e.meta).filter((t=>{var s;return null===(s=e.meta)||void 0===s?void 0:s[t]})).map((t=>{let s=t;return"std_deviation_bounds_lower"===t&&(s="std_lower"),"std_deviation_bounds_upper"===t&&(s="std_upper"),{label:`${G(e)} (${s})`,value:`${e.id}[${s}]`}}))}function ms(e){var t;return null!==(t=e.settings)&&void 0!==t&&t.percents?e.settings.percents.map((t=>{const s=/^\d+\.\d+/.test(`${t}`)?t:`${t}.0`;return{label:`${G(e)} (${t})`,value:`${e.id}[${s}]`}})):[]}function ps(e){return"top_metrics"!==e.type&&!I(e)}const hs=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=e.filter(ps).flatMap((e=>"extended_stats"===e.type?us(e):"percentiles"===e.type?ms(e):{label:G(e),value:e.id}));return[...oe,...t]},gs={labelWidth:16},fs=e=>{var t,s,r,i,a,l;let{bucketAgg:o}=e;const{current:c}=(0,be.useRef)((0,n.uniqueId)("es-setting-")),d=He(),u=(e=>{const{metrics:t}=bt();switch(e.type){case"terms":{var s,r,n,i;const l=(null===(s=e.settings)||void 0===s?void 0:s.order)||"desc",o=(null===(r=e.settings)||void 0===r?void 0:r.size)||"10",c=parseInt((null===(n=e.settings)||void 0===n?void 0:n.min_doc_count)||"0",10),d=(null===(i=e.settings)||void 0===i?void 0:i.orderBy)||"_term";let u="";var a;if("0"!==o)u=`${null===(a=ce.find(ns(l)))||void 0===a?void 0:a.label} ${o}, `;c>0&&(u+=`Min Doc Count: ${c}, `),u+="Order by: ";const m=oe.find(ns(d));if(m)u+=m.label;else{const e=null==t?void 0:t.find((e=>e.id===H(d)));u+=e?G(e):"metric not found"}return"0"===o&&(u+=` (${l})`),u}case"histogram":{var l,o;const t=(null===(l=e.settings)||void 0===l?void 0:l.interval)||1e3,s=(null===(o=e.settings)||void 0===o?void 0:o.min_doc_count)||1;return`Interval: ${t}${s>0?`, Min Doc Count: ${s}`:""}`}case"filters":var c,d;return`Filter Queries (${((null===(c=e.settings)||void 0===c?void 0:c.filters)||(null===(d=le.filters.defaultSettings)||void 0===d?void 0:d.filters)).length})`;case"geohash_grid":var u;return`Precision: ${Math.max(Math.min(parseInt((null===(u=e.settings)||void 0===u?void 0:u.precision)||"5",10),12),1)}`;case"date_histogram":{var m,p,h;const t=(null===(m=e.settings)||void 0===m?void 0:m.interval)||"auto",s=(null===(p=e.settings)||void 0===p?void 0:p.min_doc_count)||0,r=(null===(h=e.settings)||void 0===h?void 0:h.trimEdges)||0;let n=`Interval: ${t}`;return s>0&&(n+=`, Min Doc Count: ${s}`),r>0&&(n+=`, Trim edges: ${r}`),n}default:return"Settings"}})(o);return(0,Ee.jsxs)(Mt,{label:u,children:["terms"===o.type&&(0,Ee.jsx)(ds,{bucketAgg:o}),"date_histogram"===o.type&&(0,Ee.jsx)(cs,{bucketAgg:o}),"filters"===o.type&&(0,Ee.jsx)(rs,{bucketAgg:o}),"geohash_grid"===o.type&&(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Precision"},gs,{children:(0,Ee.jsx)(ye.Input,{id:`${c}-geohash_grid-precision`,onBlur:e=>d(mt({bucketAgg:o,settingName:"precision",newValue:e.target.value})),defaultValue:(null===(t=o.settings)||void 0===t?void 0:t.precision)||(null===(s=le[o.type].defaultSettings)||void 0===s?void 0:s.precision)})})),"histogram"===o.type&&(0,Ee.jsxs)(Ee.Fragment,{children:[(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Interval"},gs,{children:(0,Ee.jsx)(ye.Input,{id:`${c}-histogram-interval`,onBlur:e=>d(mt({bucketAgg:o,settingName:"interval",newValue:e.target.value})),defaultValue:(null===(r=o.settings)||void 0===r?void 0:r.interval)||(null===(i=le[o.type].defaultSettings)||void 0===i?void 0:i.interval)})})),(0,Ee.jsx)(ye.InlineField,Object.assign({label:"Min Doc Count"},gs,{children:(0,Ee.jsx)(ye.Input,{id:`${c}-histogram-min_doc_count`,onBlur:e=>d(mt({bucketAgg:o,settingName:"min_doc_count",newValue:e.target.value})),defaultValue:(null===(a=o.settings)||void 0===a?void 0:a.min_doc_count)||(null===(l=le[o.type].defaultSettings)||void 0===l?void 0:l.min_doc_count)})}))]})]})},vs=Object.entries(le).map((e=>{let[t,{label:s}]=e;return{label:s,value:t}})),bs=e=>{let{value:t}=e;const s=He(),r=qt(t.type);return(0,Ee.jsxs)(Ee.Fragment,{children:[(0,Ee.jsxs)(ye.InlineSegmentGroup,{children:[(0,Ee.jsx)(ye.Segment,{className:Tt,options:vs,onChange:e=>s(dt({id:t.id,newType:e.value})),value:(n=t,{label:le[n.type].label,value:n.type})}),ue(t)&&(0,Ee.jsx)(ye.SegmentAsync,{className:Tt,loadOptions:r,onChange:e=>s(ut({id:t.id,newField:e.value})),placeholder:"Select Field",value:t.field})]}),(0,Ee.jsx)(fs,{bucketAgg:t})]});var n},ys=e=>{let{nextId:t}=e;const s=He(),{bucketAggs:r}=bt(),n=(null==r?void 0:r.length)||0;return(0,Ee.jsx)(Ee.Fragment,{children:r.map(((e,r)=>(0,Ee.jsxs)(Yt,{label:0===r?"Group By":"Then By",onRemoveClick:n>1&&(()=>s(ct(e.id))),children:[(0,Ee.jsx)(bs,{value:e}),0===r&&(0,Ee.jsx)(Et,{iconName:"plus",onClick:()=>s(ot(t)),label:"add"})]},`${e.type}-${e.id}`)))})},js=e=>e.id,_s=e=>parseInt(e,10);var xs;const Es=e=>({root:ke.css`
    display: flex;
  `,queryFieldWrapper:ke.css`
    flex-grow: 1;
    margin: 0 ${e.spacing(.5)} ${e.spacing(.5)} 0;
  `}),Is=e=>{var t,s,r;let{value:n}=e;const i=He(),a=(()=>{const{metrics:e,bucketAggs:t}=bt();return(0,be.useMemo)((()=>(Math.max(...[...(null==e?void 0:e.map(js))||["0"],...(null==t?void 0:t.map(js))||["0"]].map(_s))+1).toString()),[e,t])})(),l=(0,ye.useStyles2)(Es),o="date_histogram"===(null===(t=n.bucketAggs)||void 0===t||null===(s=t.slice(-1)[0])||void 0===s?void 0:s.type),c=null===(r=n.metrics)||void 0===r?void 0:r.every((e=>!R[e.type].isSingleMetric));return(0,Ee.jsxs)(Ee.Fragment,{children:[(0,Ee.jsxs)("div",{className:l.root,children:[xs||(xs=(0,Ee.jsx)(ye.InlineLabel,{width:17,children:"Query"})),(0,Ee.jsx)("div",{className:l.queryFieldWrapper,children:(0,Ee.jsx)(ye.QueryField,{query:n.query,onBlur:()=>{},onChange:e=>i(Xe(e)),placeholder:"Lucene Query",portalOrigin:"elasticsearch"})}),(0,Ee.jsx)(ye.InlineField,{label:"Alias",labelWidth:15,disabled:!o,tooltip:"Aliasing only works for timeseries queries (when the last group is 'Date Histogram'). For all other query types this field is ignored.",children:(0,Ee.jsx)(ye.Input,{id:`ES-query-${n.refId}_alias`,placeholder:"Alias Pattern",onBlur:e=>i(Ye(e.currentTarget.value)),defaultValue:n.alias})})]}),(0,Ee.jsx)(Jt,{nextId:a}),c&&(0,Ee.jsx)(ys,{nextId:a})]})};class ws{}var Ss,Os,$s;$s="partials/annotations.editor.html",(Os="templateUrl")in(Ss=ws)?Object.defineProperty(Ss,Os,{value:$s,enumerable:!0,configurable:!0,writable:!0}):Ss[Os]=$s;const Ns=new r.DataSourcePlugin(fe).setQueryEditor((e=>{let{query:t,onChange:s,onRunQuery:n,datasource:i,range:a}=e;return(0,Ee.jsx)(ft,{datasource:i,onChange:s,onRunQuery:n,query:t,range:a||(0,r.getDefaultTimeRange)(),children:(0,Ee.jsx)(Is,{value:t})})})).setConfigEditor((e=>{const{options:t,onOptionsChange:s}=e,r=je(t);return(0,be.useEffect)((()=>{(e=>!!(0,g.valid)(e.jsonData.esVersion)&&!!e.jsonData.timeField&&!!e.jsonData.maxConcurrentShardRequests&&void 0!==e.jsonData.logMessageField&&void 0!==e.jsonData.logLevelField)(t)||s(je(t))}),[]),(0,Ee.jsxs)(Ee.Fragment,{children:["direct"===r.access&&(Ve||(Ve=(0,Ee.jsx)(ye.Alert,{title:"Deprecation Notice",severity:"warning",children:"Browser access mode in the Elasticsearch datasource is deprecated and will be removed in a future release."}))),(0,Ee.jsx)(ye.DataSourceHttpSettings,{defaultUrl:"http://localhost:9200",dataSourceConfig:r,showAccessOptions:!0,onChange:s,sigV4AuthToggleEnabled:Be.vc.sigV4AuthEnabled}),(0,Ee.jsx)(Se,{value:r,onChange:s}),(0,Ee.jsx)(Re,{value:r.jsonData,onChange:e=>s(Object.assign({},r,{jsonData:e}))}),(0,Ee.jsx)(qe,{value:r.jsonData.dataLinks,onChange:e=>{s(Object.assign({},r,{jsonData:Object.assign({},r.jsonData,{dataLinks:e})}))}})]})})).setAnnotationQueryCtrl(ws)},"./.yarn/__virtual__/react-use-virtual-00326e70ba/0/cache/react-use-npm-17.3.2-a032cbeb01-7379460f51.zip/node_modules/react-use/esm/usePrevious.js":(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var r=s("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js");function n(e){var t=(0,r.useRef)();return(0,r.useEffect)((function(){t.current=e})),t.current}},"./.yarn/cache/lru-cache-npm-6.0.0-b4c8668fe1-f97f499f89.zip/node_modules/lru-cache/index.js":(e,t,s)=>{"use strict";const r=s("./.yarn/cache/yallist-npm-4.0.0-b493d9e907-343617202a.zip/node_modules/yallist/yallist.js"),n=Symbol("max"),i=Symbol("length"),a=Symbol("lengthCalculator"),l=Symbol("allowStale"),o=Symbol("maxAge"),c=Symbol("dispose"),d=Symbol("noDisposeOnSet"),u=Symbol("lruList"),m=Symbol("cache"),p=Symbol("updateAgeOnGet"),h=()=>1;const g=(e,t,s)=>{const r=e[m].get(t);if(r){const t=r.value;if(f(e,t)){if(b(e,r),!e[l])return}else s&&(e[p]&&(r.value.now=Date.now()),e[u].unshiftNode(r));return t.value}},f=(e,t)=>{if(!t||!t.maxAge&&!e[o])return!1;const s=Date.now()-t.now;return t.maxAge?s>t.maxAge:e[o]&&s>e[o]},v=e=>{if(e[i]>e[n])for(let t=e[u].tail;e[i]>e[n]&&null!==t;){const s=t.prev;b(e,t),t=s}},b=(e,t)=>{if(t){const s=t.value;e[c]&&e[c](s.key,s.value),e[i]-=s.length,e[m].delete(s.key),e[u].removeNode(t)}};class y{constructor(e,t,s,r,n){this.key=e,this.value=t,this.length=s,this.now=r,this.maxAge=n||0}}const j=(e,t,s,r)=>{let n=s.value;f(e,n)&&(b(e,s),e[l]||(n=void 0)),n&&t.call(r,n.value,n.key,e)};e.exports=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[n]=e.max||1/0;const t=e.length||h;if(this[a]="function"!=typeof t?h:t,this[l]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[o]=e.maxAge||0,this[c]=e.dispose,this[d]=e.noDisposeOnSet||!1,this[p]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[n]=e||1/0,v(this)}get max(){return this[n]}set allowStale(e){this[l]=!!e}get allowStale(){return this[l]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[o]=e,v(this)}get maxAge(){return this[o]}set lengthCalculator(e){"function"!=typeof e&&(e=h),e!==this[a]&&(this[a]=e,this[i]=0,this[u].forEach((e=>{e.length=this[a](e.value,e.key),this[i]+=e.length}))),v(this)}get lengthCalculator(){return this[a]}get length(){return this[i]}get itemCount(){return this[u].length}rforEach(e,t){t=t||this;for(let s=this[u].tail;null!==s;){const r=s.prev;j(this,e,s,t),s=r}}forEach(e,t){t=t||this;for(let s=this[u].head;null!==s;){const r=s.next;j(this,e,s,t),s=r}}keys(){return this[u].toArray().map((e=>e.key))}values(){return this[u].toArray().map((e=>e.value))}reset(){this[c]&&this[u]&&this[u].length&&this[u].forEach((e=>this[c](e.key,e.value))),this[m]=new Map,this[u]=new r,this[i]=0}dump(){return this[u].map((e=>!f(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[u]}set(e,t,s){if((s=s||this[o])&&"number"!=typeof s)throw new TypeError("maxAge must be a number");const r=s?Date.now():0,l=this[a](t,e);if(this[m].has(e)){if(l>this[n])return b(this,this[m].get(e)),!1;const a=this[m].get(e).value;return this[c]&&(this[d]||this[c](e,a.value)),a.now=r,a.maxAge=s,a.value=t,this[i]+=l-a.length,a.length=l,this.get(e),v(this),!0}const p=new y(e,t,l,r,s);return p.length>this[n]?(this[c]&&this[c](e,t),!1):(this[i]+=p.length,this[u].unshift(p),this[m].set(e,this[u].head),v(this),!0)}has(e){if(!this[m].has(e))return!1;const t=this[m].get(e).value;return!f(this,t)}get(e){return g(this,e,!0)}peek(e){return g(this,e,!1)}pop(){const e=this[u].tail;return e?(b(this,e),e.value):null}del(e){b(this,this[m].get(e))}load(e){this.reset();const t=Date.now();for(let s=e.length-1;s>=0;s--){const r=e[s],n=r.e||0;if(0===n)this.set(r.k,r.v);else{const e=n-t;e>0&&this.set(r.k,r.v,e)}}}prune(){this[m].forEach(((e,t)=>g(this,t,!1)))}}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/comparator.js":(e,t,s)=>{const r=Symbol("SemVer ANY");class n{static get ANY(){return r}constructor(e,t){if(t=i(t),e instanceof n){if(e.loose===!!t.loose)return e;e=e.value}c("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===r?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(e){const t=this.options.loose?a[l.COMPARATORLOOSE]:a[l.COMPARATOR],s=e.match(t);if(!s)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==s[1]?s[1]:"","="===this.operator&&(this.operator=""),s[2]?this.semver=new d(s[2],this.options.loose):this.semver=r}toString(){return this.value}test(e){if(c("Comparator.test",e,this.options.loose),this.semver===r||e===r)return!0;if("string"==typeof e)try{e=new d(e,this.options)}catch(e){return!1}return o(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new u(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new u(this.value,t).test(e.semver);const s=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),r=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),i=this.semver.version===e.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),l=o(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=o(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return s||r||i&&a||l||c}}e.exports=n;const i=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/parse-options.js"),{re:a,t:l}=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/re.js"),o=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/cmp.js"),c=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/debug.js"),d=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/semver.js"),u=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/range.js")},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/range.js":(e,t,s)=>{class r{constructor(e,t){if(t=i(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof a)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!h(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&g(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=`parseRange:${Object.keys(this.options).join(",")}:${e}`,s=n.get(t);if(s)return s;const r=this.options.loose,i=r?c[d.HYPHENRANGELOOSE]:c[d.HYPHENRANGE];e=e.replace(i,O(this.options.includePrerelease)),l("hyphen replace",e),e=e.replace(c[d.COMPARATORTRIM],u),l("comparator trim",e,c[d.COMPARATORTRIM]),e=(e=(e=e.replace(c[d.TILDETRIM],m)).replace(c[d.CARETTRIM],p)).split(/\s+/).join(" ");const o=r?c[d.COMPARATORLOOSE]:c[d.COMPARATOR],g=e.split(" ").map((e=>v(e,this.options))).join(" ").split(/\s+/).map((e=>S(e,this.options))).filter(this.options.loose?e=>!!e.match(o):()=>!0).map((e=>new a(e,this.options))),f=(g.length,new Map);for(const e of g){if(h(e))return[e];f.set(e.value,e)}f.size>1&&f.has("")&&f.delete("");const b=[...f.values()];return n.set(t,b),b}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Range is required");return this.set.some((s=>f(s,t)&&e.set.some((e=>f(e,t)&&s.every((s=>e.every((e=>s.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new o(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if($(this.set[t],e,this.options))return!0;return!1}}e.exports=r;const n=new(s("./.yarn/cache/lru-cache-npm-6.0.0-b4c8668fe1-f97f499f89.zip/node_modules/lru-cache/index.js"))({max:1e3}),i=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/parse-options.js"),a=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/comparator.js"),l=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/debug.js"),o=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/semver.js"),{re:c,t:d,comparatorTrimReplace:u,tildeTrimReplace:m,caretTrimReplace:p}=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/re.js"),h=e=>"<0.0.0-0"===e.value,g=e=>""===e.value,f=(e,t)=>{let s=!0;const r=e.slice();let n=r.pop();for(;s&&r.length;)s=r.every((e=>n.intersects(e,t))),n=r.pop();return s},v=(e,t)=>(l("comp",e,t),e=_(e,t),l("caret",e),e=y(e,t),l("tildes",e),e=E(e,t),l("xrange",e),e=w(e,t),l("stars",e),e),b=e=>!e||"x"===e.toLowerCase()||"*"===e,y=(e,t)=>e.trim().split(/\s+/).map((e=>j(e,t))).join(" "),j=(e,t)=>{const s=t.loose?c[d.TILDELOOSE]:c[d.TILDE];return e.replace(s,((t,s,r,n,i)=>{let a;return l("tilde",e,t,s,r,n,i),b(s)?a="":b(r)?a=`>=${s}.0.0 <${+s+1}.0.0-0`:b(n)?a=`>=${s}.${r}.0 <${s}.${+r+1}.0-0`:i?(l("replaceTilde pr",i),a=`>=${s}.${r}.${n}-${i} <${s}.${+r+1}.0-0`):a=`>=${s}.${r}.${n} <${s}.${+r+1}.0-0`,l("tilde return",a),a}))},_=(e,t)=>e.trim().split(/\s+/).map((e=>x(e,t))).join(" "),x=(e,t)=>{l("caret",e,t);const s=t.loose?c[d.CARETLOOSE]:c[d.CARET],r=t.includePrerelease?"-0":"";return e.replace(s,((t,s,n,i,a)=>{let o;return l("caret",e,t,s,n,i,a),b(s)?o="":b(n)?o=`>=${s}.0.0${r} <${+s+1}.0.0-0`:b(i)?o="0"===s?`>=${s}.${n}.0${r} <${s}.${+n+1}.0-0`:`>=${s}.${n}.0${r} <${+s+1}.0.0-0`:a?(l("replaceCaret pr",a),o="0"===s?"0"===n?`>=${s}.${n}.${i}-${a} <${s}.${n}.${+i+1}-0`:`>=${s}.${n}.${i}-${a} <${s}.${+n+1}.0-0`:`>=${s}.${n}.${i}-${a} <${+s+1}.0.0-0`):(l("no pr"),o="0"===s?"0"===n?`>=${s}.${n}.${i}${r} <${s}.${n}.${+i+1}-0`:`>=${s}.${n}.${i}${r} <${s}.${+n+1}.0-0`:`>=${s}.${n}.${i} <${+s+1}.0.0-0`),l("caret return",o),o}))},E=(e,t)=>(l("replaceXRanges",e,t),e.split(/\s+/).map((e=>I(e,t))).join(" ")),I=(e,t)=>{e=e.trim();const s=t.loose?c[d.XRANGELOOSE]:c[d.XRANGE];return e.replace(s,((s,r,n,i,a,o)=>{l("xRange",e,s,r,n,i,a,o);const c=b(n),d=c||b(i),u=d||b(a),m=u;return"="===r&&m&&(r=""),o=t.includePrerelease?"-0":"",c?s=">"===r||"<"===r?"<0.0.0-0":"*":r&&m?(d&&(i=0),a=0,">"===r?(r=">=",d?(n=+n+1,i=0,a=0):(i=+i+1,a=0)):"<="===r&&(r="<",d?n=+n+1:i=+i+1),"<"===r&&(o="-0"),s=`${r+n}.${i}.${a}${o}`):d?s=`>=${n}.0.0${o} <${+n+1}.0.0-0`:u&&(s=`>=${n}.${i}.0${o} <${n}.${+i+1}.0-0`),l("xRange return",s),s}))},w=(e,t)=>(l("replaceStars",e,t),e.trim().replace(c[d.STAR],"")),S=(e,t)=>(l("replaceGTE0",e,t),e.trim().replace(c[t.includePrerelease?d.GTE0PRE:d.GTE0],"")),O=e=>(t,s,r,n,i,a,l,o,c,d,u,m,p)=>`${s=b(r)?"":b(n)?`>=${r}.0.0${e?"-0":""}`:b(i)?`>=${r}.${n}.0${e?"-0":""}`:a?`>=${s}`:`>=${s}${e?"-0":""}`} ${o=b(c)?"":b(d)?`<${+c+1}.0.0-0`:b(u)?`<${c}.${+d+1}.0-0`:m?`<=${c}.${d}.${u}-${m}`:e?`<${c}.${d}.${+u+1}-0`:`<=${o}`}`.trim(),$=(e,t,s)=>{for(let s=0;s<e.length;s++)if(!e[s].test(t))return!1;if(t.prerelease.length&&!s.includePrerelease){for(let s=0;s<e.length;s++)if(l(e[s].semver),e[s].semver!==a.ANY&&e[s].semver.prerelease.length>0){const r=e[s].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/semver.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/debug.js"),{MAX_LENGTH:n,MAX_SAFE_INTEGER:i}=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/constants.js"),{re:a,t:l}=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/re.js"),o=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/parse-options.js"),{compareIdentifiers:c}=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/identifiers.js");class d{constructor(e,t){if(t=o(t),e instanceof d){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid Version: ${e}`);if(e.length>n)throw new TypeError(`version is longer than ${n} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const s=e.trim().match(t.loose?a[l.LOOSE]:a[l.FULL]);if(!s)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<i)return t}return e})):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof d)){if("string"==typeof e&&e===this.version)return 0;e=new d(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof d||(e=new d(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof d||(e=new d(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const s=this.prerelease[t],n=e.prerelease[t];if(r("prerelease compare",t,s,n),void 0===s&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===s)return-1;if(s!==n)return c(s,n)}while(++t)}compareBuild(e){e instanceof d||(e=new d(e,this.options));let t=0;do{const s=this.build[t],n=e.build[t];if(r("prerelease compare",t,s,n),void 0===s&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===s)return-1;if(s!==n)return c(s,n)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}e.exports=d},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/clean.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/parse.js");e.exports=(e,t)=>{const s=r(e.trim().replace(/^[=v]+/,""),t);return s?s.version:null}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/cmp.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/eq.js"),n=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/neq.js"),i=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/gt.js"),a=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/gte.js"),l=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/lt.js"),o=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/lte.js");e.exports=(e,t,s,c)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof s&&(s=s.version),e===s;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof s&&(s=s.version),e!==s;case"":case"=":case"==":return r(e,s,c);case"!=":return n(e,s,c);case">":return i(e,s,c);case">=":return a(e,s,c);case"<":return l(e,s,c);case"<=":return o(e,s,c);default:throw new TypeError(`Invalid operator: ${t}`)}}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/coerce.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/semver.js"),n=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/parse.js"),{re:i,t:a}=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/re.js");e.exports=(e,t)=>{if(e instanceof r)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let s=null;if((t=t||{}).rtl){let t;for(;(t=i[a.COERCERTL].exec(e))&&(!s||s.index+s[0].length!==e.length);)s&&t.index+t[0].length===s.index+s[0].length||(s=t),i[a.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;i[a.COERCERTL].lastIndex=-1}else s=e.match(i[a.COERCE]);return null===s?null:n(`${s[2]}.${s[3]||"0"}.${s[4]||"0"}`,t)}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare-build.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/semver.js");e.exports=(e,t,s)=>{const n=new r(e,s),i=new r(t,s);return n.compare(i)||n.compareBuild(i)}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare-loose.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare.js");e.exports=(e,t)=>r(e,t,!0)},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/semver.js");e.exports=(e,t,s)=>new r(e,s).compare(new r(t,s))},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/diff.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/parse.js"),n=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/eq.js");e.exports=(e,t)=>{if(n(e,t))return null;{const s=r(e),n=r(t),i=s.prerelease.length||n.prerelease.length,a=i?"pre":"",l=i?"prerelease":"";for(const e in s)if(("major"===e||"minor"===e||"patch"===e)&&s[e]!==n[e])return a+e;return l}}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/eq.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare.js");e.exports=(e,t,s)=>0===r(e,t,s)},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/gt.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare.js");e.exports=(e,t,s)=>r(e,t,s)>0},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/gte.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare.js");e.exports=(e,t,s)=>r(e,t,s)>=0},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/inc.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/semver.js");e.exports=(e,t,s,n)=>{"string"==typeof s&&(n=s,s=void 0);try{return new r(e,s).inc(t,n).version}catch(e){return null}}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/lt.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare.js");e.exports=(e,t,s)=>r(e,t,s)<0},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/lte.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare.js");e.exports=(e,t,s)=>r(e,t,s)<=0},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/major.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/semver.js");e.exports=(e,t)=>new r(e,t).major},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/minor.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/semver.js");e.exports=(e,t)=>new r(e,t).minor},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/neq.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare.js");e.exports=(e,t,s)=>0!==r(e,t,s)},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/parse.js":(e,t,s)=>{const{MAX_LENGTH:r}=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/constants.js"),{re:n,t:i}=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/re.js"),a=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/semver.js"),l=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/parse-options.js");e.exports=(e,t)=>{if(t=l(t),e instanceof a)return e;if("string"!=typeof e)return null;if(e.length>r)return null;if(!(t.loose?n[i.LOOSE]:n[i.FULL]).test(e))return null;try{return new a(e,t)}catch(e){return null}}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/patch.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/semver.js");e.exports=(e,t)=>new r(e,t).patch},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/prerelease.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/parse.js");e.exports=(e,t)=>{const s=r(e,t);return s&&s.prerelease.length?s.prerelease:null}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/rcompare.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare.js");e.exports=(e,t,s)=>r(t,e,s)},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/rsort.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare-build.js");e.exports=(e,t)=>e.sort(((e,s)=>r(s,e,t)))},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/satisfies.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/range.js");e.exports=(e,t,s)=>{try{t=new r(t,s)}catch(e){return!1}return t.test(e)}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/sort.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare-build.js");e.exports=(e,t)=>e.sort(((e,s)=>r(e,s,t)))},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/valid.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/parse.js");e.exports=(e,t)=>{const s=r(e,t);return s?s.version:null}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/index.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/re.js");e.exports={re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/constants.js").SEMVER_SPEC_VERSION,SemVer:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/semver.js"),compareIdentifiers:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/identifiers.js").compareIdentifiers,rcompareIdentifiers:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/identifiers.js").rcompareIdentifiers,parse:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/parse.js"),valid:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/valid.js"),clean:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/clean.js"),inc:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/inc.js"),diff:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/diff.js"),major:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/major.js"),minor:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/minor.js"),patch:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/patch.js"),prerelease:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/prerelease.js"),compare:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare.js"),rcompare:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/rcompare.js"),compareLoose:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare-loose.js"),compareBuild:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare-build.js"),sort:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/sort.js"),rsort:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/rsort.js"),gt:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/gt.js"),lt:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/lt.js"),eq:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/eq.js"),neq:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/neq.js"),gte:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/gte.js"),lte:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/lte.js"),cmp:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/cmp.js"),coerce:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/coerce.js"),Comparator:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/comparator.js"),Range:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/range.js"),satisfies:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/satisfies.js"),toComparators:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/to-comparators.js"),maxSatisfying:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/max-satisfying.js"),minSatisfying:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/min-satisfying.js"),minVersion:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/min-version.js"),validRange:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/valid.js"),outside:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/outside.js"),gtr:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/gtr.js"),ltr:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/ltr.js"),intersects:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/intersects.js"),simplifyRange:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/simplify.js"),subset:s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/subset.js")}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/constants.js":e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:t,MAX_SAFE_COMPONENT_LENGTH:16}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/debug.js":e=>{const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/identifiers.js":e=>{const t=/^[0-9]+$/,s=(e,s)=>{const r=t.test(e),n=t.test(s);return r&&n&&(e=+e,s=+s),e===s?0:r&&!n?-1:n&&!r?1:e<s?-1:1};e.exports={compareIdentifiers:s,rcompareIdentifiers:(e,t)=>s(t,e)}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/parse-options.js":e=>{const t=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:t.filter((t=>e[t])).reduce(((e,t)=>(e[t]=!0,e)),{}):{}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/re.js":(e,t,s)=>{const{MAX_SAFE_COMPONENT_LENGTH:r}=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/constants.js"),n=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/internal/debug.js"),i=(t=e.exports={}).re=[],a=t.src=[],l=t.t={};let o=0;const c=(e,t,s)=>{const r=o++;n(r,t),l[e]=r,a[r]=t,i[r]=new RegExp(t,s?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION",`(${a[l.NUMERICIDENTIFIER]})\\.(${a[l.NUMERICIDENTIFIER]})\\.(${a[l.NUMERICIDENTIFIER]})`),c("MAINVERSIONLOOSE",`(${a[l.NUMERICIDENTIFIERLOOSE]})\\.(${a[l.NUMERICIDENTIFIERLOOSE]})\\.(${a[l.NUMERICIDENTIFIERLOOSE]})`),c("PRERELEASEIDENTIFIER",`(?:${a[l.NUMERICIDENTIFIER]}|${a[l.NONNUMERICIDENTIFIER]})`),c("PRERELEASEIDENTIFIERLOOSE",`(?:${a[l.NUMERICIDENTIFIERLOOSE]}|${a[l.NONNUMERICIDENTIFIER]})`),c("PRERELEASE",`(?:-(${a[l.PRERELEASEIDENTIFIER]}(?:\\.${a[l.PRERELEASEIDENTIFIER]})*))`),c("PRERELEASELOOSE",`(?:-?(${a[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${a[l.PRERELEASEIDENTIFIERLOOSE]})*))`),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD",`(?:\\+(${a[l.BUILDIDENTIFIER]}(?:\\.${a[l.BUILDIDENTIFIER]})*))`),c("FULLPLAIN",`v?${a[l.MAINVERSION]}${a[l.PRERELEASE]}?${a[l.BUILD]}?`),c("FULL",`^${a[l.FULLPLAIN]}$`),c("LOOSEPLAIN",`[v=\\s]*${a[l.MAINVERSIONLOOSE]}${a[l.PRERELEASELOOSE]}?${a[l.BUILD]}?`),c("LOOSE",`^${a[l.LOOSEPLAIN]}$`),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE",`${a[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),c("XRANGEIDENTIFIER",`${a[l.NUMERICIDENTIFIER]}|x|X|\\*`),c("XRANGEPLAIN",`[v=\\s]*(${a[l.XRANGEIDENTIFIER]})(?:\\.(${a[l.XRANGEIDENTIFIER]})(?:\\.(${a[l.XRANGEIDENTIFIER]})(?:${a[l.PRERELEASE]})?${a[l.BUILD]}?)?)?`),c("XRANGEPLAINLOOSE",`[v=\\s]*(${a[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[l.XRANGEIDENTIFIERLOOSE]})(?:${a[l.PRERELEASELOOSE]})?${a[l.BUILD]}?)?)?`),c("XRANGE",`^${a[l.GTLT]}\\s*${a[l.XRANGEPLAIN]}$`),c("XRANGELOOSE",`^${a[l.GTLT]}\\s*${a[l.XRANGEPLAINLOOSE]}$`),c("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),c("COERCERTL",a[l.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM",`(\\s*)${a[l.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",c("TILDE",`^${a[l.LONETILDE]}${a[l.XRANGEPLAIN]}$`),c("TILDELOOSE",`^${a[l.LONETILDE]}${a[l.XRANGEPLAINLOOSE]}$`),c("LONECARET","(?:\\^)"),c("CARETTRIM",`(\\s*)${a[l.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",c("CARET",`^${a[l.LONECARET]}${a[l.XRANGEPLAIN]}$`),c("CARETLOOSE",`^${a[l.LONECARET]}${a[l.XRANGEPLAINLOOSE]}$`),c("COMPARATORLOOSE",`^${a[l.GTLT]}\\s*(${a[l.LOOSEPLAIN]})$|^$`),c("COMPARATOR",`^${a[l.GTLT]}\\s*(${a[l.FULLPLAIN]})$|^$`),c("COMPARATORTRIM",`(\\s*)${a[l.GTLT]}\\s*(${a[l.LOOSEPLAIN]}|${a[l.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE",`^\\s*(${a[l.XRANGEPLAIN]})\\s+-\\s+(${a[l.XRANGEPLAIN]})\\s*$`),c("HYPHENRANGELOOSE",`^\\s*(${a[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${a[l.XRANGEPLAINLOOSE]})\\s*$`),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0.0.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/gtr.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/outside.js");e.exports=(e,t,s)=>r(e,t,">",s)},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/intersects.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/range.js");e.exports=(e,t,s)=>(e=new r(e,s),t=new r(t,s),e.intersects(t))},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/ltr.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/outside.js");e.exports=(e,t,s)=>r(e,t,"<",s)},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/max-satisfying.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/semver.js"),n=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/range.js");e.exports=(e,t,s)=>{let i=null,a=null,l=null;try{l=new n(t,s)}catch(e){return null}return e.forEach((e=>{l.test(e)&&(i&&-1!==a.compare(e)||(i=e,a=new r(i,s)))})),i}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/min-satisfying.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/semver.js"),n=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/range.js");e.exports=(e,t,s)=>{let i=null,a=null,l=null;try{l=new n(t,s)}catch(e){return null}return e.forEach((e=>{l.test(e)&&(i&&1!==a.compare(e)||(i=e,a=new r(i,s)))})),i}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/min-version.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/semver.js"),n=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/range.js"),i=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/gt.js");e.exports=(e,t)=>{e=new n(e,t);let s=new r("0.0.0");if(e.test(s))return s;if(s=new r("0.0.0-0"),e.test(s))return s;s=null;for(let t=0;t<e.set.length;++t){const n=e.set[t];let a=null;n.forEach((e=>{const t=new r(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":a&&!i(t,a)||(a=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!a||s&&!i(s,a)||(s=a)}return s&&e.test(s)?s:null}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/outside.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/semver.js"),n=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/comparator.js"),{ANY:i}=n,a=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/range.js"),l=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/satisfies.js"),o=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/gt.js"),c=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/lt.js"),d=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/lte.js"),u=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/gte.js");e.exports=(e,t,s,m)=>{let p,h,g,f,v;switch(e=new r(e,m),t=new a(t,m),s){case">":p=o,h=d,g=c,f=">",v=">=";break;case"<":p=c,h=u,g=o,f="<",v="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(l(e,t,m))return!1;for(let s=0;s<t.set.length;++s){const r=t.set[s];let a=null,l=null;if(r.forEach((e=>{e.semver===i&&(e=new n(">=0.0.0")),a=a||e,l=l||e,p(e.semver,a.semver,m)?a=e:g(e.semver,l.semver,m)&&(l=e)})),a.operator===f||a.operator===v)return!1;if((!l.operator||l.operator===f)&&h(e,l.semver))return!1;if(l.operator===v&&g(e,l.semver))return!1}return!0}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/simplify.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/satisfies.js"),n=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare.js");e.exports=(e,t,s)=>{const i=[];let a=null,l=null;const o=e.sort(((e,t)=>n(e,t,s)));for(const e of o){r(e,t,s)?(l=e,a||(a=e)):(l&&i.push([a,l]),l=null,a=null)}a&&i.push([a,null]);const c=[];for(const[e,t]of i)e===t?c.push(e):t||e!==o[0]?t?e===o[0]?c.push(`<=${t}`):c.push(`${e} - ${t}`):c.push(`>=${e}`):c.push("*");const d=c.join(" || "),u="string"==typeof t.raw?t.raw:String(t);return d.length<u.length?d:t}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/subset.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/range.js"),n=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/comparator.js"),{ANY:i}=n,a=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/satisfies.js"),l=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/functions/compare.js"),o=(e,t,s)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===i){if(1===t.length&&t[0].semver===i)return!0;e=s.includePrerelease?[new n(">=0.0.0-0")]:[new n(">=0.0.0")]}if(1===t.length&&t[0].semver===i){if(s.includePrerelease)return!0;t=[new n(">=0.0.0")]}const r=new Set;let o,u,m,p,h,g,f;for(const t of e)">"===t.operator||">="===t.operator?o=c(o,t,s):"<"===t.operator||"<="===t.operator?u=d(u,t,s):r.add(t.semver);if(r.size>1)return null;if(o&&u){if(m=l(o.semver,u.semver,s),m>0)return null;if(0===m&&(">="!==o.operator||"<="!==u.operator))return null}for(const e of r){if(o&&!a(e,String(o),s))return null;if(u&&!a(e,String(u),s))return null;for(const r of t)if(!a(e,String(r),s))return!1;return!0}let v=!(!u||s.includePrerelease||!u.semver.prerelease.length)&&u.semver,b=!(!o||s.includePrerelease||!o.semver.prerelease.length)&&o.semver;v&&1===v.prerelease.length&&"<"===u.operator&&0===v.prerelease[0]&&(v=!1);for(const e of t){if(f=f||">"===e.operator||">="===e.operator,g=g||"<"===e.operator||"<="===e.operator,o)if(b&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===b.major&&e.semver.minor===b.minor&&e.semver.patch===b.patch&&(b=!1),">"===e.operator||">="===e.operator){if(p=c(o,e,s),p===e&&p!==o)return!1}else if(">="===o.operator&&!a(o.semver,String(e),s))return!1;if(u)if(v&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===v.major&&e.semver.minor===v.minor&&e.semver.patch===v.patch&&(v=!1),"<"===e.operator||"<="===e.operator){if(h=d(u,e,s),h===e&&h!==u)return!1}else if("<="===u.operator&&!a(u.semver,String(e),s))return!1;if(!e.operator&&(u||o)&&0!==m)return!1}return!(o&&g&&!u&&0!==m)&&(!(u&&f&&!o&&0!==m)&&(!b&&!v))},c=(e,t,s)=>{if(!e)return t;const r=l(e.semver,t.semver,s);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},d=(e,t,s)=>{if(!e)return t;const r=l(e.semver,t.semver,s);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,s={})=>{if(e===t)return!0;e=new r(e,s),t=new r(t,s);let n=!1;e:for(const r of e.set){for(const e of t.set){const t=o(r,e,s);if(n=n||null!==t,t)continue e}if(n)return!1}return!0}},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/to-comparators.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/range.js");e.exports=(e,t)=>new r(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},"./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/ranges/valid.js":(e,t,s)=>{const r=s("./.yarn/cache/semver-npm-7.3.5-618cf5db6a-5eafe6102b.zip/node_modules/semver/classes/range.js");e.exports=(e,t)=>{try{return new r(e,t).range||"*"}catch(e){return null}}},"./.yarn/cache/yallist-npm-4.0.0-b493d9e907-343617202a.zip/node_modules/yallist/iterator.js":e=>{"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},"./.yarn/cache/yallist-npm-4.0.0-b493d9e907-343617202a.zip/node_modules/yallist/yallist.js":(e,t,s)=>{"use strict";function r(e){var t=this;if(t instanceof r||(t=new r),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var s=0,n=arguments.length;s<n;s++)t.push(arguments[s]);return t}function n(e,t,s){var r=t===e.head?new l(s,null,t,e):new l(s,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function i(e,t){e.tail=new l(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function a(e,t){e.head=new l(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function l(e,t,s,r){if(!(this instanceof l))return new l(e,t,s,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,s?(s.prev=this,this.next=s):this.next=null}e.exports=r,r.Node=l,r.create=r,r.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,s=e.prev;return t&&(t.prev=s),s&&(s.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=s),e.list.length--,e.next=null,e.prev=null,e.list=null,t},r.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},r.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},r.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)i(this,arguments[e]);return this.length},r.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)a(this,arguments[e]);return this.length},r.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},r.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},r.prototype.forEach=function(e,t){t=t||this;for(var s=this.head,r=0;null!==s;r++)e.call(t,s.value,r,this),s=s.next},r.prototype.forEachReverse=function(e,t){t=t||this;for(var s=this.tail,r=this.length-1;null!==s;r--)e.call(t,s.value,r,this),s=s.prev},r.prototype.get=function(e){for(var t=0,s=this.head;null!==s&&t<e;t++)s=s.next;if(t===e&&null!==s)return s.value},r.prototype.getReverse=function(e){for(var t=0,s=this.tail;null!==s&&t<e;t++)s=s.prev;if(t===e&&null!==s)return s.value},r.prototype.map=function(e,t){t=t||this;for(var s=new r,n=this.head;null!==n;)s.push(e.call(t,n.value,this)),n=n.next;return s},r.prototype.mapReverse=function(e,t){t=t||this;for(var s=new r,n=this.tail;null!==n;)s.push(e.call(t,n.value,this)),n=n.prev;return s},r.prototype.reduce=function(e,t){var s,r=this.head;if(arguments.length>1)s=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,s=this.head.value}for(var n=0;null!==r;n++)s=e(s,r.value,n),r=r.next;return s},r.prototype.reduceReverse=function(e,t){var s,r=this.tail;if(arguments.length>1)s=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,s=this.tail.value}for(var n=this.length-1;null!==r;n--)s=e(s,r.value,n),r=r.prev;return s},r.prototype.toArray=function(){for(var e=new Array(this.length),t=0,s=this.head;null!==s;t++)e[t]=s.value,s=s.next;return e},r.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,s=this.tail;null!==s;t++)e[t]=s.value,s=s.prev;return e},r.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var s=new r;if(t<e||t<0)return s;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=0,i=this.head;null!==i&&n<e;n++)i=i.next;for(;null!==i&&n<t;n++,i=i.next)s.push(i.value);return s},r.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var s=new r;if(t<e||t<0)return s;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=this.length,i=this.tail;null!==i&&n>t;n--)i=i.prev;for(;null!==i&&n>e;n--,i=i.prev)s.push(i.value);return s},r.prototype.splice=function(e,t,...s){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,i=this.head;null!==i&&r<e;r++)i=i.next;var a=[];for(r=0;i&&r<t;r++)a.push(i.value),i=this.removeNode(i);null===i&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(r=0;r<s.length;r++)i=n(this,i,s[r]);return a},r.prototype.reverse=function(){for(var e=this.head,t=this.tail,s=e;null!==s;s=s.prev){var r=s.prev;s.prev=s.next,s.next=r}return this.head=t,this.tail=e,this};try{s("./.yarn/cache/yallist-npm-4.0.0-b493d9e907-343617202a.zip/node_modules/yallist/iterator.js")(r)}catch(e){}}}]);
//# sourceMappingURL=elasticsearchPlugin.e65e3aa10981aa98e7a1.js.map