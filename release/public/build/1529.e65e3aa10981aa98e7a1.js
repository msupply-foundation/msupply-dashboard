"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[1529],{"./public/app/plugins/datasource/prometheus/add_label_to_query.ts":(e,t,a)=>{a.d(t,{F2:()=>l,ZP:()=>p});var n=a("./.yarn/cache/lodash-npm-4.17.21-6382451519-eb835a2e51.zip/node_modules/lodash/lodash.js"),s=a("./public/app/plugins/datasource/prometheus/promql.ts");const r=[...s.YO,...s.fP,...s.Os],i=/([A-Za-z:][\w:]*)\b(?![\]{=!",])/g,o=/(\$)?{([^{]*)}/g;function l(e,t,a,n,l){if(!t||!a)throw new Error("Need label to add to query.");const c=a===1/0?"+Inf":a.toString();let p;e=e.replace(i,((t,a,n)=>{const i=function(e,t,a,n,i){const o=function(e,t,a,n){const s=e.slice(t).indexOf(a),r=e.slice(t).indexOf(n);return r>-1&&(-1===s||s>r)}(e,a,"{","}"),l=n&&s.fP.indexOf(n)>-1,c=t.endsWith(":"),u='"'===e[a-1],p="$"===e[a-1],d=["s","m","h","d","w"].includes(t)&&Boolean(Number(e[a-1]));if(!(i||o||c||l||u||p||d||-1!==r.indexOf(t)))return!0;return!1}(e,a,n,p,l);return p=a,i?`${a}{}`:a}));let d=o.exec(e);const h=[];let m=0,g="";for(;d;){const a=e.slice(m,d.index);if(m=d.index+d[2].length+2,g=e.slice(d.index+d[0].length),d[1])h.push(a),h.push(d[0]);else{const e=u(d[2],t,c,n);h.push(a,e)}d=o.exec(e)}return h.push(g),h.join("")}const c=/(\w+)\s*(=|!=|=~|!~)\s*("[^"]*")/g;function u(e,t,a,s){const r=[];if(e){let t=c.exec(e);for(;t;)r.push({key:t[1],operator:t[2],value:t[3]}),t=c.exec(e)}const i=s||"=";r.push({key:t,operator:i,value:`"${a}"`});return`{${(0,n.chain)(r).uniqWith(n.isEqual).compact().sortBy("key").map((e=>{let{key:t,operator:a,value:n}=e;return`${t}${a}${n}`})).value().join(",")}}`}const p=l},"./public/app/plugins/datasource/prometheus/language_provider.ts":(e,t,a)=>{a.d(t,{ZK:()=>m,ZP:()=>y});var n=a("./.yarn/cache/lodash-npm-4.17.21-6382451519-eb835a2e51.zip/node_modules/lodash/lodash.js"),s=a("./.yarn/cache/lru-cache-npm-6.0.0-b4c8668fe1-f97f499f89.zip/node_modules/lru-cache/index.js"),r=a.n(s),i=a("./.yarn/cache/prismjs-npm-1.26.0-15be1ab06b-6de058930c.zip/node_modules/prismjs/prism.js"),o=a.n(i),l=a("./packages/grafana-data/src/index.ts"),c=a("./packages/grafana-ui/src/index.ts"),u=a("./public/app/plugins/datasource/prometheus/language_utils.ts"),p=a("./public/app/plugins/datasource/prometheus/promql.ts");function d(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const h=["job","instance"],m=1e4,g=e=>({label:e}),f=e=>(e.kind="function",e);const b=/(="|!="|=~"|!~"|\{|\[|\(|\+|-|\/|\*|%|\^|\band\b|\bor\b|\bunless\b|==|>=|!=|<=|>|<|=|~|,)/;class y extends l.LanguageProvider{constructor(e,t){var a;super(),a=this,d(this,"histogramMetrics",void 0),d(this,"timeRange",void 0),d(this,"metrics",void 0),d(this,"metricsMetadata",void 0),d(this,"datasource",void 0),d(this,"labelKeys",[]),d(this,"labelsCache",new(r())(10)),d(this,"request",(async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{return(await a.datasource.metadataRequest(e,n)).data.data}catch(e){console.error(e)}return t})),d(this,"start",(async()=>(this.datasource.lookupsDisabled||(await this.fetchLabels(),this.metrics=await this.fetchLabelValues("__name__")||[],this.metricsMetadata=(0,u.I4)(await this.request("/api/v1/metadata",{})),this.histogramMetrics=(0,u.NO)(this.metrics).sort()),[]))),d(this,"provideCompletionItems",(async function(e){let{prefix:t,text:n,value:s,labelKey:r,wrapperClasses:i}=e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const l={suggestions:[]};if(!s)return l;const c=0===s.document.text.length,u=s.document.getTextsAtRange(s.selection),p=1===u.size?u.first().getText():null,d=p?p[s.selection.anchor.offset]:null,h=i.length>3,m=t&&!h,g=!d||")"===d,f=t&&!n.match(/^[\]})\s]+$/)&&g,b=/[+\-*/^%]/,y=n.match(b);return i.includes("context-range")?a.getRangeCompletionItems():i.includes("context-labels")?a.getLabelCompletionItems({prefix:t,text:n,value:s,labelKey:r,wrapperClasses:i}):i.includes("context-aggregation")?a.getAggregationCompletionItems(s):c?a.getEmptyCompletionItems(o):m&&g&&!y?a.getBeginningCompletionItems(o):m&&f?a.getTermCompletionItems():l})),d(this,"getBeginningCompletionItems",(e=>({suggestions:[...this.getEmptyCompletionItems(e).suggestions,...this.getTermCompletionItems().suggestions]}))),d(this,"getEmptyCompletionItems",(e=>{const{history:t}=e,a=[];if(t&&t.length){const e=(0,n.chain)(t).map((e=>e.query.expr)).filter().uniq().take(5).map(g).map((e=>function(e,t){const a=Date.now()-864e5,n=t.filter((t=>t.ts>a&&t.query===e.label)),s=n.length,r=n[0];let i=`Queried ${s} times in the last 24h.`;r&&(i=`${i} Last queried ${(0,l.dateTime)(r.ts).fromNow()}.`);return Object.assign({},e,{documentation:i})}(e,t))).value();a.push({searchFunctionType:c.SearchFunctionType.Prefix,skipSort:!0,label:"History",items:e})}return{suggestions:a}})),d(this,"getTermCompletionItems",(()=>{const{metrics:e,metricsMetadata:t}=this,a=[];return a.push({searchFunctionType:c.SearchFunctionType.Prefix,label:"Functions",items:p.r8.map(f)}),e&&e.length&&a.push({label:"Metrics",items:e.map((e=>function(e,t){const a={label:e};if(t&&t[e]){const{type:n,help:s}=t[e];a.documentation=`${n.toUpperCase()}: ${s}`}return a}(e,t))),searchFunctionType:c.SearchFunctionType.Fuzzy}),{suggestions:a}})),d(this,"getAggregationCompletionItems",(async e=>{const t=[];let a;const n=e.document.getBlocks().reduce(((t,n)=>{if(void 0===t)return"";if(!n)return t;const s=null==n?void 0:n.getText();return e.anchorBlock.key===n.key&&(a=e.selection.anchor.offset+t.length),t+s}),""),s=n.lastIndexOf("(",a);let r=n.lastIndexOf("(",s-1),i=n.indexOf(")",r);if(-1===r){const e=n.indexOf(")",a);i=n.indexOf(")",e+1),r=n.lastIndexOf("(",i)}const o={suggestions:t,context:"context-aggregation"};if(-1===r)return o;const l=n.slice(r+1,i).replace(/\[[^\]]+\]$/,""),p=(0,u.rV)(l,l.length-2).selector,d=await this.getSeries(p),h=Object.keys(d);if(h.length>0){const e=(0,u.ZO)(h);t.push({label:`Labels${e}`,items:h.map(g),searchFunctionType:c.SearchFunctionType.Fuzzy})}return o})),d(this,"getLabelCompletionItems",(async e=>{let{text:t,wrapperClasses:a,labelKey:s,value:r}=e;if(!r)return{suggestions:[]};const i=[],o=r.anchorBlock.getText(),l=r.selection.anchor.offset,p=o.substr(l),d=o.substr(0,l),m=t.match(/^(=|=~|!=|!~)/),f=p.match(/^"?[,}]|$/),b=d.match(/(=|=~|!=|!~)$/)&&p.match(/^"/);if(!(m&&f)&&!(f&&!m)||b)return{suggestions:i};let y,v;try{v=(0,u.rV)(o,l),y=v.selector}catch{y="{}"}const x=y.includes("__name__="),j=v?v.labelKeys:[];let w,_={};if(y&&(_=await this.getSeries(y,!x)),0===Object.keys(_).length)return console.warn(`Server did not return any values for selector = ${y}`),{suggestions:i};if(t&&m||a.includes("attr-value")){if(s&&_[s]){w="context-label-values";const e=(0,u.ZO)(_[s]);i.push({label:`Label values for "${s}"${e}`,items:_[s].map(g),searchFunctionType:c.SearchFunctionType.Fuzzy})}}else{const e=_?Object.keys(_):x?null:h;if(e){const t=(0,n.difference)(e,j);if(t.length){w="context-labels";const e=t.map((e=>({label:e}))),a={label:`Labels${(0,u.ZO)(e)}`,items:e,searchFunctionType:c.SearchFunctionType.Fuzzy};i.push(a)}}}return{context:w,suggestions:i}})),d(this,"fetchLabelValues",(async e=>{const t=this.datasource.getTimeRangeParams(),a=`/api/v1/label/${e}/values`;return await this.request(a,[],t)})),d(this,"fetchSeriesLabels",(async(e,t)=>{const a=this.datasource.getTimeRangeParams(),n=Object.assign({},a,{"match[]":e}),s=`/api/v1/series?${new URLSearchParams({"match[]":e,start:(0,u.s4)(parseInt(a.start,10)).toString(),end:(0,u.s4)(parseInt(a.end,10)).toString(),withName:t?"true":"false"}).toString()}`;let r=this.labelsCache.get(s);if(!r){const e=await this.request("/api/v1/series",[],n),{values:a}=(0,u.DY)(e,t);r=a,this.labelsCache.set(s,r)}return r})),d(this,"fetchSeries",(async e=>{const t=this.datasource.getTimeRangeParams(),a=Object.assign({},t,{"match[]":e});return await this.request("/api/v1/series",{},a)})),d(this,"fetchDefaultSeries",(0,n.once)((async()=>{const e=await Promise.all(h.map((e=>this.fetchLabelValues(e))));return h.reduce(((t,a,n)=>Object.assign({},t,{[a]:e[n]})),{})}))),this.datasource=e,this.histogramMetrics=[],this.timeRange={start:0,end:0},this.metrics=[],Object.assign(this,t)}cleanText(e){return e.split(b).pop().trimLeft().replace(/"$/,"").replace(/^"/,"")}get syntax(){return p.ZP}getLabelKeys(){return this.labelKeys}getRangeCompletionItems(){return{context:"context-range",suggestions:[{label:"Range vector",items:[...p.Ty]}]}}importFromAbstractQuery(e){return(0,u.e5)(e)}exportToAbstractQuery(e){const t=e.expr;if(!t||0===t.length)return{refId:e.refId,labelMatchers:[]};const a=o().tokenize(t,p.ZP),n=(0,u.UO)(a),s=function(e,t){let a="";for(let e in t)if("string"==typeof t[e]){a=t[e];break}return a}(0,a);return s&&s.length>0&&n.push({name:"__name__",operator:l.AbstractLabelOperator.Equal,value:s}),{refId:e.refId,labelMatchers:n}}async getSeries(e,t){if(this.datasource.lookupsDisabled)return{};try{return"{}"===e?await this.fetchDefaultSeries():await this.fetchSeriesLabels(e,t)}catch(e){return console.error(e),{}}}async getLabelValues(e){return await this.fetchLabelValues(e)}async fetchLabels(){const e=this.datasource.getTimeRangeParams();this.labelFetchTs=Date.now().valueOf();const t=await this.request("/api/v1/labels",[],e);return Array.isArray(t)&&(this.labelKeys=t.slice().sort()),[]}}},"./public/app/plugins/datasource/prometheus/language_utils.ts":(e,t,a)=>{a.d(t,{NO:()=>u,DY:()=>p,rV:()=>m,ll:()=>g,I4:()=>f,o8:()=>b,s4:()=>y,ZO:()=>x,U9:()=>w,tU:()=>_,PL:()=>S,e5:()=>C,UO:()=>$});var n=a("./public/app/plugins/datasource/prometheus/add_label_to_query.ts"),s=a("./public/app/plugins/datasource/prometheus/language_provider.ts"),r=a("./packages/grafana-data/src/index.ts"),i=a("./.yarn/cache/prismjs-npm-1.26.0-15be1ab06b-6de058930c.zip/node_modules/prismjs/prism.js"),o=a("./.yarn/cache/lodash-npm-4.17.21-6382451519-eb835a2e51.zip/node_modules/lodash/lodash.js");const l=["__name__"];function c(e,t){if(null==e)return{};var a,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(s[a]=e[a]);return s}const u=e=>{const t=new Set,a=new RegExp("_bucket($|:)");for(let n=0;n<e.length;n++){const s=e[n];a.test(s)&&t.add(s)}return[...t]};function p(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const a={};e.forEach((e=>{const{__name__:n}=e,s=c(e,l);t&&(a.__name__=a.__name__||new Set,a.__name__.has(n)||a.__name__.add(n)),Object.keys(s).forEach((e=>{a[e]||(a[e]=new Set),a[e].has(s[e])||a[e].add(s[e])}))}));const n={};return v(Object.keys(a)).forEach((e=>{n[e]=v(Array.from(a[e]))})),{values:n,keys:Object.keys(n)}}const d=/\{[^}]*?(\}|$)/,h=/\b(\w+)(!?=~?)("[^"\n]*?")/g;function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!e.match(d)){if(e.match(/^[A-Za-z:][\w:]*$/))return{selector:`{__name__="${e}"}`,labelKeys:["__name__"]};throw new Error("Query must contain a selector: "+e)}const a=e.slice(0,t),n=a.lastIndexOf("{"),s=a.lastIndexOf("}");if(-1===n)throw new Error("Not inside selector, missing open brace: "+a);if(s>-1&&s>n)throw new Error("Not inside selector, previous selector already closed: "+a);const r=e.slice(t),i=r.indexOf("}"),o=i+t,l=r.indexOf("{"),c=l+t;if(-1===o)throw new Error("Not inside selector, missing closing brace in suffix: "+r);if(l>-1&&c<o)throw new Error("Not inside selector, next selector opens before this one closed: "+r);const u=e.slice(n,o),p={};u.replace(h,((a,n,s,r)=>{const i=e.indexOf(a),o=i+n.length+s.length+1,l=i+n.length+s.length+r.length-1;return(t<o||t>l)&&(p[n]={value:r,operator:s}),""}));const m=e.slice(0,n),g=m.match(/[A-Za-z:][\w:]*$/);g&&(p.__name__={value:`"${g[0]}"`,operator:"="});const f=Object.keys(p).sort(),b=f.map((e=>`${e}${p[e].operator}${p[e].value}`)).join(","),y=["{",b,"}"].join("");return{labelKeys:f,selector:y}}function g(e,t){const a=Object.keys(t),s=new RegExp(`(\\s|^)(${a.join("|")})(\\s|$|\\(|\\[|\\{)`,"ig"),r=e.replace(s,((e,a,n,s)=>`${a}${t[n]}${s}`)).split(/(\+|\-|\*|\/|\%|\^)/),i=/(\)\{|\}\{|\]\{)/,o=r.map((e=>function(e,t){var a;const s=e.match(t);if(!s)return e;const r=null!==(a=s.index)&&void 0!==a?a:0,i=e.substr(0,r+1),o=e.substr(r+1),l=[];o.replace(h,((e,t,a,n)=>(l.push({key:t,operator:a,value:n}),"")));let c=i;return l.filter(Boolean).forEach((e=>{const t=e.value.substr(1,e.value.length-2);c=(0,n.F2)(c,e.key,t,e.operator)})),c}(e,i)));return o.join("")}function f(e){if(!e)return e;const t={},a={};for(const n in e){const s=e[n][0];t[n]=s,"histogram"===s.type&&(a[`${n}_bucket`]={type:"counter",help:`Cumulative counters for the observation buckets (${s.help})`},a[`${n}_count`]={type:"counter",help:`Count of events that have been observed for the histogram metric (${s.help})`},a[`${n}_sum`]={type:"counter",help:`Total sum of all observed values for the histogram metric (${s.help})`}),"summary"===s.type&&(a[`${n}_count`]={type:"counter",help:`Count of events that have been observed for the base metric (${s.help})`},a[`${n}_sum`]={type:"counter",help:`Total sum of all observed values for the base metric (${s.help})`})}const n={ALERTS:{type:"counter",help:"Time series showing pending and firing alerts. The sample value is set to 1 as long as the alert is in the indicated active (pending or firing) state."}};return Object.assign({},t,a,n)}function b(e){return y(e/1e3)}function y(e){return Math.floor(e/60)}function v(e){return e.slice(0,s.ZK)}function x(e){return e&&e.length>=s.ZK?`, limited to the first ${s.ZK} received items`:""}const j=/[*+?()|\\.\[\]{}^$]/g;function w(e){return e.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function _(e){return w(e.replace(j,"\\$&"))}const O={"=":r.AbstractLabelOperator.Equal,"!=":r.AbstractLabelOperator.NotEqual,"=~":r.AbstractLabelOperator.EqualRegEx,"!~":r.AbstractLabelOperator.NotEqualRegEx},k=(0,o.invert)(O);function S(e){const t=e.labelMatchers.map((e=>{const t=k[e.operator];return t?`${e.name}${t}"${e.value}"`:""})).filter((e=>""!==e)).join(", ");return t?`{${t}}`:""}function C(e){return{refId:e.refId,expr:S(e),range:!0}}function $(e){const t=[];for(let a in e)if(e[a]instanceof i.Token){let n=e[a];if("context-labels"===n.type){let e="",a="",s="",r=n.content;for(let n in r)if("string"==typeof r[n]){let e;e=r[n],"="!==e&&"!="!==e&&"=~"!==e&&"!~"!==e||(s=e)}else if(r[n]instanceof i.Token)switch(r[n].type){case"label-key":e=r[n].content;break;case"label-value":a=r[n].content,a=a.substring(1,a.length-1);const i=O[s];i&&t.push({name:e,operator:i,value:a})}}}return t}},"./public/app/plugins/datasource/prometheus/querybuilder/shared/LabelFilters.tsx":(e,t,a)=>{a.d(t,{P:()=>p});var n=a("./.yarn/__virtual__/@grafana-experimental-virtual-044b968173/0/cache/@grafana-experimental-npm-0.0.2-canary.11-3ed391aeb7-6e8fa4bbdf.zip/node_modules/@grafana/experimental/index.js"),s=a("./.yarn/cache/lodash-npm-4.17.21-6382451519-eb835a2e51.zip/node_modules/lodash/lodash.js"),r=a("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),i=a("./packages/grafana-ui/src/index.ts"),o=a("./packages/grafana-data/src/index.ts"),l=a("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");function c(e){var t;let{item:a,defaultOp:s,onChange:c,onDelete:p,onGetLabelNames:d,onGetLabelValues:h}=e;const[m,g]=(0,r.useState)({}),f=e=>e&&e.value?e.value.indexOf("|")>0?e.value.split("|").map((e=>({label:e,value:e}))):(0,o.toOption)(e.value):null;return(0,l.jsx)("div",{"data-testid":"prometheus-dimensions-filter-item",children:(0,l.jsxs)(n.InputGroup,{children:[(0,l.jsx)(i.Select,{inputId:"prometheus-dimensions-filter-item-key",width:"auto",value:a.label?(0,o.toOption)(a.label):null,allowCustomValue:!0,onOpenMenu:async()=>{g({isLoadingLabelNames:!0});const e=(await d(a)).map((e=>({label:e,value:e})));g({labelNames:e,isLoadingLabelNames:void 0})},isLoading:m.isLoadingLabelNames,options:m.labelNames,onChange:e=>{var t;e.label&&c(Object.assign({},a,{op:null!==(t=a.op)&&void 0!==t?t:s,label:e.label}))}}),(0,l.jsx)(i.Select,{value:(0,o.toOption)(null!==(t=a.op)&&void 0!==t?t:s),options:u,width:"auto",onChange:e=>{null!=e.value&&c(Object.assign({},a,{op:e.value}))}}),(0,l.jsx)(i.Select,{inputId:"prometheus-dimensions-filter-item-value",width:"auto",value:f(a),allowCustomValue:!0,onOpenMenu:async()=>{g({isLoadingLabelValues:!0});const e=await h(a);g(Object.assign({},m,{labelValues:e.map((e=>({label:e,value:e}))),isLoadingLabelValues:void 0}))},isMulti:a.op===u[0].label,isLoading:m.isLoadingLabelValues,options:!m.labelValues&&a&&a.value&&a.value.indexOf("|")>0?f(a):m.labelValues,onChange:e=>{if(e.value){var t;c(Object.assign({},a,{value:e.value,op:null!==(t=a.op)&&void 0!==t?t:s}))}else{var n;const t=e.map((e=>e.label)).join("|");c(Object.assign({},a,{value:t,op:null!==(n=a.op)&&void 0!==n?n:s}))}}}),(0,l.jsx)(n.AccessoryButton,{"aria-label":"remove",icon:"times",variant:"secondary",onClick:p})]})})}const u=[{label:"=~",value:"=~"},{label:"=",value:"="},{label:"!=",value:"!="}];function p(e){let{labelsFilters:t,onChange:a,onGetLabelNames:i,onGetLabelValues:o}=e;const[u,p]=(0,r.useState)(0===t.length?[{op:"="}]:t);return(0,l.jsx)(n.EditorFieldGroup,{children:(0,l.jsx)(n.EditorField,{label:"Labels",children:(0,l.jsx)(n.EditorList,{items:u,onChange:e=>{p(e);const n=e.filter((e=>null!=e.label&&null!=e.value));(0,s.isEqual)(n,t)||a(n)},renderItem:(e,t,a)=>(0,l.jsx)(c,{item:e,defaultOp:"=",onChange:t,onDelete:a,onGetLabelNames:i,onGetLabelValues:o})})})})}},"./public/app/plugins/datasource/prometheus/querybuilder/shared/LokiAndPromQueryModellerBase.ts":(e,t,a)=>{a.d(t,{x:()=>r});var n=a("./packages/grafana-data/src/index.ts");function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class r{constructor(e){s(this,"operationsRegisty",void 0),s(this,"categories",[]),this.operationsRegisty=new n.Registry(e)}setOperationCategories(e){this.categories=e}getOperationsForCategory(e){return this.operationsRegisty.list().filter((t=>t.category===e&&!t.hideFromList))}getAlternativeOperations(e){return this.operationsRegisty.list().filter((t=>t.alternativesKey===e))}getCategories(){return this.categories}getOperationDef(e){return this.operationsRegisty.get(e)}renderOperations(e,t){for(const a of t){const t=this.operationsRegisty.get(a.id);e=t.renderer(a,t,e)}return e}renderBinaryQueries(e,t){if(t)for(const a of t)e=`${this.renderBinaryQuery(e,a)}`;return e}renderBinaryQuery(e,t){let a=e+` ${t.operator} `;return t.vectorMatches&&(a+=`${t.vectorMatches} `),a+`${this.renderQuery(t.query)}`}renderLabels(e){if(0===e.length)return"";let t="{";for(const a of e)"{"!==t&&(t+=", "),t+=`${a.label}${a.op}"${a.value}"`;return t+"}"}}},"./public/app/plugins/datasource/prometheus/querybuilder/shared/OperationExplainedBox.tsx":(e,t,a)=>{a.d(t,{B:()=>o});var n=a("./.yarn/__virtual__/@emotion-css-virtual-72c314ddb1/0/cache/@emotion-css-npm-11.7.1-25ff8755a7-ac1f56656f.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),s=a("./packages/grafana-data/src/index.ts"),r=a("./packages/grafana-ui/src/index.ts"),i=(a("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),a("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js"));function o(e){let{title:t,stepNumber:a,markdown:n,children:o}=e;const c=(0,r.useStyles2)(l);return(0,i.jsxs)("div",{className:c.box,children:[(0,i.jsx)("div",{className:c.stepNumber,children:a}),(0,i.jsxs)("div",{className:c.boxInner,children:[(0,i.jsx)("div",{className:c.header,children:(0,i.jsx)("span",{children:t})}),(0,i.jsxs)("div",{className:c.body,children:[n&&(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,s.renderMarkdown)(n)}}),o]})]})]})}const l=e=>({box:(0,n.css)({background:e.colors.background.secondary,padding:e.spacing(1),borderRadius:e.shape.borderRadius(),position:"relative",marginBottom:e.spacing(.5)}),boxInner:(0,n.css)({marginLeft:e.spacing(4)}),stepNumber:(0,n.css)({fontWeight:e.typography.fontWeightMedium,background:e.colors.secondary.main,width:"20px",height:"20px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"10px",left:"11px",fontSize:e.typography.bodySmall.fontSize}),header:(0,n.css)({paddingBottom:e.spacing(.5),display:"flex",alignItems:"center",fontFamily:e.typography.fontFamilyMonospace}),body:(0,n.css)({color:e.colors.text.secondary,"p:last-child":{margin:0},a:{color:e.colors.text.link,textDecoration:"underline"}})})},"./public/app/plugins/datasource/prometheus/querybuilder/shared/OperationList.tsx":(e,t,a)=>{a.d(t,{P:()=>k});var n,s=a("./.yarn/__virtual__/@emotion-css-virtual-72c314ddb1/0/cache/@emotion-css-npm-11.7.1-25ff8755a7-ac1f56656f.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),r=a("./.yarn/__virtual__/@grafana-experimental-virtual-044b968173/0/cache/@grafana-experimental-npm-0.0.2-canary.11-3ed391aeb7-6e8fa4bbdf.zip/node_modules/@grafana/experimental/index.js"),i=a("./packages/grafana-ui/src/index.ts"),o=a("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),l=a("./.yarn/__virtual__/react-beautiful-dnd-virtual-27e4b658e7/0/cache/react-beautiful-dnd-npm-13.1.0-fcf5568b1c-12b7e9fbe8.zip/node_modules/react-beautiful-dnd/dist/react-beautiful-dnd.esm.js"),c=a("./packages/grafana-data/src/index.ts"),u=a("./.yarn/__virtual__/react-popper-virtual-0f6b5e2cc8/0/cache/react-popper-npm-2.2.5-6e86e4bf1e-915fcf08e1.zip/node_modules/react-popper/lib/esm/usePopper.js"),p=a("./.yarn/__virtual__/react-use-virtual-00326e70ba/0/cache/react-use-npm-17.3.2-a032cbeb01-7379460f51.zip/node_modules/react-use/esm/useToggle.js"),d=a("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const h=o.memo((e=>{let{def:t,operation:a}=e;const s=(0,i.useStyles2)(m),[l,c]=(0,o.useState)(null),[h,f]=(0,o.useState)(null),[b,y]=(0,p.Z)(!1),v=(0,u.D)(l,h,{placement:"top",modifiers:[{name:"arrow",enabled:!0},{name:"preventOverflow",enabled:!0,options:{rootBoundary:"viewport"}}]});return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(i.Button,{ref:c,icon:"info-circle",size:"sm",variant:"secondary",fill:"text",onClick:y}),b&&(0,d.jsx)(i.Portal,{children:(0,d.jsxs)("div",Object.assign({ref:f,style:v.styles.popper},v.attributes.popper,{className:s.docBox,children:[(0,d.jsxs)("div",{className:s.docBoxHeader,children:[(0,d.jsx)("span",{children:t.renderer(a,t,"<expr>")}),n||(n=(0,d.jsx)(r.FlexItem,{grow:1})),(0,d.jsx)(i.Button,{icon:"times",onClick:y,fill:"text",variant:"secondary",title:"Remove operation"})]}),(0,d.jsx)("div",{className:s.docBoxBody,dangerouslySetInnerHTML:{__html:g(t,a)}})]}))})]})}));h.displayName="OperationDocs";const m=e=>({docBox:(0,s.css)({overflow:"hidden",background:e.colors.background.canvas,border:`1px solid ${e.colors.border.strong}`,boxShadow:e.shadows.z2,maxWidth:"600px",padding:e.spacing(1),borderRadius:e.shape.borderRadius(),zIndex:e.zIndex.tooltip}),docBoxHeader:(0,s.css)({fontSize:e.typography.h5.fontSize,fontFamily:e.typography.fontFamilyMonospace,paddingBottom:e.spacing(1),display:"flex",alignItems:"center"}),docBoxBody:(0,s.css)({marginBottom:e.spacing(-1),color:e.colors.text.secondary}),signature:(0,s.css)({fontSize:e.typography.bodySmall.fontSize,fontFamily:e.typography.fontFamilyMonospace}),dropdown:(0,s.css)({opacity:0,color:e.colors.text.secondary})});function g(e,t){var a;return(0,c.renderMarkdown)(e.explainHandler?e.explainHandler(t,e):null!==(a=e.documentation)&&void 0!==a?a:"no docs")}const f=o.memo((e=>{var t;let{operation:a,def:n,index:s,onChange:r,queryModeller:l}=e;const c=(0,i.useStyles2)(b),[u,p]=(0,o.useState)({}),h=()=>{if(u.isOpen)p(Object.assign({},u,{isOpen:!1}));else{const e=l.getAlternativeOperations(n.alternativesKey).map((e=>({label:e.name,value:e})));p({isOpen:!0,alternatives:e})}},m=(0,d.jsx)("span",{children:null!==(t=n.name)&&void 0!==t?t:n.id});return n.alternativesKey?(0,d.jsxs)(d.Fragment,{children:[!u.isOpen&&(0,d.jsxs)("button",{className:c.wrapper,onClick:h,title:"Click to replace with alternative function",children:[m,(0,d.jsx)(i.Icon,{className:`${c.dropdown} operation-header-show-on-hover`,name:"arrow-down",size:"sm"})]}),u.isOpen&&(0,d.jsx)(i.Select,{autoFocus:!0,openMenuOnFocus:!0,placeholder:"Replace with",options:u.alternatives,isOpen:!0,onCloseMenu:h,onChange:e=>{e.value&&r(s,Object.assign({},a,{id:e.value.id}))}})]}):m}));f.displayName="OperationName";const b=e=>({wrapper:(0,s.css)({display:"inline-block",background:"transparent",padding:0,border:"none",boxShadow:"none",cursor:"pointer"}),dropdown:(0,s.css)({opacity:0,color:e.colors.text.secondary})});function y(e){return e.editor?e.editor:e.options?x:v}function v(e){var t;return(0,d.jsx)(i.Input,{defaultValue:null!==(t=e.value)&&void 0!==t?t:"",onKeyDown:t=>{"Enter"===t.key&&(t.currentTarget.value!==e.value&&e.onChange(e.index,t.currentTarget.value),e.onRunQuery())},onBlur:t=>{e.onChange(e.index,t.currentTarget.value)}})}function x(e){let{paramDef:t,value:a,index:n,onChange:s}=e;const r=t.options.map((e=>({label:e,value:e})));return(0,d.jsx)(i.Select,{menuShouldPortal:!0,value:(0,c.toOption)(a),options:r,onChange:e=>s(n,e.value)})}var j;function w(e){var t,a;let{operation:n,index:s,onRemove:o,onChange:c,onRunQuery:u,queryModeller:p,query:m,datasource:g}=e;const b=(0,i.useStyles2)(O),v=p.getOperationDef(n.id),x=(e,t)=>{const a=Object.assign({},n,{params:[...n.params]});a.params[e]=t,_(v,a,s,e,c)},w=()=>{const e=Object.assign({},n,{params:[...n.params,""]});_(v,e,s,n.params.length,c)},k=e=>{const t=Object.assign({},n,{params:[...n.params.slice(0,e),...n.params.slice(e+1)]});_(v,t,s,e,c)},S=[];for(let e=0;e<n.params.length;e++){const t=v.params[Math.min(v.params.length-1,e)],a=y(t);S.push((0,d.jsxs)("div",{className:b.paramRow,children:[(0,d.jsx)("div",{className:b.paramName,children:t.name}),(0,d.jsx)("div",{className:b.paramValue,children:(0,d.jsxs)(r.Stack,{gap:.5,direction:"row",alignItems:"center",wrap:!1,children:[(0,d.jsx)(a,{index:e,paramDef:t,value:n.params[e],operation:n,onChange:x,onRunQuery:u,query:m,datasource:g}),t.restParam&&(n.params.length>v.params.length||t.optional)&&(0,d.jsx)(i.Button,{size:"sm",fill:"text",icon:"times",variant:"secondary",title:`Remove ${t.name}`,onClick:()=>k(e)})]})})]},`${e}-1`))}let C;if(v.params.length>0){const e=v.params[v.params.length-1];e.restParam&&(C=function(e,t,a,n){return(0,d.jsx)("div",{className:n.restParam,children:(0,d.jsx)(i.Button,{size:"sm",icon:"plus",title:`Add ${e.name}`,variant:"secondary",onClick:t,children:e.name})},`${a}-2`)}(e,w,n.params.length,b))}return(0,d.jsx)(l._l,{draggableId:`operation-${s}`,index:s,children:e=>(0,d.jsxs)("div",Object.assign({className:b.card,ref:e.innerRef},e.draggableProps,{"data-testid":`operation-wrapper-for-${n.id}`,children:[(0,d.jsxs)("div",Object.assign({className:b.header},e.dragHandleProps,{children:[t||(t=(0,d.jsx)(f,{operation:n,def:v,index:s,onChange:c,queryModeller:p})),j||(j=(0,d.jsx)(r.FlexItem,{grow:1})),(0,d.jsxs)("div",{className:`${b.operationHeaderButtons} operation-header-show-on-hover`,children:[a||(a=(0,d.jsx)(h,{def:v,operation:n})),(0,d.jsx)(i.Button,{icon:"times",size:"sm",onClick:()=>o(s),fill:"text",variant:"secondary",title:"Remove operation"})]})]})),(0,d.jsx)("div",{className:b.body,children:S}),C,s<m.operations.length-1&&(0,d.jsxs)("div",{className:b.arrow,children:[(0,d.jsx)("div",{className:b.arrowLine}),(0,d.jsx)("div",{className:b.arrowArrow})]})]}))})}function _(e,t,a,n,s){e.paramChangedHandler?s(a,e.paramChangedHandler(n,t,e)):s(a,t)}const O=e=>({card:(0,s.css)({background:e.colors.background.primary,border:`1px solid ${e.colors.border.medium}`,display:"flex",flexDirection:"column",cursor:"grab",borderRadius:e.shape.borderRadius(1),marginBottom:e.spacing(1),position:"relative"}),header:(0,s.css)({borderBottom:`1px solid ${e.colors.border.medium}`,padding:e.spacing(.5,.5,.5,1),gap:e.spacing(1),display:"flex",alignItems:"center","&:hover .operation-header-show-on-hover":(0,s.css)({opacity:1})}),infoIcon:(0,s.css)({color:e.colors.text.secondary}),body:(0,s.css)({margin:e.spacing(1,1,.5,1),display:"table"}),paramRow:(0,s.css)({display:"table-row",verticalAlign:"middle"}),paramName:(0,s.css)({display:"table-cell",padding:e.spacing(0,1,0,0),fontSize:e.typography.bodySmall.fontSize,fontWeight:e.typography.fontWeightMedium,verticalAlign:"middle",height:"32px"}),operationHeaderButtons:(0,s.css)({opacity:0,transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short})}),paramValue:(0,s.css)({display:"table-cell",paddingBottom:e.spacing(.5),verticalAlign:"middle"}),restParam:(0,s.css)({padding:e.spacing(0,1,1,1)}),arrow:(0,s.css)({position:"absolute",top:"0",right:"-18px",display:"flex"}),arrowLine:(0,s.css)({height:"2px",width:"8px",backgroundColor:e.colors.border.strong,position:"relative",top:"14px"}),arrowArrow:(0,s.css)({width:0,height:0,borderTop:"5px solid transparent",borderBottom:"5px solid transparent",borderLeft:`7px solid ${e.colors.border.strong}`,position:"relative",top:"10px"})});function k(e){let{query:t,datasource:a,queryModeller:n,onChange:s,onRunQuery:o}=e;const c=(0,i.useStyles2)(S),{operations:u}=t,p=(e,a)=>{const n=[...u];n.splice(e,1,a),s(Object.assign({},t,{operations:n}))},h=e=>{const a=[...u.slice(0,e),...u.slice(e+1)];s(Object.assign({},t,{operations:a}))},m=n.getCategories().map((e=>({value:e,label:e,children:n.getOperationsForCategory(e).map((e=>({value:e.id,label:e.name,isLeaf:!0})))})));return(0,d.jsx)(r.Stack,{gap:1,direction:"column",children:(0,d.jsxs)(r.Stack,{gap:1,children:[u.length>0&&(0,d.jsx)(l.Z5,{onDragEnd:e=>{if(!e.destination)return;const a=[...u],n=a[e.source.index];a.splice(e.source.index,1),a.splice(e.destination.index,0,n),s(Object.assign({},t,{operations:a}))},children:(0,d.jsx)(l.bK,{droppableId:"sortable-field-mappings",direction:"horizontal",children:e=>(0,d.jsxs)("div",Object.assign({className:c.operationList,ref:e.innerRef},e.droppableProps,{children:[u.map(((e,s)=>(0,d.jsx)(w,{queryModeller:n,index:s,operation:e,query:t,datasource:a,onChange:p,onRemove:h,onRunQuery:o},s))),e.placeholder]}))})}),(0,d.jsx)("div",{className:c.addButton,children:(0,d.jsx)(i.ButtonCascader,{icon:"plus",options:m,onChange:e=>{const a=n.getOperationDef(e[1]);s(a.addOperationHandler(a,t,n))},variant:"secondary",hideDownIcon:!0,buttonProps:{"aria-label":"Add operation",title:"Add operation"}},"cascader")})]})})}const S=e=>({heading:(0,s.css)({fontSize:12,fontWeight:e.typography.fontWeightMedium,marginBottom:0}),operationList:(0,s.css)({display:"flex",flexWrap:"wrap",gap:e.spacing(2)}),addButton:(0,s.css)({paddingBottom:e.spacing(1)})})},"./public/app/plugins/datasource/prometheus/querybuilder/shared/OperationListExplained.tsx":(e,t,a)=>{a.d(t,{V:()=>r});a("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js");var n=a("./public/app/plugins/datasource/prometheus/querybuilder/shared/OperationExplainedBox.tsx"),s=a("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");function r(e){let{query:t,queryModeller:a,stepNumber:r}=e;return(0,s.jsx)(s.Fragment,{children:t.operations.map(((e,t)=>{var i;const o=a.getOperationDef(e.id),l=o.renderer(e,o,"<expr>"),c=o.explainHandler?o.explainHandler(e,o):null!==(i=o.documentation)&&void 0!==i?i:"no docs";return(0,s.jsx)(n.B,{stepNumber:t+r,title:l,markdown:c},t)}))})}},"./public/app/plugins/datasource/prometheus/querybuilder/shared/QueryEditorModeToggle.tsx":(e,t,a)=>{a.d(t,{k:()=>o});var n=a("./packages/grafana-ui/src/index.ts"),s=(a("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),a("./public/app/plugins/datasource/prometheus/querybuilder/shared/types.ts")),r=a("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const i=[{label:"Explain",value:s.c.Explain},{label:"Builder",value:s.c.Builder},{label:"Code",value:s.c.Code}];function o(e){let{mode:t,onChange:a}=e;return(0,r.jsx)(n.RadioButtonGroup,{options:i,size:"sm",value:t,onChange:a})}},"./public/app/plugins/datasource/prometheus/querybuilder/shared/QueryHeaderSwitch.tsx":(e,t,a)=>{a.d(t,{n:()=>u});var n=a("./.yarn/__virtual__/@emotion-css-virtual-72c314ddb1/0/cache/@emotion-css-npm-11.7.1-25ff8755a7-ac1f56656f.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),s=a("./.yarn/__virtual__/@grafana-experimental-virtual-044b968173/0/cache/@grafana-experimental-npm-0.0.2-canary.11-3ed391aeb7-6e8fa4bbdf.zip/node_modules/@grafana/experimental/index.js"),r=a("./packages/grafana-ui/src/index.ts"),i=a("./.yarn/cache/lodash-npm-4.17.21-6382451519-eb835a2e51.zip/node_modules/lodash/lodash.js"),o=a("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),l=a("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const c=["label"];function u(e){let{label:t}=e,a=function(e,t){if(null==e)return{};var a,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,c);const n=(0,o.useRef)((0,i.uniqueId)(`switch-${t}`)),u=(0,r.useStyles2)(p);return(0,l.jsxs)(s.Stack,{gap:1,children:[(0,l.jsx)("label",{htmlFor:n.current,className:u.switchLabel,children:t}),(0,l.jsx)(r.Switch,Object.assign({},a,{id:n.current}))]})}const p=e=>({switchLabel:(0,n.css)({color:e.colors.text.secondary,cursor:"pointer",fontSize:e.typography.bodySmall.fontSize,"&:hover":{color:e.colors.text.primary}})})},"./public/app/plugins/datasource/prometheus/querybuilder/shared/operationUtils.ts":(e,t,a)=>{a.d(t,{pS:()=>s,zJ:()=>r,PP:()=>o,t7:()=>l});var n=a("./.yarn/cache/lodash-npm-4.17.21-6382451519-eb835a2e51.zip/node_modules/lodash/lodash.js");function s(e,t,a){const n=i(e,t,a),s=e.id+"(";return a&&n.push(a),s+n.join(", ")+")"}function r(e,t,a){const n=i(e,t,a),s=e.id+"(";return a&&n.unshift(a),s+n.join(", ")+")"}function i(e,t,a){var n;return(null!==(n=e.params)&&void 0!==n?n:[]).map(((e,a)=>"string"===t.params[a].type?'"'+e+'"':e))}function o(e,t){const a={id:e.id,params:e.defaultParams};return Object.assign({},t,{operations:[...t.operations,a]})}function l(e){return(0,n.capitalize)(e.replace(/_/g," "))}},"./public/app/plugins/datasource/prometheus/querybuilder/shared/types.ts":(e,t,a)=>{let n;a.d(t,{c:()=>n}),function(e){e[e.Builder=0]="Builder",e[e.Code=1]="Code",e[e.Explain=2]="Explain"}(n||(n={}))},"./.yarn/__virtual__/react-use-virtual-00326e70ba/0/cache/react-use-npm-17.3.2-a032cbeb01-7379460f51.zip/node_modules/react-use/esm/usePrevious.js":(e,t,a)=>{a.d(t,{Z:()=>s});var n=a("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js");function s(e){var t=(0,n.useRef)();return(0,n.useEffect)((function(){t.current=e})),t.current}},"./.yarn/__virtual__/react-use-virtual-00326e70ba/0/cache/react-use-npm-17.3.2-a032cbeb01-7379460f51.zip/node_modules/react-use/esm/useToggle.js":(e,t,a)=>{a.d(t,{Z:()=>r});var n=a("./.yarn/cache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),s=function(e,t){return"boolean"==typeof t?t:!e};const r=function(e){return(0,n.useReducer)(s,e)}},"./.yarn/cache/lru-cache-npm-6.0.0-b4c8668fe1-f97f499f89.zip/node_modules/lru-cache/index.js":(e,t,a)=>{const n=a("./.yarn/cache/yallist-npm-4.0.0-b493d9e907-343617202a.zip/node_modules/yallist/yallist.js"),s=Symbol("max"),r=Symbol("length"),i=Symbol("lengthCalculator"),o=Symbol("allowStale"),l=Symbol("maxAge"),c=Symbol("dispose"),u=Symbol("noDisposeOnSet"),p=Symbol("lruList"),d=Symbol("cache"),h=Symbol("updateAgeOnGet"),m=()=>1;const g=(e,t,a)=>{const n=e[d].get(t);if(n){const t=n.value;if(f(e,t)){if(y(e,n),!e[o])return}else a&&(e[h]&&(n.value.now=Date.now()),e[p].unshiftNode(n));return t.value}},f=(e,t)=>{if(!t||!t.maxAge&&!e[l])return!1;const a=Date.now()-t.now;return t.maxAge?a>t.maxAge:e[l]&&a>e[l]},b=e=>{if(e[r]>e[s])for(let t=e[p].tail;e[r]>e[s]&&null!==t;){const a=t.prev;y(e,t),t=a}},y=(e,t)=>{if(t){const a=t.value;e[c]&&e[c](a.key,a.value),e[r]-=a.length,e[d].delete(a.key),e[p].removeNode(t)}};class v{constructor(e,t,a,n,s){this.key=e,this.value=t,this.length=a,this.now=n,this.maxAge=s||0}}const x=(e,t,a,n)=>{let s=a.value;f(e,s)&&(y(e,a),e[o]||(s=void 0)),s&&t.call(n,s.value,s.key,e)};e.exports=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[s]=e.max||1/0;const t=e.length||m;if(this[i]="function"!=typeof t?m:t,this[o]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[l]=e.maxAge||0,this[c]=e.dispose,this[u]=e.noDisposeOnSet||!1,this[h]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[s]=e||1/0,b(this)}get max(){return this[s]}set allowStale(e){this[o]=!!e}get allowStale(){return this[o]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,b(this)}get maxAge(){return this[l]}set lengthCalculator(e){"function"!=typeof e&&(e=m),e!==this[i]&&(this[i]=e,this[r]=0,this[p].forEach((e=>{e.length=this[i](e.value,e.key),this[r]+=e.length}))),b(this)}get lengthCalculator(){return this[i]}get length(){return this[r]}get itemCount(){return this[p].length}rforEach(e,t){t=t||this;for(let a=this[p].tail;null!==a;){const n=a.prev;x(this,e,a,t),a=n}}forEach(e,t){t=t||this;for(let a=this[p].head;null!==a;){const n=a.next;x(this,e,a,t),a=n}}keys(){return this[p].toArray().map((e=>e.key))}values(){return this[p].toArray().map((e=>e.value))}reset(){this[c]&&this[p]&&this[p].length&&this[p].forEach((e=>this[c](e.key,e.value))),this[d]=new Map,this[p]=new n,this[r]=0}dump(){return this[p].map((e=>!f(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[p]}set(e,t,a){if((a=a||this[l])&&"number"!=typeof a)throw new TypeError("maxAge must be a number");const n=a?Date.now():0,o=this[i](t,e);if(this[d].has(e)){if(o>this[s])return y(this,this[d].get(e)),!1;const i=this[d].get(e).value;return this[c]&&(this[u]||this[c](e,i.value)),i.now=n,i.maxAge=a,i.value=t,this[r]+=o-i.length,i.length=o,this.get(e),b(this),!0}const h=new v(e,t,o,n,a);return h.length>this[s]?(this[c]&&this[c](e,t),!1):(this[r]+=h.length,this[p].unshift(h),this[d].set(e,this[p].head),b(this),!0)}has(e){if(!this[d].has(e))return!1;const t=this[d].get(e).value;return!f(this,t)}get(e){return g(this,e,!0)}peek(e){return g(this,e,!1)}pop(){const e=this[p].tail;return e?(y(this,e),e.value):null}del(e){y(this,this[d].get(e))}load(e){this.reset();const t=Date.now();for(let a=e.length-1;a>=0;a--){const n=e[a],s=n.e||0;if(0===s)this.set(n.k,n.v);else{const e=s-t;e>0&&this.set(n.k,n.v,e)}}}prune(){this[d].forEach(((e,t)=>g(this,t,!1)))}}},"./.yarn/cache/yallist-npm-4.0.0-b493d9e907-343617202a.zip/node_modules/yallist/iterator.js":e=>{e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},"./.yarn/cache/yallist-npm-4.0.0-b493d9e907-343617202a.zip/node_modules/yallist/yallist.js":(e,t,a)=>{function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var a=0,s=arguments.length;a<s;a++)t.push(arguments[a]);return t}function s(e,t,a){var n=t===e.head?new o(a,null,t,e):new o(a,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function r(e,t){e.tail=new o(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function i(e,t){e.head=new o(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function o(e,t,a,n){if(!(this instanceof o))return new o(e,t,a,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,a?(a.prev=this,this.next=a):this.next=null}e.exports=n,n.Node=o,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,a=e.prev;return t&&(t.prev=a),a&&(a.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=a),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)r(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)i(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var a=this.head,n=0;null!==a;n++)e.call(t,a.value,n,this),a=a.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var a=this.tail,n=this.length-1;null!==a;n--)e.call(t,a.value,n,this),a=a.prev},n.prototype.get=function(e){for(var t=0,a=this.head;null!==a&&t<e;t++)a=a.next;if(t===e&&null!==a)return a.value},n.prototype.getReverse=function(e){for(var t=0,a=this.tail;null!==a&&t<e;t++)a=a.prev;if(t===e&&null!==a)return a.value},n.prototype.map=function(e,t){t=t||this;for(var a=new n,s=this.head;null!==s;)a.push(e.call(t,s.value,this)),s=s.next;return a},n.prototype.mapReverse=function(e,t){t=t||this;for(var a=new n,s=this.tail;null!==s;)a.push(e.call(t,s.value,this)),s=s.prev;return a},n.prototype.reduce=function(e,t){var a,n=this.head;if(arguments.length>1)a=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,a=this.head.value}for(var s=0;null!==n;s++)a=e(a,n.value,s),n=n.next;return a},n.prototype.reduceReverse=function(e,t){var a,n=this.tail;if(arguments.length>1)a=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,a=this.tail.value}for(var s=this.length-1;null!==n;s--)a=e(a,n.value,s),n=n.prev;return a},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,a=this.head;null!==a;t++)e[t]=a.value,a=a.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,a=this.tail;null!==a;t++)e[t]=a.value,a=a.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var a=new n;if(t<e||t<0)return a;e<0&&(e=0),t>this.length&&(t=this.length);for(var s=0,r=this.head;null!==r&&s<e;s++)r=r.next;for(;null!==r&&s<t;s++,r=r.next)a.push(r.value);return a},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var a=new n;if(t<e||t<0)return a;e<0&&(e=0),t>this.length&&(t=this.length);for(var s=this.length,r=this.tail;null!==r&&s>t;s--)r=r.prev;for(;null!==r&&s>e;s--,r=r.prev)a.push(r.value);return a},n.prototype.splice=function(e,t,...a){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,r=this.head;null!==r&&n<e;n++)r=r.next;var i=[];for(n=0;r&&n<t;n++)i.push(r.value),r=this.removeNode(r);null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(n=0;n<a.length;n++)r=s(this,r,a[n]);return i},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,a=e;null!==a;a=a.prev){var n=a.prev;a.prev=a.next,a.next=n}return this.head=t,this.tail=e,this};try{a("./.yarn/cache/yallist-npm-4.0.0-b493d9e907-343617202a.zip/node_modules/yallist/iterator.js")(n)}catch(e){}}}]);
//# sourceMappingURL=1529.e65e3aa10981aa98e7a1.js.map