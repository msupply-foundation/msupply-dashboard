(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{"+nK6":function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"TeamList",(function(){return T}));var r,s,a,i,c,d=n("q1tI"),o=n("0cfB"),m=n("ZGyg"),u=n("kDLi"),l=n("QQVG"),b=n("GQ3c"),h=n("gxTa"),j=n("8uRs"),p=n("lzJ5"),f=n("EKT6"),g=n("ZFWI"),O=n("umNM"),x=n("hBny"),v=n("BPIC"),y=n("nKUr");class T extends d.PureComponent{constructor(...e){super(...e),this.deleteTeam=e=>{this.props.deleteTeam(e.id)},this.onSearchQueryChange=e=>{this.props.setSearchQuery(e)}}componentDidMount(){this.fetchTeams()}async fetchTeams(){await this.props.loadTeams()}renderTeam(e){const{editorsCanAdmin:t,signedInUser:n}=this.props,r=e.permission,s="org/teams/edit/"+e.id,a=Object(j.h)({permission:r,editorsCanAdmin:t,signedInUser:n});return Object(y.jsxs)("tr",{children:[Object(y.jsx)("td",{className:"width-4 text-center link-td",children:Object(y.jsx)("a",{href:s,children:Object(y.jsx)("img",{className:"filter-table__avatar",src:e.avatarUrl})})}),Object(y.jsx)("td",{className:"link-td",children:Object(y.jsx)("a",{href:s,children:e.name})}),Object(y.jsx)("td",{className:"link-td",children:Object(y.jsx)("a",{href:s,children:e.email})}),Object(y.jsx)("td",{className:"link-td",children:Object(y.jsx)("a",{href:s,children:e.memberCount})}),Object(y.jsx)("td",{className:"text-right",children:Object(y.jsx)(u.DeleteButton,{size:"sm",disabled:!a,onConfirm:()=>this.deleteTeam(e)})})]},e.id)}renderEmptyList(){return r||(r=Object(y.jsx)(l.a,{title:"You haven't created any teams yet.",buttonIcon:"users-alt",buttonLink:"org/teams/new",buttonTitle:" New team",proTip:"Assign folder and dashboard permissions to teams instead of users to ease administration.",proTipLink:"",proTipLinkTitle:"",proTipTarget:"_blank"}))}renderTeamList(){const{teams:e,searchQuery:t,editorsCanAdmin:n,signedInUser:r}=this.props,d=n&&r.orgRole===b.OrgRole.Viewer,o=d?" disabled":"",m=d?"#":"org/teams/new";return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)("div",{className:"page-action-bar",children:[Object(y.jsx)("div",{className:"gf-form gf-form--grow",children:Object(y.jsx)(f.a,{placeholder:"Search teams",value:t,onChange:this.onSearchQueryChange})}),Object(y.jsx)(u.LinkButton,{className:o,href:m,children:"New Team"})]}),Object(y.jsx)("div",{className:"admin-list-table",children:Object(y.jsxs)("table",{className:"filter-table filter-table--hover form-inline",children:[Object(y.jsx)("thead",{children:Object(y.jsxs)("tr",{children:[s||(s=Object(y.jsx)("th",{})),a||(a=Object(y.jsx)("th",{children:"Name"})),i||(i=Object(y.jsx)("th",{children:"Email"})),c||(c=Object(y.jsx)("th",{children:"Members"})),Object(y.jsx)("th",{style:{width:"1%"}})]})}),Object(y.jsx)("tbody",{children:e.map(e=>this.renderTeam(e))})]})})]})}renderList(){const{teamsCount:e,hasFetched:t}=this.props;return t?e>0?this.renderTeamList():this.renderEmptyList():null}render(){const{hasFetched:e,navModel:t}=this.props;return Object(y.jsx)(m.a,{navModel:t,children:Object(y.jsx)(m.a.Contents,{isLoading:!e,children:this.renderList()})})}}const w={loadTeams:h.g,deleteTeam:h.c,setSearchQuery:v.c};t.default=Object(o.hot)(e)(Object(x.a)((function(e){return{navModel:Object(p.a)(e.navIndex,"teams"),teams:Object(j.f)(e.teams),searchQuery:Object(j.b)(e.teams),teamsCount:Object(j.g)(e.teams),hasFetched:e.teams.hasFetched,editorsCanAdmin:g.a.editorsCanAdmin,signedInUser:O.a.user}}),w,e=>e.teams)(T))}.call(this,n("3UD+")(e))},"8uRs":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"g",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return m})),n.d(t,"i",(function(){return u})),n.d(t,"h",(function(){return l}));var r=n("GQ3c");const s=e=>e.searchQuery,a=e=>e.searchMemberQuery,i=e=>e.groups,c=e=>e.teams.length,d=(e,t)=>e.team.id===parseInt(t,10)?e.team:null,o=e=>{const t=RegExp(e.searchQuery,"i");return e.teams.filter(e=>t.test(e.name))},m=e=>{const t=RegExp(e.searchMemberQuery,"i");return e.members.filter(e=>t.test(e.login)||t.test(e.email)||t.test(e.name))},u=e=>{const{members:t,signedInUser:n,editorsCanAdmin:s}=e,a=t.find(e=>e.userId===n.id),i=a?a.permission:r.TeamPermissionLevel.Member;return l({permission:i,signedInUser:n,editorsCanAdmin:s})},l=e=>{const{permission:t,signedInUser:n,editorsCanAdmin:s}=e,a=n.isGrafanaAdmin||n.orgRole===r.OrgRole.Admin,i=t===r.TeamPermissionLevel.Admin;return a||i||!s}},gxTa:function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return m})),n.d(t,"i",(function(){return u})),n.d(t,"j",(function(){return l})),n.d(t,"e",(function(){return b})),n.d(t,"a",(function(){return h})),n.d(t,"h",(function(){return j})),n.d(t,"c",(function(){return p})),n.d(t,"k",(function(){return f}));var r=n("t8hP"),s=n("3SGO"),a=n("zsYB"),i=n("BPIC");function c(){return async e=>{const t=await Object(r.getBackendSrv)().get("/api/teams/search",{perpage:1e3,page:1});e(Object(i.g)(t.teams))}}function d(e){return async t=>{const n=await Object(r.getBackendSrv)().get("/api/teams/"+e);t(Object(i.e)(n)),t(Object(s.d)(Object(a.a)(n)))}}function o(){return async(e,t)=>{const n=t().team.team,s=await Object(r.getBackendSrv)().get(`/api/teams/${n.id}/members`);e(Object(i.f)(s))}}function m(e){return async(t,n)=>{const s=n().team.team;await Object(r.getBackendSrv)().post(`/api/teams/${s.id}/members`,{userId:e}),t(o())}}function u(e){return async(t,n)=>{const s=n().team.team;await Object(r.getBackendSrv)().delete(`/api/teams/${s.id}/members/${e}`),t(o())}}function l(e,t){return async(n,s)=>{const a=s().team.team;await Object(r.getBackendSrv)().put("/api/teams/"+a.id,{name:e,email:t}),n(d(a.id))}}function b(){return async(e,t)=>{const n=t().team.team,s=await Object(r.getBackendSrv)().get(`/api/teams/${n.id}/groups`);e(Object(i.d)(s))}}function h(e){return async(t,n)=>{const s=n().team.team;await Object(r.getBackendSrv)().post(`/api/teams/${s.id}/groups`,{groupId:e}),t(b())}}function j(e){return async(t,n)=>{const s=n().team.team;await Object(r.getBackendSrv)().delete(`/api/teams/${s.id}/groups/${encodeURIComponent(e)}`),t(b())}}function p(e){return async t=>{await Object(r.getBackendSrv)().delete("/api/teams/"+e),t(c())}}function f(e){return async t=>{await Object(r.getBackendSrv)().put(`/api/teams/${e.teamId}/members/${e.userId}`,{permission:e.permission}),t(o())}}},hBny:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n("/MKj"),s=n("zVNn"),a=n("q1tI"),i=n("2mql"),c=n.n(i),d=n("nKUr");function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}const m=(e,t,n)=>i=>{const m=Object(r.connect)(e,t)(i),u=e=>{const t=Object(r.useDispatch)();return Object(a.useEffect)(()=>function(){t(Object(s.a)({stateSelector:n}))},[t]),Object(d.jsx)(m,o({},e))};return u.displayName=`ConnectWithCleanUp(${m.displayName})`,c()(u,i),u}},zsYB:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("GQ3c"),s=n("ZFWI");function a(e){const t={img:e.avatarUrl,id:"team-"+e.id,subTitle:"Manage members and settings",url:"",text:e.name,breadcrumbs:[{title:"Teams",url:"org/teams"}],children:[{active:!1,icon:"users-alt",id:"team-members-"+e.id,text:"Members",url:`org/teams/edit/${e.id}/members`},{active:!1,icon:"sliders-v-alt",id:"team-settings-"+e.id,text:"Settings",url:`org/teams/edit/${e.id}/settings`}]};return s.b.licenseInfo.hasLicense&&t.children.push({active:!1,icon:"sync",id:"team-groupsync-"+e.id,text:"External group sync",url:`org/teams/edit/${e.id}/groupsync`}),t}function i(e){const t=a({avatarUrl:"public/img/user_profile.png",id:1,name:"Loading",email:"loading",memberCount:0,permission:r.TeamPermissionLevel.Member});let n;for(const r of t.children)if(r.id.indexOf(e)>0){r.active=!0,n=r;break}return{main:t,node:n}}}}]);
//# sourceMappingURL=TeamList.17511e2bf08b06f121f8.js.map