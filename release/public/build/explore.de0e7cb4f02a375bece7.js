(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{"0H9l":function(e,t,s){"use strict";s("q1tI");var i=s("kDLi"),n=s("dRu9"),o=s("nKUr");function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}const a=e=>{const t={transition:`opacity ${e.duration}ms linear`,opacity:0},s={exited:{opacity:0,display:"none"},entering:{opacity:0},entered:{opacity:1},exiting:{opacity:0}};return Object(o.jsx)(n.a,{in:e.in,timeout:e.duration,unmountOnExit:e.unmountOnExit||!1,onExited:e.onExited,children:i=>Object(o.jsx)("div",{style:r({},t,s[i]),children:e.children})})};var c=s("vF1F");s.d(t,"a",(function(){return l}));const l=e=>{var t;const{queryError:s}=e,n=Object(i.useTheme2)(),r=!!s,l=r?100:10,d=s?"Query error":"Unknown error",u=(null==s?void 0:s.message)||(null==s||null===(t=s.data)||void 0===t?void 0:t.message)||null,h=c.css`
    margin-top: ${n.spacing(2)};
  `;return Object(o.jsx)(a,{in:r,duration:l,children:Object(o.jsx)(i.Alert,{severity:"error",title:d,className:h,children:u})})}},"3F0C":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var i=s("Obii"),n=s("kDLi");function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}const r=Object(i.isSystemOverrideWithRef)("hideSeriesFrom");function a(e,t,s,i){const{overrides:a}=s,p=e,g=a.findIndex(r);if(g<0){if(t===n.SeriesVisibilityChangeMode.ToggleSelection){return o({},s,{overrides:[c([p]),...s.overrides]})}return o({},s,{overrides:[c(h(i,p)),...s.overrides]})}const b=Array.from(a),[m]=b.splice(g,1);if(t===n.SeriesVisibilityChangeMode.ToggleSelection){const e=d(m);if(e[0]===p&&1===e.length)return o({},s,{overrides:b});return o({},s,{overrides:[c([p]),...b]})}const j=l(m,p);return u(j,i)?o({},s,{overrides:b}):o({},s,{overrides:[j,...b]})}function c(e,t=i.ByNamesMatcherMode.exclude,s){var n;return s=null!==(n=s)&&void 0!==n?n:{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:"hideSeriesFrom",matcher:{id:i.FieldMatcherID.byNames,options:{mode:t,names:e,prefix:t===i.ByNamesMatcherMode.exclude?"All except:":void 0,readOnly:!0}},properties:[o({},s,{value:{viz:!0,legend:!1,tooltip:!1}})]}}const l=(e,t,s=i.ByNamesMatcherMode.exclude)=>{const n=e.properties.find(e=>"custom.hideFrom"===e.id),o=d(e),r=o.findIndex(e=>e===t);return r<0?o.push(t):o.splice(r,1),c(o,s,n)},d=e=>{var t;const s=null===(t=e.matcher.options)||void 0===t?void 0:t.names;return Array.isArray(s)?s:[]},u=(e,t)=>d(e).length===h(t).length,h=(e,t)=>{const s=new Set;for(const n of e)for(const o of n.fields){if(o.type!==i.FieldType.number)continue;const r=Object(i.getFieldDisplayName)(o,n,e);r!==t&&s.add(r)}return Array.from(s)}},"5BoW":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var i=s("GQ3c");const n=e=>Boolean(e.explore[i.ExploreId.left]&&e.explore[i.ExploreId.right])},"6Pa6":function(e,t,s){"use strict";var i=s("q1tI"),n=s("w9yp"),o=s("SMGL"),r=s("kDLi"),a=s("vF1F"),c=s("Xmxp"),l=s("xAj+"),d=s("iODs"),u=s("3SGO"),h=s("UvM7"),p=s("nKUr");const g=Object(r.stylesFactory)(e=>({container:a.css`
      padding-left: ${e.spacing.sm};
      font-size: ${e.typography.size.sm};
      .space-between {
        margin-bottom: ${e.spacing.lg};
      }
    `,input:a.css`
      max-width: 200px;
    `,switch:a.css`
      display: flex;
      align-items: center;
    `,label:a.css`
      margin-left: ${e.spacing.md};
    `})),b=[{value:2,label:"2 days"},{value:5,label:"5 days"},{value:7,label:"1 week"},{value:14,label:"2 weeks"}];function m(e){const{retentionPeriod:t,starredTabAsFirstTab:s,activeDatasourceOnly:i,onChangeRetentionPeriod:n,toggleStarredTabAsFirstTab:o,toggleactiveDatasourceOnly:m,deleteRichHistory:j}=e,f=Object(r.useTheme)(),x=g(f),v=b.find(e=>e.value===t);return Object(p.jsxs)("div",{className:x.container,children:[Object(p.jsx)(r.Field,{label:"History time span",description:"Select the period of time for which Grafana will save your query history",className:"space-between",children:Object(p.jsx)("div",{className:x.input,children:Object(p.jsx)(r.Select,{value:v,options:b,onChange:n})})}),Object(p.jsx)(r.Field,{label:"Default active tab",description:" ",className:"space-between",children:Object(p.jsxs)("div",{className:x.switch,children:[Object(p.jsx)(r.Switch,{value:s,onChange:o}),Object(p.jsx)("div",{className:x.label,children:"Change the default active tab from “Query history” to “Starred”"})]})}),Object(p.jsx)(r.Field,{label:"Data source behaviour",description:" ",className:"space-between",children:Object(p.jsxs)("div",{className:x.switch,children:[Object(p.jsx)(r.Switch,{value:i,onChange:m}),Object(p.jsx)("div",{className:x.label,children:"Only show queries for data source currently active in Explore"})]})}),Object(p.jsx)("div",{className:a.css`
          font-weight: ${f.typography.weight.bold};
        `,children:"Clear query history"}),Object(p.jsx)("div",{className:a.css`
          margin-bottom: ${f.spacing.sm};
        `,children:"Delete all of your query history, permanently."}),Object(p.jsx)(r.Button,{variant:"destructive",onClick:()=>{c.b.publish(new l.ShowConfirmModalEvent({title:"Delete",text:"Are you sure you want to permanently delete your query history?",yesText:"Delete",icon:"trash-alt",onConfirm:()=>{j(),Object(d.a)(Object(u.b)(Object(h.b)("Query history deleted")))}}))},children:"Clear query history"})]})}var j,f=s("LvDl"),x=s("vGfD"),v=s("EKT6"),y=s("rYwU");const O=Object(r.stylesFactory)((e,t)=>{const s=e.isLight?e.palette.gray5:e.palette.dark4,i=t-180+"px";return{container:a.css`
      display: flex;
      .label-slider {
        font-size: ${e.typography.size.sm};
        &:last-of-type {
          margin-top: ${e.spacing.lg};
        }
        &:first-of-type {
          font-weight: ${e.typography.weight.semibold};
          margin-bottom: ${e.spacing.md};
        }
      }
    `,containerContent:a.css`
      width: calc(${"100% - 134px"});
    `,containerSlider:a.css`
      width: 129px;
      margin-right: ${e.spacing.sm};
      .slider {
        bottom: 10px;
        height: ${i};
        width: 129px;
        padding: ${e.spacing.sm} 0;
      }
    `,slider:a.css`
      position: fixed;
    `,selectors:a.css`
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
    `,filterInput:a.css`
      margin-bottom: ${e.spacing.sm};
    `,multiselect:a.css`
      width: 100%;
      margin-bottom: ${e.spacing.sm};
      .gf-form-select-box__multi-value {
        background-color: ${s};
        padding: ${e.spacing.xxs} ${e.spacing.xs} ${e.spacing.xxs} ${e.spacing.sm};
        border-radius: ${e.border.radius.sm};
      }
    `,sort:a.css`
      width: 170px;
    `,sessionName:a.css`
      display: flex;
      align-items: flex-start;
      justify-content: flex-start;
      margin-top: ${e.spacing.lg};
      h4 {
        margin: 0 10px 0 0;
      }
    `,heading:a.css`
      font-size: ${e.typography.heading.h4};
      margin: ${e.spacing.md} ${e.spacing.xxs} ${e.spacing.sm} ${e.spacing.xxs};
    `,footer:a.css`
      height: 60px;
      margin-top: ${e.spacing.lg};
      display: flex;
      justify-content: center;
      font-weight: ${e.typography.weight.light};
      font-size: ${e.typography.size.sm};
      a {
        font-weight: ${e.typography.weight.semibold};
        margin-left: ${e.spacing.xxs};
      }
    `,queries:a.css`
      font-size: ${e.typography.size.sm};
      font-weight: ${e.typography.weight.regular};
      margin-left: ${e.spacing.xs};
    `}});function w(e){const{datasourceFilters:t,onSelectDatasourceFilters:s,queries:o,onChangeSortOrder:a,sortOrder:c,activeDatasourceOnly:l,retentionPeriod:d,exploreId:u,height:h}=e,[g,b]=Object(i.useState)([0,d]),[m,w]=Object(i.useState)([]),[S,C]=Object(i.useState)(""),[T,I]=Object(i.useState)(""),k=Object(r.useTheme)(),D=O(k,h),F=Object(f.uniqBy)(o,"datasourceName").map(e=>e.datasourceName),L=Object(n.d)(F);Object(y.a)(()=>{I(S)},300,[S]),Object(i.useEffect)(()=>{w(Object(n.i)(o,c,null==t?void 0:t.map(e=>e.value),T,g))},[g,o,c,t,T]);const N=Object(n.l)(m,c);return Object(p.jsxs)("div",{className:D.container,children:[Object(p.jsx)("div",{className:D.containerSlider,children:Object(p.jsxs)("div",{className:D.slider,children:[j||(j=Object(p.jsx)("div",{className:"label-slider",children:"Filter history"})),Object(p.jsx)("div",{className:"label-slider",children:Object(n.k)(g[0])}),Object(p.jsx)("div",{className:"slider",children:Object(p.jsx)(r.RangeSlider,{tooltipAlwaysVisible:!1,min:0,max:d,value:g,orientation:"vertical",formatTooltipResult:n.k,reverse:!0,onAfterChange:b})}),Object(p.jsx)("div",{className:"label-slider",children:Object(n.k)(g[1])})]})}),Object(p.jsxs)("div",{className:D.containerContent,children:[Object(p.jsxs)("div",{className:D.selectors,children:[!l&&Object(p.jsx)("div",{"aria-label":"Filter datasources",className:D.multiselect,children:Object(p.jsx)(r.Select,{isMulti:!0,options:L,value:t,placeholder:"Filter queries for data sources(s)",onChange:s})}),Object(p.jsx)("div",{className:D.filterInput,children:Object(p.jsx)(v.a,{placeholder:"Search queries",value:S,onChange:e=>{C(e)}})}),Object(p.jsx)("div",{"aria-label":"Sort queries",className:D.sort,children:Object(p.jsx)(r.Select,{value:R.filter(e=>e.value===c),options:R,placeholder:"Sort queries by",onChange:e=>a(e.value)})})]}),Object.keys(N).map(e=>Object(p.jsxs)("div",{children:[Object(p.jsxs)("div",{className:D.heading,children:[e," ",Object(p.jsxs)("span",{className:D.queries,children:[N[e].length," queries"]})]}),N[e].map(e=>{const t=L.findIndex(t=>t.label===e.datasourceName);return Object(p.jsx)(x.a,{query:e,exploreId:u,dsImg:L[t].imgUrl,isRemoved:L[t].isRemoved},e.ts)})]},e)),Object(p.jsx)("div",{className:D.footer,children:"The history is local to your browser and is not shared with others."})]})]})}const S=Object(r.stylesFactory)(e=>{const t=e.isLight?e.palette.gray5:e.palette.dark4;return{container:a.css`
      display: flex;
    `,containerContent:a.css`
      width: 100%;
    `,selectors:a.css`
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
    `,multiselect:a.css`
      width: 100%;
      margin-bottom: ${e.spacing.sm};
      .gf-form-select-box__multi-value {
        background-color: ${t};
        padding: ${e.spacing.xxs} ${e.spacing.xs} ${e.spacing.xxs} ${e.spacing.sm};
        border-radius: ${e.border.radius.sm};
      }
    `,filterInput:a.css`
      margin-bottom: ${e.spacing.sm};
    `,sort:a.css`
      width: 170px;
    `,footer:a.css`
      height: 60px;
      margin-top: ${e.spacing.lg};
      display: flex;
      justify-content: center;
      font-weight: ${e.typography.weight.light};
      font-size: ${e.typography.size.sm};
      a {
        font-weight: ${e.typography.weight.semibold};
        margin-left: ${e.spacing.xxs};
      }
    `}});function C(e){const{datasourceFilters:t,onSelectDatasourceFilters:s,queries:o,onChangeSortOrder:a,sortOrder:c,activeDatasourceOnly:l,exploreId:d}=e,[u,h]=Object(i.useState)([]),[g,b]=Object(i.useState)(""),[m,j]=Object(i.useState)(""),O=Object(r.useTheme)(),w=S(O),C=Object(f.uniqBy)(o,"datasourceName").map(e=>e.datasourceName),T=Object(n.d)(C);return Object(y.a)(()=>{j(g)},300,[g]),Object(i.useEffect)(()=>{const e=o.filter(e=>!0===e.starred);h(Object(n.i)(e,c,null==t?void 0:t.map(e=>e.value),m))},[o,c,t,m]),Object(p.jsx)("div",{className:w.container,children:Object(p.jsxs)("div",{className:w.containerContent,children:[Object(p.jsxs)("div",{className:w.selectors,children:[!l&&Object(p.jsx)("div",{"aria-label":"Filter datasources",className:w.multiselect,children:Object(p.jsx)(r.Select,{isMulti:!0,options:T,value:t,placeholder:"Filter queries for specific data sources(s)",onChange:s})}),Object(p.jsx)("div",{className:w.filterInput,children:Object(p.jsx)(v.a,{placeholder:"Search queries",value:g,onChange:e=>{b(e)}})}),Object(p.jsx)("div",{"aria-label":"Sort queries",className:w.sort,children:Object(p.jsx)(r.Select,{options:R,value:R.filter(e=>e.value===c),placeholder:"Sort queries by",onChange:e=>a(e.value)})})]}),u.map(e=>{const t=T.findIndex(t=>t.label===e.datasourceName);return Object(p.jsx)(x.a,{query:e,exploreId:d,dsImg:T[t].imgUrl,isRemoved:T[t].isRemoved},e.ts)}),Object(p.jsx)("div",{className:w.footer,children:"The history is local to your browser and is not shared with others."})]})})}let T;s.d(t,"b",(function(){return T})),s.d(t,"c",(function(){return R})),s.d(t,"a",(function(){return k})),function(e){e.RichHistory="Query history",e.Starred="Starred",e.Settings="Settings"}(T||(T={}));const R=[{label:"Newest first",value:n.b.Descending},{label:"Oldest first",value:n.b.Ascending},{label:"Data source A-Z",value:n.b.DatasourceAZ},{label:"Data source Z-A",value:n.b.DatasourceZA}];class I extends i.PureComponent{constructor(e){super(e),this.onChangeRetentionPeriod=e=>{this.setState({retentionPeriod:e.value}),o.a.set(n.a.retentionPeriod,e.value)},this.toggleStarredTabAsFirstTab=()=>{const e=!this.state.starredTabAsFirstTab;this.setState({starredTabAsFirstTab:e}),o.a.set(n.a.starredTabAsFirstTab,e)},this.toggleActiveDatasourceOnly=()=>{const e=!this.state.activeDatasourceOnly;this.setState({activeDatasourceOnly:e}),o.a.set(n.a.activeDatasourceOnly,e)},this.onSelectDatasourceFilters=e=>{try{o.a.setObject(n.a.datasourceFilters,e)}catch(e){console.error(e)}this.setState({datasourceFilters:e})},this.onChangeSortOrder=e=>this.setState({sortOrder:e}),this.state={sortOrder:n.b.Descending,datasourceFilters:o.a.getObject(n.a.datasourceFilters,null),retentionPeriod:o.a.getObject(n.a.retentionPeriod,7),starredTabAsFirstTab:o.a.getBool(n.a.starredTabAsFirstTab,!1),activeDatasourceOnly:o.a.getBool(n.a.activeDatasourceOnly,!0)}}updateFilters(){this.state.activeDatasourceOnly&&this.props.activeDatasourceInstance?this.onSelectDatasourceFilters([{label:this.props.activeDatasourceInstance,value:this.props.activeDatasourceInstance}]):this.onSelectDatasourceFilters(this.state.datasourceFilters)}componentDidMount(){this.updateFilters()}componentDidUpdate(e,t){this.props.activeDatasourceInstance===e.activeDatasourceInstance&&this.state.activeDatasourceOnly===t.activeDatasourceOnly||this.updateFilters()}render(){const{datasourceFilters:e,sortOrder:t,activeDatasourceOnly:s,retentionPeriod:i}=this.state,{richHistory:n,height:o,exploreId:a,deleteRichHistory:c,onClose:l,firstTab:d}=this.props;let u=[{label:"Query history",value:T.RichHistory,content:Object(p.jsx)(w,{queries:n,sortOrder:t,datasourceFilters:e,activeDatasourceOnly:s,retentionPeriod:i,onChangeSortOrder:this.onChangeSortOrder,onSelectDatasourceFilters:this.onSelectDatasourceFilters,exploreId:a,height:o}),icon:"history"},{label:"Starred",value:T.Starred,content:Object(p.jsx)(C,{queries:n,sortOrder:t,datasourceFilters:e,activeDatasourceOnly:s,onChangeSortOrder:this.onChangeSortOrder,onSelectDatasourceFilters:this.onSelectDatasourceFilters,exploreId:a}),icon:"star"},{label:"Settings",value:T.Settings,content:Object(p.jsx)(m,{retentionPeriod:this.state.retentionPeriod,starredTabAsFirstTab:this.state.starredTabAsFirstTab,activeDatasourceOnly:this.state.activeDatasourceOnly,onChangeRetentionPeriod:this.onChangeRetentionPeriod,toggleStarredTabAsFirstTab:this.toggleStarredTabAsFirstTab,toggleactiveDatasourceOnly:this.toggleActiveDatasourceOnly,deleteRichHistory:c}),icon:"sliders-v-alt"}];return Object(p.jsx)(r.TabbedContainer,{tabs:u,onClose:l,defaultTab:d,closeIconTooltip:"Close query history"})}}const k=Object(r.withTheme)(I)},"6dfA":function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var i=s("kDLi"),n=s("vF1F"),o=s("q1tI"),r=s("nKUr");const a=Object(i.stylesFactory)(e=>({infoBox:n.css`
    margin-top: ${e.spacing.xs};
  `})),c=({children:e})=>{const[t,s]=Object(o.useState)(!1),c=Object(i.useTheme)(),l=a(c);return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("button",{className:"gf-form-label query-keyword pointer",onClick:e=>s(!t),children:["Help",Object(r.jsx)(i.Icon,{name:t?"angle-down":"angle-right"})]}),t&&Object(r.jsx)(i.InfoBox,{className:Object(n.cx)(l.infoBox),children:e})]})}},"75pU":function(e,t){function s(e,t,s,i){var n,o=null==(n=i)||"number"==typeof n||"boolean"==typeof n?i:s(i),r=t.get(o);return void 0===r&&(r=e.call(this,i),t.set(o,r)),r}function i(e,t,s){var i=Array.prototype.slice.call(arguments,3),n=s(i),o=t.get(n);return void 0===o&&(o=e.apply(this,i),t.set(n,o)),o}function n(e,t,s,i,n){return s.bind(t,e,i,n)}function o(e,t){return n(e,this,1===e.length?s:i,t.cache.create(),t.serializer)}function r(){return JSON.stringify(arguments)}function a(){this.cache=Object.create(null)}a.prototype.has=function(e){return e in this.cache},a.prototype.get=function(e){return this.cache[e]},a.prototype.set=function(e,t){this.cache[e]=t};var c={create:function(){return new a}};e.exports=function(e,t){var s=t&&t.cache?t.cache:c,i=t&&t.serializer?t.serializer:r;return(t&&t.strategy?t.strategy:o)(e,{cache:s,serializer:i})},e.exports.strategies={variadic:function(e,t){return n(e,this,i,t.cache.create(),t.serializer)},monadic:function(e,t){return n(e,this,s,t.cache.create(),t.serializer)}}},"8Vg1":function(e,t,s){"use strict";s("q1tI");var i,n=s("/MKj"),o=s("kDLi"),r=s("Obii"),a=s("PbtU"),c=s("p+Sq"),l=s("KyLG"),d=s("5BoW"),u=s("t8hP"),h=s("nKUr");const p={setDashboardQueriesToUpdateOnLoad:l.m};t.a=Object(n.connect)((function(e,{exploreId:t}){const s=e.explore,i=Object(d.a)(e),{datasourceInstance:n,queries:o,originPanelId:r}=s[t];return{exploreId:t,datasourceInstance:n,queries:o,originPanelId:r,splitted:i}}),p)(({originPanelId:e,setDashboardQueriesToUpdateOnLoad:t,queries:s,splitted:n})=>{const l=e&&Number.isInteger(e);if(n||!l)return null;const d=e=>e.map(e=>(delete e.context,delete e.key,e)),p=async({withChanges:i=!1}={})=>{const n=Object(c.a)().getCurrent();if(!n)return;const o=a.a.slugifyForUrl(n.title);i&&t({panelId:e,queries:d(s)});const l={};i||n.panelInEdit?l.editPanel=e:n.panelInView&&(l.viewPanel=e),u.locationService.push(r.urlUtil.renderUrl(`/d/${n.uid}/:${o}`,l))};return Object(h.jsxs)(o.ButtonGroup,{children:[Object(h.jsx)(o.Tooltip,{content:"Return to panel",placement:"bottom",children:Object(h.jsx)(o.ToolbarButton,{"data-testid":"returnButton",title:"Return to panel",onClick:()=>p(),children:i||(i=Object(h.jsx)(o.Icon,{name:"arrow-left"}))})}),Object(h.jsx)(o.ButtonSelect,{"data-testid":"returnButtonWithChanges",options:[{label:"Return to panel with changes",value:""}],onChange:()=>p({withChanges:!0})})]})})},"9BUi":function(e,t,s){"use strict";(function(e){var i=s("q1tI"),n=s("LvDl"),o=s("0cfB"),r=s("/MKj"),a=s("y2tl"),c=s("kYjj"),l=s("Obii"),d=s("Csm0"),u=s("CJUB"),h=s("0H9l"),p=s("VVW4"),g=s("6dfA"),b=s("nKUr");function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}const j=()=>{};class f extends i.PureComponent{constructor(...e){super(...e),this.state={textEditModeEnabled:!1},this.onRunQuery=()=>{const{exploreId:e}=this.props;this.props.runQueries(e)},this.onChange=(e,t)=>{const{datasourceInstance:s,exploreId:i,index:n}=this.props;this.props.changeQuery(i,e,n,t),e&&!t&&s.getHighlighterExpression&&0===n&&this.updateLogsHighlights(e)},this.onClickToggleDisabled=()=>{const{exploreId:e,index:t,query:s}=this.props,i=m({},s,{hide:!s.hide});this.props.changeQuery(e,i,t,!0)},this.onClickRemoveButton=()=>{const{exploreId:e,index:t}=this.props;this.props.removeQueryRowAction({exploreId:e,index:t}),this.props.runQueries(e)},this.onClickToggleEditorMode=()=>{this.setState({textEditModeEnabled:!this.state.textEditModeEnabled})},this.setReactQueryEditor=()=>{var e,t,s;const{datasourceInstance:i}=this.props;let n;if(null!==(e=i.components)&&void 0!==e&&e.ExploreMetricsQueryField)n=i.components.ExploreMetricsQueryField;else if(null!==(t=i.components)&&void 0!==t&&t.ExploreLogsQueryField)n=i.components.ExploreLogsQueryField;else if(null!==(s=i.components)&&void 0!==s&&s.ExploreQueryField)n=i.components.ExploreQueryField;else{var o;n=null===(o=i.components)||void 0===o?void 0:o.QueryEditor}return n},this.renderQueryEditor=()=>{var e;const{datasourceInstance:t,history:s,query:i,exploreEvents:n,range:o,queryResponse:r,exploreId:c}=this.props,l=r.error&&r.error.refId===i.refId?[r.error]:[],d=this.setReactQueryEditor();let u;u=d?Object(b.jsx)(d,{datasource:t,query:i,history:s,onRunQuery:this.onRunQuery,onBlur:j,onChange:this.onChange,data:r,range:o,exploreId:c}):Object(b.jsx)(a.a,{error:l,datasource:t,onQueryChange:this.onChange,onExecuteQuery:this.onRunQuery,initialQuery:i,exploreEvents:n,range:o,textEditModeEnabled:this.state.textEditModeEnabled});const h=null===(e=t.components)||void 0===e?void 0:e.QueryEditorHelp;return Object(b.jsxs)(b.Fragment,{children:[u,h&&Object(b.jsx)(g.a,{children:Object(b.jsx)(h,{onClickExample:e=>this.onChange(e),datasource:t})})]})},this.updateLogsHighlights=Object(n.debounce)(e=>{const{datasourceInstance:t}=this.props;if(t.getHighlighterExpression){const{exploreId:s}=this.props,i=t.getHighlighterExpression(e);this.props.highlightLogsExpressionAction({exploreId:s,expressions:i})}},500)}render(){const{datasourceInstance:e,query:t,queryResponse:s,latency:i}=this.props,o=Object(n.has)(e,"components.QueryCtrl.prototype.toggleEditorMode"),r=s.state===l.LoadingState.NotStarted,a=s.error&&s.error.refId===t.refId?[s.error]:[];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"query-row","aria-label":d.selectors.components.QueryEditorRows.rows,children:[Object(b.jsx)("div",{className:"query-row-field flex-shrink-1",children:this.renderQueryEditor()}),Object(b.jsx)(c.a,{canToggleEditorModes:o,isDisabled:t.hide,isNotStarted:r,latency:i,onClickToggleEditorMode:this.onClickToggleEditorMode,onClickToggleDisabled:this.onClickToggleDisabled,onClickRemoveButton:this.onClickRemoveButton})]}),a.length>0&&Object(b.jsx)(h.a,{queryError:a[0]})]})}}const x={changeQuery:p.d,highlightLogsExpressionAction:u.b,modifyQueries:p.h,removeQueryRowAction:p.j,runQueries:p.k};t.a=Object(o.hot)(e)(Object(r.connect)((function(e,{exploreId:t,index:s}){const i=e.explore[t],{datasourceInstance:n,history:o,queries:r,range:a,absoluteRange:c,queryResponse:l,latency:d,eventBridge:u}=i;return{datasourceInstance:n,history:o,query:r[s],range:a,absoluteRange:c,queryResponse:l,latency:d,exploreEvents:u}}),x)(f))}).call(this,s("3UD+")(e))},Bdd1:function(e,t,s){"use strict";var i=s("q1tI"),n=s.n(i),o=s("vF1F"),r=s("Zss7"),a=s.n(r),c=s("kDLi"),l=s("Obii"),d=function(e,t){var s=Object(i.useRef)((function(){}));Object(i.useEffect)((function(){s.current=e})),Object(i.useEffect)((function(){if(null!==t){var e=setInterval((function(){return s.current()}),t||0);return function(){return clearInterval(e)}}}),[t])},u=s("nKUr");const h=({timeInMs:e,className:t,humanize:s})=>Object(u.jsx)("span",{className:"elapsed-time "+t,children:p(e,s)}),p=(e,t=!1)=>{const s=e/1e3;if(!t)return s.toFixed(1)+"s";const i=Object(l.toDuration)(s,"seconds"),n=i.hours(),o=i.minutes(),r=i.seconds();return n?`${n}h ${o}m ${r}s`:o?`${o}m ${r}s`:r+"s"},g=({resetKey:e,humanize:t,className:s})=>{const[n,o]=Object(i.useState)(0);return d(()=>o(n+150),150),Object(i.useEffect)(()=>o(0),[e]),Object(u.jsx)(h,{timeInMs:n,className:s,humanize:t})};var b;s.d(t,"a",(function(){return j}));class m extends i.PureComponent{constructor(e){super(e),this.liveEndDiv=null,this.scrollContainerRef=n.a.createRef(),this.onScroll=e=>{const{isPaused:t,onPause:s}=this.props,{scrollTop:i,clientHeight:n,scrollHeight:o}=e.currentTarget;o-(i+n)>=5&&!t&&s()},this.rowsToRender=()=>{const{isPaused:e}=this.props;let{logRowsToRender:t=[]}=this.state;return e||(t=t.slice(-100)),t},this.state={logRowsToRender:e.logRows}}static getDerivedStateFromProps(e,t){return e.isPaused?null:{logRowsToRender:e.logRows}}render(){const{theme:e,timeZone:t,onPause:s,onResume:i,isPaused:n}=this.props,r=(e=>({logsRowsLive:o.css`
    label: logs-rows-live;
    font-family: ${e.typography.fontFamily.monospace};
    font-size: ${e.typography.size.sm};
    display: flex;
    flex-flow: column nowrap;
    height: 60vh;
    overflow-y: scroll;
    :first-child {
      margin-top: auto !important;
    }
  `,logsRowFade:o.css`
    label: logs-row-fresh;
    color: ${e.colors.text};
    background-color: ${a()(e.palette.blue95).setAlpha(.25).toString()};
    animation: fade 1s ease-out 1s 1 normal forwards;
    @keyframes fade {
      from {
        background-color: ${a()(e.palette.blue95).setAlpha(.25).toString()};
      }
      to {
        background-color: transparent;
      }
    }
  `,logsRowsIndicator:o.css`
    font-size: ${e.typography.size.md};
    padding-top: ${e.spacing.sm};
    display: flex;
    align-items: center;
  `,button:o.css`
    margin-right: ${e.spacing.sm};
  `,fullWidth:o.css`
    width: 100%;
  `}))(e),{logsRow:d,logsRowLocalTime:h,logsRowMessage:p}=Object(c.getLogRowStyles)(e);return Object(u.jsxs)("div",{children:[Object(u.jsx)("table",{className:r.fullWidth,children:Object(u.jsxs)("tbody",{onScroll:n?void 0:this.onScroll,className:Object(o.cx)(["logs-rows",r.logsRowsLive]),ref:this.scrollContainerRef,children:[this.rowsToRender().map(e=>Object(u.jsxs)("tr",{className:Object(o.cx)(d,r.logsRowFade),children:[Object(u.jsx)("td",{className:Object(o.cx)(h),children:Object(l.dateTimeFormat)(e.timeEpochMs,{timeZone:t})}),Object(u.jsx)("td",{className:Object(o.cx)(p),children:e.hasAnsi?Object(u.jsx)(c.LogMessageAnsi,{value:e.raw}):e.entry})]},e.uid)),Object(u.jsx)("tr",{ref:e=>{var t;(this.liveEndDiv=e,this.liveEndDiv&&!n)&&(null===(t=this.scrollContainerRef.current)||void 0===t||t.scrollTo(0,this.scrollContainerRef.current.scrollHeight))}})]})}),Object(u.jsxs)("div",{className:r.logsRowsIndicator,children:[Object(u.jsxs)(c.Button,{variant:"secondary",onClick:n?i:s,className:r.button,children:[Object(u.jsx)(c.Icon,{name:n?"play":"pause"})," ",n?"Resume":"Pause"]}),Object(u.jsxs)(c.Button,{variant:"secondary",onClick:this.props.stopLive,className:r.button,children:[b||(b=Object(u.jsx)(c.Icon,{name:"square-shape",size:"lg",type:"mono"})),"  Exit live mode"]}),n||Object(u.jsxs)("span",{children:["Last line received: ",Object(u.jsx)(g,{resetKey:this.props.logRows,humanize:!0})," ago"]})]})]})}}const j=Object(c.withTheme)(m)},JW4h:function(e,t,s){"use strict";(function(e){var i=s("q1tI"),n=s("/MKj"),o=s("0cfB"),r=s("SMGL"),a=s("w9yp"),c=s("6Pa6"),l=s("7oGG"),d=s("x7/r"),u=s("nKUr");const h={deleteRichHistory:l.a};t.a=Object(o.hot)(e)(Object(n.connect)((function(e,{exploreId:t}){const s=e.explore,i=s[t],{datasourceInstance:n}=i,o=r.a.getBool(a.a.starredTabAsFirstTab,!1)?c.b.Starred:c.b.RichHistory,{richHistory:l}=s;return{richHistory:l,firstTab:o,activeDatasourceInstance:null==n?void 0:n.name}}),h)((function(e){const[t,s]=Object(i.useState)(400),{richHistory:n,width:o,firstTab:r,activeDatasourceInstance:a,exploreId:l,deleteRichHistory:h,onClose:p}=e;return Object(u.jsx)(d.a,{width:o,onResize:(e,t,i)=>{s(Number(i.style.height.slice(0,-2)))},children:Object(u.jsx)(c.a,{richHistory:n,firstTab:r,activeDatasourceInstance:a,exploreId:l,deleteRichHistory:h,onClose:p,height:t})})})))}).call(this,s("3UD+")(e))},Mmix:function(e,t,s){"use strict";(function(e){s("q1tI");var i=s("kDLi"),n=s("VVW4"),o=s("0cfB"),r=s("/MKj"),a=s("x7/r"),c=s("HgkN"),l=s("LInY"),d=s("SVrL"),u=s("6PW0"),h=s("qGIo"),p=s("nKUr");const g={runQueries:n.k};t.a=Object(o.hot)(e)(Object(r.connect)((function(e,{exploreId:t}){const s=e.explore[t],{loading:i,queryResponse:n}=s;return{loading:i,queryResponse:n}}),g)((function(e){var t;const{loading:s,width:n,onClose:o,queryResponse:r}=e,g=(null==r?void 0:r.series)||[],b=null==r?void 0:r.error,m={label:"Stats",value:"stats",icon:"chart-line",content:Object(p.jsx)(d.a,{data:r,timeZone:null==r||null===(t=r.request)||void 0===t?void 0:t.timezone})},j={label:"JSON",value:"json",icon:"brackets-curly",content:Object(p.jsx)(c.a,{data:r,onClose:o})},f={label:"Data",value:"data",icon:"database",content:Object(p.jsx)(u.a,{data:g,isLoading:s,options:{withTransforms:!1,withFieldConfig:!1}})},x=[m,{label:"Query",value:"query",icon:"info-circle",content:Object(p.jsx)(l.a,{data:g,onRefreshQuery:()=>e.runQueries(e.exploreId)})},j,f];if(b){const e={label:"Error",value:"error",icon:"exclamation-triangle",content:Object(p.jsx)(h.a,{error:b})};x.push(e)}return Object(p.jsx)(a.a,{width:n,onResize:()=>{},children:Object(p.jsx)(i.TabbedContainer,{tabs:x,onClose:o,closeIconTooltip:"Close query inspector"})})})))}).call(this,s("3UD+")(e))},Nxm2:function(e,t,s){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(e,t)},function(e,t){function s(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,s=1,i=arguments.length;s<i;s++)for(var n in t=arguments[s])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=r(s("q1tI")),c={top:{width:"100%",height:"10px",top:"-5px",left:"0px",cursor:"row-resize"},right:{width:"10px",height:"100%",top:"0px",right:"-5px",cursor:"col-resize"},bottom:{width:"100%",height:"10px",bottom:"-5px",left:"0px",cursor:"row-resize"},left:{width:"10px",height:"100%",top:"0px",left:"-5px",cursor:"col-resize"},topRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",top:"-10px",cursor:"ne-resize"},bottomRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",bottom:"-10px",cursor:"se-resize"},bottomLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",bottom:"-10px",cursor:"sw-resize"},topLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",top:"-10px",cursor:"nw-resize"}},l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onMouseDown=function(e){t.props.onResizeStart(e,t.props.direction)},t.onTouchStart=function(e){t.props.onResizeStart(e,t.props.direction)},t}return n(t,e),t.prototype.render=function(){return a.createElement("div",{className:this.props.className||"",style:o(o({position:"absolute",userSelect:"none"},c[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},t}(a.PureComponent);t.Resizer=l},OxIB:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var i=s("q1tI"),n=s("/MKj"),o=s("kDLi"),r=s("vExC"),a=s("VVW4");function c(e){const t=function(e){const t=Object(n.useDispatch)(),s=Object(i.useCallback)(()=>{t(Object(a.n)({exploreId:e,isPaused:!0}))},[e,t]),c=Object(i.useCallback)(()=>{t(Object(a.n)({exploreId:e,isPaused:!1}))},[e,t]),l=Object(i.useCallback)(()=>{s(),t(Object(r.a)(e,o.RefreshPicker.offOption.value)),t(Object(a.k)(e))},[e,t,s]),d=Object(i.useCallback)(()=>{t(Object(r.a)(e,o.RefreshPicker.liveOption.value))},[e,t]);return{pause:s,resume:c,stop:l,start:d}}(e.exploreId);return e.children(t)}},QX5N:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));s("q1tI");var i=s("/MKj"),n=s("Obii"),o=s("0H9l"),r=s("nKUr");function a(e){const t=Object(i.useSelector)(t=>{var s;return null===(s=t.explore[e.exploreId])||void 0===s?void 0:s.queryResponse}),s=(null==t?void 0:t.state)===n.LoadingState.Error&&null!=t&&t.error&&!t.error.refId?t.error:void 0;return Object(r.jsx)(o.a,{queryError:s})}},TUgz:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));s("q1tI");var i,n,o,r=s("vF1F"),a=s("kDLi"),c=s("nKUr");const l=()=>{const e=Object(a.useTheme)(),t=Object(c.jsxs)(c.Fragment,{children:[i||(i=Object(c.jsx)(a.Icon,{name:"rocket"})),Object(c.jsx)(c.Fragment,{children:" ProTip: You can also define data sources through configuration files. "}),n||(n=Object(c.jsx)("a",{href:"http://docs.grafana.org/administration/provisioning/#datasources?utm_source=explore",target:"_blank",rel:"noreferrer",className:"text-link",children:"Learn more"}))]}),s=o||(o=Object(c.jsx)(a.LinkButton,{size:"lg",href:"datasources/new",icon:"database",children:"Add data source"})),l=r.css`
    max-width: ${e.breakpoints.lg};
    margin-top: ${e.spacing.md};
    align-self: center;
  `;return Object(c.jsx)(a.CallToActionCard,{callToActionElement:s,className:l,footer:t,message:"Explore requires at least one data source. Once you have added a data source, you can query it here."})}},UpVK:function(e,t,s){"use strict";var i,n=s("q1tI"),o=s.n(n),r=s("kDLi"),a=s("Obii"),c=s("QNYp"),l=s("WnbS"),d=s("/MKj"),u=s("t8hP"),h=s("nKUr");const p=["cluster","hostname","namespace","pod"];function g(e,t){const s=null!=t&&t.length?t:p;return`{${[...e.process.tags,...e.tags].reduce((e,t)=>(s.includes(t.key)&&e.push(`${t.key}="${t.value}"`),e),[]).join(", ")}}`}function b(e){const t=Object(a.dateTime)(e.startTime/1e3-36e5),s=(e.startTime+e.duration)/1e3,i=Object(a.dateTime)(s+5e3);return{from:t,to:i,raw:{from:t.utc().format("YYYYMMDDTHHmmss"),to:i.utc().format("YYYYMMDDTHHmmss")}}}var m=s("TSYQ"),j=s.n(m),f=s("vF1F");function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}const v={Popover({children:e,content:t,overlayClassName:s}){const i=Object(n.useRef)(null);return Object(h.jsx)(r.PopoverController,{content:t,hideAfter:300,children:(t,n,a)=>Object(h.jsxs)(h.Fragment,{children:[i.current&&Object(h.jsx)(r.Popover,x({},a,{referenceElement:i.current,wrapperClassName:s,onMouseLeave:n,onMouseEnter:t})),o.a.cloneElement(e,{ref:i,onMouseEnter:t,onMouseLeave:n})]})})},Tooltip:({children:e,title:t})=>Object(h.jsx)(r.Tooltip,{content:t,children:e}),Icon:()=>null,Dropdown:()=>null,Menu:()=>null,MenuItem:()=>null,Button:({onClick:e,children:t,className:s})=>Object(h.jsx)(r.Button,{variant:"secondary",onClick:e,className:s,children:t}),Divider:function({className:e}){const t=y(Object(r.useTheme)());return Object(h.jsx)("div",{style:{},className:j()(t.Divider,e)})},Input:e=>Object(h.jsx)(r.Input,x({},e)),InputGroup:({children:e,className:t,style:s})=>Object(h.jsx)("span",{className:t,style:s,children:e})},y=Object(r.stylesFactory)(e=>({Divider:f.css`
      display: inline-block;
      background: ${e.isDark?"#242424":"#e8e8e8"};
      width: 1px;
      height: 0.9em;
      margin: 0 8px;
      vertical-align: middle;
    `}));function O(e,t){return e.filter(e=>e.hasChildren).length===t.size}function w(e,t,s){return i=>{const n=t.get(i);if(!n)return;let o;o="tags"===e?n.toggleTags():"process"===e?n.toggleProcess():"warnings"===e?n.toggleWarnings():"references"===e?n.toggleReferences():"stackTraces"===e?n.toggleStackTraces():n.toggleLogs();const r=new Map(t);r.set(i,o),s(r)}}function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}function T(){return{}}function R(e){var t,s,o;const{expandOne:p,collapseOne:m,childrenToggle:j,collapseAll:f,childrenHiddenIDs:x,expandAll:y}=function(){const[e,t]=Object(n.useState)(new Set),s=Object(n.useCallback)((function(s){if(0===e.size)return;let i=-1,n=!0;const o=s.reduce((e,t)=>(t.depth<=i&&(n=!0),n&&e.has(t.spanID)&&(e.delete(t.spanID),n=!1,i=t.depth),e),new Set(e));t(o)}),[e]),i=Object(n.useCallback)((function(s){if(O(s,e))return;let i;const n=s.reduce((e,t)=>(i&&t.depth<=i.depth?(e.add(i.spanID),t.hasChildren&&(i=t)):t.hasChildren&&!e.has(t.spanID)&&(i=t),e),new Set(e));i&&n.add(i.spanID),t(n)}),[e]),o=Object(n.useCallback)((function(){t(new Set)}),[]),r=Object(n.useCallback)((function(s){if(O(s,e))return;const i=s.reduce((e,t)=>(t.hasChildren&&e.add(t.spanID),e),new Set);t(i)}),[e]),a=Object(n.useCallback)((function(s){const i=new Set(e);e.has(s)?i.delete(s):i.add(s),t(i)}),[e]);return{childrenHiddenIDs:e,expandOne:s,collapseOne:i,expandAll:o,collapseAll:r,childrenToggle:a}}(),{detailStates:R,toggleDetail:I,detailLogItemToggle:k,detailLogsToggle:D,detailProcessToggle:F,detailReferencesToggle:L,detailTagsToggle:N,detailWarningsToggle:z,detailStackTracesToggle:E}=function(){const[e,t]=Object(n.useState)(new Map),s=Object(n.useCallback)((function(s){const i=new Map(e);i.has(s)?i.delete(s):i.set(s,new c.DetailState),t(i)}),[e]),i=Object(n.useCallback)((function(s,i){const n=e.get(s);if(!n)return;const o=n.toggleLogItem(i),r=new Map(e);return r.set(s,o),t(r)}),[e]);return{detailStates:e,toggleDetail:s,detailLogItemToggle:i,detailLogsToggle:Object(n.useCallback)(s=>w("logs",e,t)(s),[e]),detailWarningsToggle:Object(n.useCallback)(s=>w("warnings",e,t)(s),[e]),detailStackTracesToggle:Object(n.useCallback)(s=>w("stackTraces",e,t)(s),[e]),detailReferencesToggle:Object(n.useCallback)(s=>w("references",e,t)(s),[e]),detailProcessToggle:Object(n.useCallback)(s=>w("process",e,t)(s),[e]),detailTagsToggle:Object(n.useCallback)(s=>w("tags",e,t)(s),[e])}}(),{removeHoverIndentGuideId:M,addHoverIndentGuideId:B,hoverIndentGuideIds:$}=function(){const[e,t]=Object(n.useState)(new Set);return{hoverIndentGuideIds:e,addHoverIndentGuideId:Object(n.useCallback)((function(e){t(t=>{const s=new Set(t);return s.add(e),s})}),[]),removeHoverIndentGuideId:Object(n.useCallback)((function(e){t(t=>{const s=new Set(t);return s.delete(e),s})}),[])}}(),{viewRange:q,updateViewRangeTime:A,updateNextViewRangeTime:P}=function(){const[e,t]=Object(n.useState)({time:{current:[0,1]}}),s=Object(n.useCallback)((function(e){t(t=>{const s=S({},t.time,e);return S({},t,{time:s})})}),[]);return{viewRange:e,updateViewRangeTime:Object(n.useCallback)((function(e,s){const i={current:[e,s]};t(e=>S({},e,{time:i}))}),[]),updateNextViewRangeTime:s}}(),[Q,H]=Object(n.useState)(.25),[U,W]=Object(n.useState)(!1),_=Object(n.useMemo)(()=>function(e){const t=e[0];if(!t)return null;let s=1===t.fields.length?t.fields[0].values.get(0):function(e){const t=new a.DataFrameView(e),s={};for(let e=0;e<t.length;e++){const i=t.get(e);s[i.serviceName]||(s[i.serviceName]={serviceName:i.serviceName,tags:i.serviceTags})}return{traceID:t.get(0).traceID,processes:s,spans:t.toArray().map(e=>{var t;return C({},e,{duration:1e3*e.duration,startTime:1e3*e.startTime,processID:e.serviceName,flags:0,references:e.parentSpanID?[{refType:"CHILD_OF",spanID:e.parentSpanID,traceID:e.traceID}]:void 0,logs:(null===(t=e.logs)||void 0===t?void 0:t.map(e=>C({},e,{timestamp:1e3*e.timestamp})))||[]})})}}(t);return Object(c.transformTraceData)(s)}(e.dataFrames),[e.dataFrames]),{search:K,setSearch:V,spanFindMatches:G}=function(e){const[t,s]=Object(n.useState)(""),i=Object(n.useMemo)(()=>t&&e?Object(c.filterSpans)(t,e):void 0,[t,e]);return{search:t,setSearch:s,spanFindMatches:i}}(null==_?void 0:_.spans),Z=Object(d.useSelector)(t=>{var s,i;return null===(s=t.explore[e.exploreId])||void 0===s||null===(i=s.datasourceInstance)||void 0===i?void 0:i.name}),Y=null===(t=Object(l.a)().getInstanceSettings(Z))||void 0===t||null===(s=t.jsonData)||void 0===s?void 0:s.tracesToLogs,X=Object(r.useTheme)(),J=Object(n.useMemo)(()=>({type:X.isDark?c.ThemeType.Dark:c.ThemeType.Light,servicesColorPalette:r.colors,components:{TraceName:{fontSize:X.typography.size.lg}}}),[X]),ee=Object(n.useMemo)(()=>({childrenHiddenIDs:x,detailStates:R,hoverIndentGuideIds:$,shouldScrollToFirstUiFindMatch:!1,spanNameColumnWidth:Q,traceID:null==_?void 0:_.traceID}),[x,R,$,Q,null==_?void 0:_.traceID]),te=Object(n.useMemo)(()=>function(e,t){if(null==t||!t.datasourceUid)return;const s=Object(l.a)().getInstanceSettings(t.datasourceUid);return s?function(n){const o={title:s.name,url:"",internal:{datasourceUid:s.uid,datasourceName:s.name,query:{expr:g(n,t.tags),refId:""}}},c=Object(a.mapInternalLinkToExplore)({link:o,internalLink:o.internal,scopedVars:{},range:b(n),field:{},onClickFn:e,replaceVariables:Object(u.getTemplateSrv)().replace.bind(Object(u.getTemplateSrv)())});return{href:c.href,onClick:c.onClick,content:i||(i=Object(h.jsx)(r.Icon,{name:"gf-logs",title:"Explore the logs for this in split view"}))}}:void 0}(e.splitOpenFn,Y),[e.splitOpenFn,Y]),se=document.getElementsByClassName("scrollbar-view")[0],ie=Object(n.useCallback)(()=>W(!U),[U]);return null!==(o=e.dataFrames)&&void 0!==o&&o.length&&_?Object(h.jsx)(c.ThemeProvider,{value:J,children:Object(h.jsxs)(c.UIElementsContext.Provider,{value:v,children:[Object(h.jsx)(c.TracePageHeader,{canCollapse:!1,clearSearch:T,focusUiFindMatches:T,hideMap:!1,hideSummary:!1,nextResult:T,onSlimViewClicked:ie,onTraceGraphViewClicked:T,prevResult:T,resultCount:0,slimView:U,textFilter:null,trace:_,traceGraphView:!1,updateNextViewRangeTime:P,updateViewRangeTime:A,viewRange:q,searchValue:K,onSearchValueChange:V,hideSearchButtons:!0}),Object(h.jsx)(c.TraceTimelineViewer,{registerAccessors:T,scrollToFirstVisibleSpan:T,findMatchesIDs:G,trace:_,traceTimeline:ee,updateNextViewRangeTime:P,updateViewRangeTime:A,viewRange:q,focusSpan:T,createLinkToExternalSpan:T,setSpanNameColumnWidth:H,collapseAll:f,collapseOne:m,expandAll:y,expandOne:p,childrenToggle:j,clearShouldScrollToFirstUiFindMatch:T,detailLogItemToggle:k,detailLogsToggle:D,detailWarningsToggle:z,detailStackTracesToggle:E,detailReferencesToggle:L,detailProcessToggle:F,detailTagsToggle:N,detailToggle:I,setTrace:T,addHoverIndentGuideId:B,removeHoverIndentGuideId:M,linksGetter:T,uiFind:K,createSpanLink:te,scrollElement:se})]})}):null}function I(e){const{dataFrames:t,splitOpenFn:s,exploreId:i}=e;return Object(h.jsx)(r.Collapse,{label:"Trace View",isOpen:!0,children:Object(h.jsx)(R,{exploreId:i,dataFrames:t,splitOpenFn:s})})}s.d(t,"a",(function(){return I}))},WGjm:function(e,t,s){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(e,t)},function(e,t){function s(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,s=1,i=arguments.length;s<i;s++)for(var n in t=arguments[s])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=r(s("q1tI")),l=s("Nxm2"),d=a(s("75pU")),u={width:"auto",height:"auto"},h=d.default((function(e,t,s){return Math.max(Math.min(e,s),t)})),p=d.default((function(e,t){return Math.round(e/t)*t})),g=d.default((function(e,t){return new RegExp(e,"i").test(t)})),b=d.default((function(e,t,s){void 0===s&&(s=0);var i=t.reduce((function(s,i,n){return Math.abs(i-e)<Math.abs(t[s]-e)?n:s}),0),n=Math.abs(t[i]-e);return 0===s||n<s?t[i]:e})),m=d.default((function(e,t){return e.substr(e.length-t.length,t.length)===t})),j=d.default((function(e){return"auto"===(e=e.toString())||m(e,"px")||m(e,"%")||m(e,"vh")||m(e,"vw")||m(e,"vmax")||m(e,"vmin")?e:e+"px"})),f=function(e,t){if(e&&"string"==typeof e){if(m(e,"%"))return t*(s=Number(e.replace("%",""))/100);if(m(e,"vw")){var s=Number(e.replace("vw",""))/100;return window.innerWidth*s}if(m(e,"vh")){s=Number(e.replace("vh",""))/100;return window.innerHeight*s}}return e},x=d.default((function(e,t,s,i,n){return t=f(t,e.width),s=f(s,e.height),i=f(i,e.width),n=f(n,e.height),{maxWidth:void 0===t?void 0:Number(t),maxHeight:void 0===s?void 0:Number(s),minWidth:void 0===i?void 0:Number(i),minHeight:void 0===n?void 0:Number(n)}})),v=["style","className","grid","snap","bounds","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],y=function(e){function t(t){var s=e.call(this,t)||this;return s.ratio=1,s.resizable=null,s.parentLeft=0,s.parentTop=0,s.resizableLeft=0,s.resizableTop=0,s.targetLeft=0,s.targetTop=0,s.ref=function(e){e&&(s.resizable=e)},s.state={isResizing:!1,width:void 0===(s.propsSize&&s.propsSize.width)?"auto":s.propsSize&&s.propsSize.width,height:void 0===(s.propsSize&&s.propsSize.height)?"auto":s.propsSize&&s.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"}},s.onResizeStart=s.onResizeStart.bind(s),s.onMouseMove=s.onMouseMove.bind(s),s.onMouseUp=s.onMouseUp.bind(s),s}return n(t,e),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||u},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"base",{get:function(){var e=this.parentNode;if(e)for(var t=0,s=[].slice.call(e.children);t<s.length;t++){var i=s[t];if(i instanceof HTMLElement&&i.classList.contains("__resizable_base__"))return i}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var e=0,t=0;if("undefined"!=typeof window&&this.resizable){var s=this.resizable.offsetWidth,i=this.resizable.offsetHeight,n=this.resizable.style.position;"relative"!==n&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:s,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:i,this.resizable.style.position=n}return{width:e,height:t}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var e=this,t=this.props.size,s=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&m(e.propsSize[t].toString(),"%")){if(m(e.state[t].toString(),"%"))return e.state[t].toString();var s=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/s[t]*100+"%"}return j(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?j(t.width):s("width"),height:t&&void 0!==t.height&&!this.state.isResizing?j(t.height):s("height")}},enumerable:!0,configurable:!0}),t.prototype.getParentSize=function(){if(!this.base||!this.parentNode)return{width:window.innerWidth,height:window.innerHeight};var e=!1,t=this.parentNode.style.flexWrap,s=this.base.style.minWidth;"wrap"!==t&&(e=!0,this.parentNode.style.flexWrap="wrap"),this.base.style.position="relative",this.base.style.minWidth="100%";var i={width:this.base.offsetWidth,height:this.base.offsetHeight};return this.base.style.position="absolute",e&&(this.parentNode.style.flexWrap=t),this.base.style.minWidth=s,i},t.prototype.bindEvents=function(){"undefined"!=typeof window&&(window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseleave",this.onMouseUp),window.addEventListener("touchmove",this.onMouseMove),window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){"undefined"!=typeof window&&(window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseleave",this.onMouseUp),window.removeEventListener("touchmove",this.onMouseMove),window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){if(this.resizable){var e=window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:"auto"!==e.flexBasis?e.flexBasis:void 0});var t=this.parentNode;if(t instanceof HTMLElement&&!this.base){var s=document.createElement("div");s.style.width="100%",s.style.height="100%",s.style.position="absolute",s.style.transform="scale(0, 0)",s.style.left="0",s.style.flex="0",s.classList?s.classList.add("__resizable_base__"):s.className+="__resizable_base__",t.appendChild(s)}}},t.prototype.componentWillUnmount=function(){if("undefined"!=typeof window){this.unbindEvents();var e=this.parentNode;if(!this.base||!e)return;if(!(e instanceof HTMLElement&&this.base instanceof Node))return;e.removeChild(this.base)}},t.prototype.createSizeForCssProperty=function(e,t){var s=this.propsSize&&this.propsSize[t];return"auto"!==this.state[t]||this.state.original[t]!==e||void 0!==s&&"auto"!==s?e:"auto"},t.prototype.calculateNewMaxFromBoundary=function(e,t){if("parent"===this.props.bounds){var s=this.parentNode;if(s instanceof HTMLElement){var i=s.offsetWidth+(this.parentLeft-this.resizableLeft),n=s.offsetHeight+(this.parentTop-this.resizableTop);e=e&&e<i?e:i,t=t&&t<n?t:n}}else if("window"===this.props.bounds){if("undefined"!=typeof window){i=window.innerWidth-this.resizableLeft,n=window.innerHeight-this.resizableTop;e=e&&e<i?e:i,t=t&&t<n?t:n}}else if(this.props.bounds instanceof HTMLElement){i=this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),n=this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop);e=e&&e<i?e:i,t=t&&t<n?t:n}return{maxWidth:e,maxHeight:t}},t.prototype.calculateNewSizeFromDirection=function(e,t){var s=this.props.scale||1,i=this.props.resizeRatio||1,n=this.state,o=n.direction,r=n.original,a=this.props,c=a.lockAspectRatio,l=a.lockAspectRatioExtraHeight,d=a.lockAspectRatioExtraWidth,u=r.width,h=r.height,p=l||0,b=d||0;return g("right",o)&&(u=r.width+(e-r.x)*i/s,c&&(h=(u-b)/this.ratio+p)),g("left",o)&&(u=r.width-(e-r.x)*i/s,c&&(h=(u-b)/this.ratio+p)),g("bottom",o)&&(h=r.height+(t-r.y)*i/s,c&&(u=(h-p)*this.ratio+b)),g("top",o)&&(h=r.height-(t-r.y)*i/s,c&&(u=(h-p)*this.ratio+b)),{newWidth:u,newHeight:h}},t.prototype.calculateNewSizeFromAspectRatio=function(e,t,s,i){var n=this.props,o=n.lockAspectRatio,r=n.lockAspectRatioExtraHeight,a=n.lockAspectRatioExtraWidth,c=void 0===i.width?10:i.width,l=void 0===s.width||s.width<0?e:s.width,d=void 0===i.height?10:i.height,u=void 0===s.height||s.height<0?t:s.height,p=r||0,g=a||0;if(o){var b=(d-p)*this.ratio+g,m=(u-p)*this.ratio+g,j=(c-g)/this.ratio+p,f=(l-g)/this.ratio+p,x=Math.max(c,b),v=Math.min(l,m),y=Math.max(d,j),O=Math.min(u,f);e=h(e,x,v),t=h(t,y,O)}else e=h(e,c,l),t=h(t,d,u);return{newWidth:e,newHeight:t}},t.prototype.setBoundingClientRect=function(){if("parent"===this.props.bounds){var e=this.parentNode;if(e instanceof HTMLElement){var t=e.getBoundingClientRect();this.parentLeft=t.left,this.parentTop=t.top}}if(this.props.bounds instanceof HTMLElement){var s=this.props.bounds.getBoundingClientRect();this.targetLeft=s.left,this.targetTop=s.top}if(this.resizable){var i=this.resizable.getBoundingClientRect(),n=i.left,o=i.top;this.resizableLeft=n,this.resizableTop=o}},t.prototype.onResizeStart=function(e,t){if(this.resizable){var s,i=0,n=0;if(e.nativeEvent instanceof MouseEvent){if(i=e.nativeEvent.clientX,n=e.nativeEvent.clientY,3===e.nativeEvent.which)return}else e.nativeEvent instanceof TouchEvent&&(i=e.nativeEvent.touches[0].clientX,n=e.nativeEvent.touches[0].clientY);if(this.props.onResizeStart)if(this.resizable)if(!1===this.props.onResizeStart(e,t,this.resizable))return;this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio="number"==typeof this.props.lockAspectRatio?this.props.lockAspectRatio:this.size.width/this.size.height;var r=window.getComputedStyle(this.resizable);if("auto"!==r.flexBasis){var a=this.parentNode;if(a){var c=window.getComputedStyle(a).flexDirection;this.flexDir=c.startsWith("row")?"row":"column",s=r.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var l={original:{x:i,y:n,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:o(o({},this.state.backgroundStyle),{cursor:window.getComputedStyle(e.target).cursor||"auto"}),direction:t,flexBasis:s};this.setState(l)}},t.prototype.onMouseMove=function(e){if(this.state.isResizing&&this.resizable){var t=this.props,s=t.maxWidth,i=t.maxHeight,n=t.minWidth,o=t.minHeight,r=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,a=e instanceof MouseEvent?e.clientY:e.touches[0].clientY,c=this.state,l=c.direction,d=c.original,u=c.width,h=c.height,g=this.getParentSize(),j=x(g,s,i,n,o);s=j.maxWidth,i=j.maxHeight,n=j.minWidth,o=j.minHeight;var f=this.calculateNewSizeFromDirection(r,a),v=f.newHeight,y=f.newWidth,O=this.calculateNewMaxFromBoundary(s,i),w=this.calculateNewSizeFromAspectRatio(y,v,{width:O.maxWidth,height:O.maxHeight},{width:n,height:o});if(y=w.newWidth,v=w.newHeight,this.props.grid){var S=p(y,this.props.grid[0]),C=p(v,this.props.grid[1]),T=this.props.snapGap||0;y=0===T||Math.abs(S-y)<=T?S:y,v=0===T||Math.abs(C-v)<=T?C:v}this.props.snap&&this.props.snap.x&&(y=b(y,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(v=b(v,this.props.snap.y,this.props.snapGap));var R={width:y-d.width,height:v-d.height};if(u&&"string"==typeof u)if(m(u,"%"))y=y/g.width*100+"%";else if(m(u,"vw")){y=y/window.innerWidth*100+"vw"}else if(m(u,"vh")){y=y/window.innerHeight*100+"vh"}if(h&&"string"==typeof h)if(m(h,"%"))v=v/g.height*100+"%";else if(m(h,"vw")){v=v/window.innerWidth*100+"vw"}else if(m(h,"vh")){v=v/window.innerHeight*100+"vh"}var I={width:this.createSizeForCssProperty(y,"width"),height:this.createSizeForCssProperty(v,"height")};"row"===this.flexDir?I.flexBasis=I.width:"column"===this.flexDir&&(I.flexBasis=I.height),this.setState(I),this.props.onResize&&this.props.onResize(e,l,this.resizable,R)}},t.prototype.onMouseUp=function(e){var t=this.state,s=t.isResizing,i=t.direction,n=t.original;if(s&&this.resizable){var r={width:this.size.width-n.width,height:this.size.height-n.height};this.props.onResizeStop&&this.props.onResizeStop(e,i,this.resizable,r),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:o(o({},this.state.backgroundStyle),{cursor:"auto"})})}},t.prototype.updateSize=function(e){this.setState({width:e.width,height:e.height})},t.prototype.renderResizer=function(){var e=this,t=this.props,s=t.enable,i=t.handleStyles,n=t.handleClasses,o=t.handleWrapperStyle,r=t.handleWrapperClass,a=t.handleComponent;if(!s)return null;var d=Object.keys(s).map((function(t){return!1!==s[t]?c.createElement(l.Resizer,{key:t,direction:t,onResizeStart:e.onResizeStart,replaceStyles:i&&i[t],className:n&&n[t]},a&&a[t]?a[t]:null):null}));return c.createElement("span",{className:r,style:o},d)},t.prototype.render=function(){var e=this,t=Object.keys(this.props).reduce((function(t,s){return-1!==v.indexOf(s)||(t[s]=e.props[s]),t}),{}),s=o(o(o({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});return this.state.flexBasis&&(s.flexBasis=this.state.flexBasis),c.createElement("div",o({ref:this.ref,style:s,className:this.props.className},t),this.state.isResizing&&c.createElement("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer())},t.defaultProps={onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(c.PureComponent);t.Resizable=y},WnTU:function(e,t,s){"use strict";s.d(t,"a",(function(){return j}));var i=s("Obii"),n=s("kDLi"),o=s("C6if"),r=s("sA6q"),a=s("W/v1"),c=s("vF1F"),l=s("q1tI"),d=s("Xc1M"),u=s("tLXD"),h=s("jYz7"),p=s("Xmxp"),g=s("3F0C"),b=s("LvDl"),m=s("nKUr");function j({data:e,height:t,timeZone:s,absoluteRange:j,onUpdateTimeRange:x,annotations:v,tooltipDisplayMode:y,splitOpenFn:O,onHiddenSeriesChanged:w}){const S=Object(n.useTheme2)(),[C,T]=Object(l.useState)(!1),[R,I]=Object(l.useState)(1),k=Object(u.a)(e),D=Object(l.useRef)(0);e&&k&&!Object(i.compareArrayValues)(k,e,i.compareDataFrameStructures)&&D.current++;const F=R+D.current,[L,N]=Object(l.useState)({defaults:{color:{mode:i.FieldColorModeId.PaletteClassic},custom:{drawStyle:n.DrawStyle.Line,fillOpacity:0,pointSize:5}},overrides:[]}),z=Object(n.useStyles)(f),E={from:Object(i.dateTime)(j.from),to:Object(i.dateTime)(j.to),raw:{from:Object(i.dateTime)(j.from),to:Object(i.dateTime)(j.to)}},M=Object(l.useMemo)(()=>{const t=Object(i.createFieldConfigRegistry)(Object(o.b)(o.a),"Explore");return Object(i.applyFieldOverrides)({fieldConfig:L,data:e,timeZone:s,replaceVariables:e=>e,theme:S,fieldConfigRegistry:t})},[L,e,s,S]);Object(l.useEffect)(()=>{if(w){const e=[];M.forEach(t=>{t.fields.map(e=>{var t,s,i;return null===(t=e.config)||void 0===t||null===(s=t.custom)||void 0===s||null===(i=s.hideFrom)||void 0===i?void 0:i.viz}).every(b.identity)&&e.push(Object(i.getFrameDisplayName)(t))}),w(e)}},[M,w]);const B=C?M:M.slice(0,20),$=(e,t)=>Object(d.a)({field:e,rowIndex:t,splitOpenFn:O,range:E}),q={eventBus:p.b,onToggleSeriesVisibility(t,s){I(e=>e+1),N(Object(g.a)(t,s,L,e))}};return Object(m.jsxs)(n.PanelContextProvider,{value:q,children:[M.length>20&&!C&&Object(m.jsxs)("div",{className:Object(c.cx)([z.timeSeriesDisclaimer]),children:[Object(m.jsx)(n.Icon,{className:z.disclaimerIcon,name:"exclamation-triangle"}),"Showing only 20 time series. ",Object(m.jsx)("span",{className:Object(c.cx)([z.showAllTimeSeries]),onClick:()=>{D.current++,T(!0)},children:"Show all "+M.length})]}),Object(m.jsx)(h.a,{disableHeight:!0,children:({width:e})=>Object(m.jsx)(n.TimeSeries,{frames:B,structureRev:F,width:e,height:t,timeRange:E,legend:{displayMode:n.LegendDisplayMode.List,placement:"bottom",calcs:[]},timeZone:s,children:(e,t)=>Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(n.ZoomPlugin,{config:e,onZoom:x}),Object(m.jsx)(n.TooltipPlugin,{config:e,data:t,mode:y,timeZone:s}),Object(m.jsx)(r.a,{config:e,data:t,timeZone:s}),v&&Object(m.jsx)(a.a,{config:e,exemplars:v,timeZone:s,getFieldLinks:$})]})})})]})}const f=e=>({timeSeriesDisclaimer:c.css`
    label: time-series-disclaimer;
    width: 300px;
    margin: ${e.spacing.sm} auto;
    padding: 10px 0;
    border-radius: ${e.border.radius.md};
    text-align: center;
    background-color: ${e.colors.bg1};
  `,disclaimerIcon:c.css`
    label: disclaimer-icon;
    color: ${e.palette.yellow};
    margin-right: ${e.spacing.xs};
  `,showAllTimeSeries:c.css`
    label: show-all-time-series;
    cursor: pointer;
    color: ${e.colors.linkExternal};
  `})},ajrG:function(e,t,s){"use strict";(function(e){var i=s("q1tI"),n=s("0cfB"),o=s("/MKj"),r=s("kDDq"),a=s("kDLi"),c=s("sQ2H"),l=s("VVW4"),d=s("vExC"),u=s("1LJY"),h=s("Bdd1"),p=s("gmR8"),g=s("lMcC"),b=s("OxIB"),m=s("Xc1M"),j=s("nKUr");class f extends i.PureComponent{constructor(...e){super(...e),this.onChangeTime=e=>{const{exploreId:t,updateTimeRange:s}=this.props;s({exploreId:t,absoluteRange:e})},this.getLogRowContext=async(e,t)=>{const{datasourceInstance:s}=this.props;return null!=s&&s.getLogRowContext?s.getLogRowContext(e,t):[]},this.showContextToggle=e=>{const{datasourceInstance:t}=this.props;return!(null==t||!t.showContextToggle)&&t.showContextToggle(e)},this.getFieldLinks=(e,t)=>{const{splitOpen:s,range:i}=this.props;return Object(m.a)({field:e,rowIndex:t,splitOpenFn:s,range:i})}}render(){const{loading:e,logsHighlighterExpressions:t,logRows:s,logsMeta:i,logsSeries:n,logsQueries:o,onClickFilterLabel:c,onClickFilterOutLabel:l,onStartScanning:d,onStopScanning:u,absoluteRange:m,timeZone:f,visibleRange:x,scanning:v,range:y,isLive:O,exploreId:w,addResultsToCache:S,clearCache:C}=this.props;if(!s)return null;const T=r.css`
      & > div {
        overflow: visible;
        & > div {
          overflow: visible;
        }
      }
    `;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(g.a,{visible:O,children:Object(j.jsx)(a.Collapse,{label:"Logs",loading:!1,isOpen:!0,children:Object(j.jsx)(b.a,{exploreId:w,children:e=>Object(j.jsx)(h.a,{logRows:s,timeZone:f,stopLive:e.stop,isPaused:this.props.isPaused,onPause:e.pause,onResume:e.resume})})})}),Object(j.jsx)(g.a,{visible:!O,children:Object(j.jsx)(a.Collapse,{label:"Logs",loading:e,isOpen:!0,className:T,children:Object(j.jsx)(p.a,{logRows:s,logsMeta:i,logsSeries:n,logsQueries:o,highlighterExpressions:t,loading:e,onChangeTime:this.onChangeTime,onClickFilterLabel:c,onClickFilterOutLabel:l,onStartScanning:d,onStopScanning:u,absoluteRange:m,visibleRange:x,timeZone:f,scanning:v,scanRange:y.raw,showContextToggle:this.showContextToggle,getRowContext:this.getLogRowContext,getFieldLinks:this.getFieldLinks,addResultsToCache:()=>S(w),clearCache:()=>C(w)})})})]})}}const x={updateTimeRange:d.e,splitOpen:c.h,addResultsToCache:l.b,clearCache:l.e},v=Object(o.connect)((function(e,{exploreId:t}){const s=e.explore[t],{logsHighlighterExpressions:i,logsResult:n,loading:o,scanning:r,datasourceInstance:a,isLive:c,isPaused:l,range:d,absoluteRange:h}=s,p=Object(u.a)(e.user);return{loading:o,logsHighlighterExpressions:i,logRows:null==n?void 0:n.rows,logsMeta:null==n?void 0:n.meta,logsSeries:null==n?void 0:n.series,logsQueries:null==n?void 0:n.queries,visibleRange:null==n?void 0:n.visibleRange,scanning:r,timeZone:p,datasourceInstance:a,isLive:c,isPaused:l,range:d,absoluteRange:h}}),x);t.a=Object(n.hot)(e)(v(f))}).call(this,s("3UD+")(e))},bkob:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return R}));var i=s("q1tI"),n=s("/MKj"),o=s("0cfB"),r=s("TSYQ"),a=s.n(r),c=s("vF1F"),l=s("kDLi"),d=s("t8hP"),u=s("ljRM"),h=s("fD97"),p=s("sQ2H"),g=s("vExC"),b=s("1LJY"),m=s("Gqk0"),j=s("kd/b"),f=s("sQnn"),x=s("nmUH"),v=s("OxIB"),y=s("VVW4"),O=s("8Vg1"),w=s("5BoW"),S=s("nKUr");class C extends i.PureComponent{constructor(...e){super(...e),this.onChangeDatasource=async e=>{this.props.changeDatasource(this.props.exploreId,e.name,{importQueries:!0})},this.onClearAll=()=>{this.props.clearAll(this.props.exploreId)},this.onRunQuery=(e=!1)=>{const{clearCache:t,runQueries:s,cancelQueries:i,exploreId:n}=this.props;return e?i(n):(t(n),s(n))},this.onChangeRefreshInterval=e=>{const{changeRefreshInterval:t,exploreId:s}=this.props;t(s,e)},this.onChangeTimeSync=()=>{const{syncTimes:e,exploreId:t}=this.props;e(t)}}render(){const{datasourceMissing:e,closeSplit:t,exploreId:s,loading:i,range:n,timeZone:o,splitted:r,syncedTimes:h,refreshInterval:p,onChangeTime:g,split:b,hasLiveOption:m,isLive:y,isPaused:w,containerWidth:C,onChangeTimeZone:T}=this.props,R=(r?C<700:C<800)||!1,I=r||C<1210;return Object(S.jsxs)("div",{className:r?"explore-toolbar splitted":"explore-toolbar",children:[Object(S.jsx)("div",{className:"explore-toolbar-item",children:Object(S.jsxs)("div",{className:"explore-toolbar-header",children:[Object(S.jsx)("div",{className:"explore-toolbar-header-title",children:"left"===s&&Object(S.jsxs)("span",{className:"navbar-page-btn",children:[Object(S.jsx)(l.Icon,{name:"compass",size:"lg",className:c.css`
                      margin-right: 6px;
                      margin-bottom: 3px;
                    `}),"Explore"]})}),r&&Object(S.jsx)(l.IconButton,{title:"Close split pane",className:"explore-toolbar-header-close",onClick:()=>t(s),name:"times"})]})}),Object(S.jsx)("div",{className:"explore-toolbar-item",children:Object(S.jsxs)("div",{className:"explore-toolbar-content",children:[e?null:Object(S.jsx)("div",{className:"explore-toolbar-content-item",children:Object(S.jsx)("div",{className:a()("explore-ds-picker",R?"explore-ds-picker--small":""),children:Object(S.jsx)(d.DataSourcePicker,{onChange:this.onChangeDatasource,current:this.props.datasourceName,hideTextValue:R})})}),Object(S.jsxs)(l.ToolbarButtonRow,{children:[Object(S.jsx)(O.a,{exploreId:s}),"left"!==s||r?null:Object(S.jsx)(l.ToolbarButton,{iconOnly:r,title:"Split",onClick:()=>b(),icon:"columns",disabled:y,children:"Split"}),Object(S.jsx)(l.Tooltip,{content:"Copy shortened link",placement:"bottom",children:Object(S.jsx)(l.ToolbarButton,{icon:"share-alt",onClick:()=>Object(u.a)(window.location.href)})}),!y&&Object(S.jsx)(j.a,{exploreId:s,range:n,timeZone:o,onChangeTime:g,splitted:r,syncedTimes:h,onChangeTimeSync:this.onChangeTimeSync,hideText:I,onChangeTimeZone:T}),!y&&Object(S.jsx)(l.ToolbarButton,{title:"Clear all",onClick:this.onClearAll,icon:"trash-alt",iconOnly:r,children:"Clear all"}),Object(S.jsx)(x.a,{refreshInterval:p,onChangeRefreshInterval:this.onChangeRefreshInterval,isSmall:r||I,isLive:y,loading:i||y&&!w,onRun:this.onRunQuery,showDropdown:!y}),p&&Object(S.jsx)(l.SetInterval,{func:this.onRunQuery,interval:p,loading:i}),m&&Object(S.jsx)(v.a,{exploreId:s,children:e=>Object(S.jsx)(f.a,{splitted:r,isLive:y,isPaused:w,start:e.start,pause:e.pause,resume:e.resume,stop:e.stop})})]})]})})]})}}const T={changeDatasource:h.a,changeRefreshInterval:g.a,clearAll:y.f,cancelQueries:y.c,runQueries:y.k,closeSplit:p.g,split:p.h,syncTimes:g.b,onChangeTimeZone:m.i,clearCache:y.e},R=Object(o.hot)(e)(Object(n.connect)((e,{exploreId:t})=>{var s;const i=e.explore.syncedTimes,n=e.explore[t],{datasourceInstance:o,datasourceMissing:r,range:a,refreshInterval:c,loading:l,isLive:d,isPaused:u,containerWidth:h}=n,p=!(null==o||null===(s=o.meta)||void 0===s||!s.streaming);return{datasourceMissing:r,datasourceName:null==o?void 0:o.name,loading:l,range:a,timeZone:Object(b.a)(e.user),splitted:Object(w.a)(e),refreshInterval:c,hasLiveOption:p,isLive:d,isPaused:u,syncedTimes:i,containerWidth:h}},T)(C))}).call(this,s("3UD+")(e))},cAtN:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var i=s("q1tI"),n=s("9BUi"),o=s("nKUr");class r extends i.PureComponent{render(){const{className:e="",exploreId:t,queryKeys:s}=this.props;return Object(o.jsx)("div",{className:e,children:s.map((e,s)=>Object(o.jsx)(n.a,{exploreId:t,index:s},e))})}}},eX1b:function(e,t,s){"use strict";s.r(t);var i=s("q1tI"),n=s.n(i),o=s("/MKj"),r=s("sBLX"),a=s("kDLi"),c=s("sQ2H"),l=s("w9yp"),d=s("Wwog"),u=s("Obii"),h=s("Csm0"),p=s("SMGL"),g=s("CJUB"),b=s("m257"),m=s("1LJY"),j=s("sguS"),f=s("nKUr");class x extends n.a.PureComponent{constructor(e){super(e),this.el=void 0,this.exploreEvents=void 0,this.refreshExplore=e=>{const{exploreId:t,urlQuery:s}=this.props;s!==e&&s!==c.c[t]&&this.props.refreshExplore(t,s)},this.getRef=e=>{this.el=e},this.exploreEvents=new u.EventBusSrv,this.state={openDrawer:void 0}}componentDidMount(){var e,t;const{initialized:s,exploreId:i,initialDatasource:n,initialQueries:o,initialRange:r,originPanelId:a}=this.props,c=null!==(e=null===(t=this.el)||void 0===t?void 0:t.offsetWidth)&&void 0!==e?e:0;s||this.props.initializeExplore(i,n,o,r,c,this.exploreEvents,a)}componentWillUnmount(){this.exploreEvents.removeAllListeners(),this.props.cleanupPaneAction({exploreId:this.props.exploreId})}componentDidUpdate(e){this.refreshExplore(e.urlQuery)}render(){const e=this.props.split?"explore explore-split":"explore";return Object(f.jsx)("div",{className:e,ref:this.getRef,"aria-label":h.selectors.pages.Explore.General.container,children:this.props.initialized&&Object(f.jsx)(j.a,{exploreId:this.props.exploreId})})}}const v=Object(d.default)(b.f),y=Object(d.default)(b.l);const O={initializeExplore:g.c,refreshExplore:g.e,cleanupPaneAction:c.a},w=Object(o.connect)((function(e,t){var s;const i=Object(b.o)(t.urlQuery),n=Object(m.a)(e.user),{datasource:o,queries:r,range:a,originPanelId:c}=i||{},l=o||p.a.get(Object(b.n)(e.user.orgId)),d=v(r),u=a?y(a,n):Object(b.k)(n,b.a);return{initialized:null===(s=e.explore[t.exploreId])||void 0===s?void 0:s.initialized,initialDatasource:l,initialQueries:d,initialRange:u,originPanelId:c}}),O)(x);var S=s("ibPz"),C=s("lzJ5");const T={resetExploreAction:c.e,richHistoryUpdatedAction:c.f},R=Object(o.connect)(e=>({navModel:Object(C.a)(e.navIndex,"explore")}),T);class I extends i.PureComponent{updatePageDocumentTitle(e){document.title=e?`${e.main.text} - ${S.a.AppTitle}`:S.a.AppTitle}componentWillUnmount(){this.props.resetExploreAction({})}componentDidMount(){c.c.left=void 0,c.c.right=void 0;const e=Object(l.j)();this.props.richHistoryUpdatedAction({richHistory:e}),this.updatePageDocumentTitle(this.props.navModel)}render(){const{left:e,right:t}=this.props.queryParams,s=Boolean(e)&&Boolean(t);return Object(f.jsx)("div",{className:"page-scrollbar-wrapper",children:Object(f.jsxs)("div",{className:"explore-wrapper",children:[Object(f.jsx)(a.ErrorBoundaryAlert,{style:"page",children:Object(f.jsx)(w,{split:s,exploreId:r.a.left,urlQuery:e})}),s&&Object(f.jsx)(a.ErrorBoundaryAlert,{style:"page",children:Object(f.jsx)(w,{split:s,exploreId:r.a.right,urlQuery:t})})]})})}}const k=R(I);t.default=k},gmR8:function(e,t,s){"use strict";var i,n=s("q1tI"),o=s.n(n),r=s("vF1F"),a=s("LvDl"),c=s("Wwog"),l=s("Obii"),d=s("kDLi"),u=s("SMGL"),h=s("QJHg"),p=s("o3yI"),g=s("h1VQ"),b=s("nKUr");const m=o.a.memo(({meta:e,dedupStrategy:t,dedupCount:s,showDetectedFields:n,clearDetectedFields:o,hasUnescapedContent:r,forceEscape:a,onEscapeNewlines:c,logRows:u})=>{const h=[...e];return t!==l.LogsDedupStrategy.none&&h.push({label:"Dedup count",value:s,kind:l.LogsMetaKind.Number}),u.some(e=>e.entry.length>p.b)&&h.push({label:"Info",value:"Logs with more than 100,000 characters could not be parsed and highlighted",kind:l.LogsMetaKind.String}),(null==n?void 0:n.length)>0&&h.push({label:"Showing only detected fields",value:j(n,l.LogsMetaKind.LabelsMap)},{label:"",value:Object(b.jsx)(d.Button,{variant:"secondary",size:"sm",onClick:o,children:"Show all detected fields"})}),r&&h.push({label:"Your logs might have incorrectly escaped content",value:Object(b.jsx)(d.Tooltip,{content:"We suggest to try to fix the escaping of your log lines first. This is an experimental feature, your logs might not be correctly escaped.",placement:"right",children:Object(b.jsxs)(d.Button,{variant:"secondary",size:"sm",onClick:c,children:[Object(b.jsxs)("span",{children:[a?"Remove escaping":"Escape newlines"," "]}),i||(i=Object(b.jsx)(d.Icon,{name:"exclamation-triangle",className:"muted",size:"sm"}))]})})}),Object(b.jsx)(b.Fragment,{children:h&&Object(b.jsx)(g.a,{metaItems:h.map(e=>({label:e.label,value:"kind"in e?j(e.value,e.kind):e.value}))})})});function j(e,t){return t===l.LogsMetaKind.LabelsMap?Object(b.jsx)("span",{className:"logs-meta-item__labels",children:Object(b.jsx)(d.LogLabels,{labels:e})}):t===l.LogsMetaKind.Error?Object(b.jsx)("span",{className:"logs-meta-item__error",children:e}):e}m.displayName="LogsMetaRow";var f,x=s("kDDq");function v({pages:e,currentPageIndex:t,oldestLogsFirst:s,timeZone:i,loading:n,changeTime:o}){const r=e=>""+Object(l.dateTimeFormat)(e,{format:l.systemDateFormats.interval.second,timeZone:i}),a=(e,i)=>{if(t===i&&n)return f||(f=Object(b.jsx)(d.Spinner,{}));return`${r(s?e.logsRange.from:e.logsRange.to)} — ${r(s?e.logsRange.to:e.logsRange.from)}`},c=Object(d.useTheme)(),u=y(c,n);return Object(b.jsx)(d.CustomScrollbar,{autoHide:!0,children:Object(b.jsx)("div",{className:u.pagesWrapper,"data-testid":"logsNavigationPages",children:Object(b.jsx)("div",{className:u.pagesContainer,children:e.map((e,s)=>Object(b.jsxs)("div",{"data-testid":"page"+(s+1),className:u.page,onClick:()=>!n&&o({from:e.queryRange.from,to:e.queryRange.to}),children:[Object(b.jsx)("div",{className:Object(x.cx)(u.line,{selectedBg:t===s})}),Object(b.jsx)("div",{className:Object(x.cx)(u.time,{selectedText:t===s}),children:a(e,s)})]},e.queryRange.to))})})})}const y=Object(d.stylesFactory)((e,t)=>({pagesWrapper:x.css`
      height: 100%;
      padding-left: ${e.spacing.xs};
      display: flex;
      flex-direction: column;
      overflow-y: scroll;
      &::after {
        content: '';
        display: block;
        background: repeating-linear-gradient(
          135deg,
          ${e.colors.bg1},
          ${e.colors.bg1} 5px,
          ${e.colors.bg2} 5px,
          ${e.colors.bg2} 15px
        );
        width: 3px;
        height: inherit;
        margin-bottom: 8px;
      }
    `,pagesContainer:x.css`
      display: flex;
      padding: 0;
      flex-direction: column;
    `,page:x.css`
      display: flex;
      margin: ${e.spacing.md} 0;
      cursor: ${t?"auto":"pointer"};
      white-space: normal;
      .selectedBg {
        background: ${e.colors.bgBlue2};
      }
      .selectedText {
        color: ${e.colors.bgBlue2};
      }
    `,line:x.css`
      width: 3px;
      height: 100%;
      align-items: center;
      background: ${e.colors.textWeak};
    `,time:x.css`
      width: 60px;
      min-height: 80px;
      font-size: ${e.typography.size.sm};
      padding-left: ${e.spacing.xs};
      display: flex;
      align-items: center;
    `}));var O,w,S;function C({absoluteRange:e,logsSortOrder:t,timeZone:s,loading:i,onChangeTime:o,scrollToTopLogs:r,visibleRange:c,queries:u,clearCache:h,addResultsToCache:p}){const[g,m]=Object(n.useState)([]),[j,f]=Object(n.useState)(0),x=Object(n.useRef)(),y=Object(n.useRef)(),C=Object(n.useRef)(0),T=t===l.LogsSortOrder.Ascending,I=0===j,k=j===g.length-1,D=Object(d.useTheme)(),F=R(D,T,i);Object(n.useEffect)(()=>{const s={logsRange:c,queryRange:e};let i=[];if(Object(a.isEqual)(y.current,e)&&Object(a.isEqual)(x.current,u)){m(e=>(i=e.filter(e=>!Object(a.isEqual)(s.queryRange,e.queryRange)),i=[...i,s].sort((e,s)=>N(e,s,t)),i));const n=i.findIndex(t=>t.queryRange.to===e.to);f(n)}else h(),m([s]),f(0),x.current=u,C.current=e.to-e.from;p()},[c,e,t,u,h,p]),Object(n.useEffect)(()=>()=>h(),[]);const L=({from:e,to:t})=>{y.current={from:e,to:t},o({from:e,to:t})},N=(e,t,s)=>s===l.LogsSortOrder.Ascending?e.queryRange.to>t.queryRange.to?1:-1:e.queryRange.to>t.queryRange.to?-1:1,z=Object(b.jsx)(d.Button,{"data-testid":"olderLogsButton",className:F.navButton,variant:"secondary",onClick:()=>{L(k?{from:c.from-C.current,to:c.from}:{from:g[j+1].queryRange.from,to:g[j+1].queryRange.to})},disabled:i,children:Object(b.jsxs)("div",{className:F.navButtonContent,children:[i?O||(O=Object(b.jsx)(d.Spinner,{})):Object(b.jsx)(d.Icon,{name:T?"angle-up":"angle-down",size:"lg"}),"Older logs"]})}),E=Object(b.jsx)(d.Button,{"data-testid":"newerLogsButton",className:F.navButton,variant:"secondary",onClick:()=>{I||L({from:g[j-1].queryRange.from,to:g[j-1].queryRange.to})},disabled:i||I,children:Object(b.jsxs)("div",{className:F.navButtonContent,children:[i&&(w||(w=Object(b.jsx)(d.Spinner,{}))),I||i?null:Object(b.jsx)(d.Icon,{name:T?"angle-down":"angle-up",size:"lg"}),I?"Start of range":"Newer logs"]})});return Object(b.jsxs)("div",{className:F.navContainer,children:[T?z:E,Object(b.jsx)(v,{pages:g,currentPageIndex:j,oldestLogsFirst:T,timeZone:s,loading:i,changeTime:L}),T?E:z,Object(b.jsx)(d.Button,{"data-testid":"scrollToTop",className:F.scrollToTopButton,variant:"secondary",onClick:r,title:"Scroll to top",children:S||(S=Object(b.jsx)(d.Icon,{name:"arrow-up",size:"lg"}))})]})}var T=Object(n.memo)(C);const R=Object(d.stylesFactory)((e,t,s)=>({navContainer:x.css`
      max-height: 95vh;
      display: flex;
      flex-direction: column;
      justify-content: ${t?"flex-start":"space-between"};
      position: sticky;
      top: ${e.spacing.md};
      right: 0;
    `,navButton:x.css`
      width: 58px;
      height: 68px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      line-height: 1;
    `,navButtonContent:x.css`
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100%;
      white-space: normal;
    `,scrollToTopButton:x.css`
      width: 40px;
      height: 40px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      margin-top: ${e.spacing.sm};
    `}));var I=s("WnTU");s.d(t,"a",(function(){return N}));const k="grafana.explore.logs.showLabels",D="grafana.explore.logs.showTime",F="grafana.explore.logs.wrapLogMessage";class L extends n.PureComponent{constructor(...e){super(...e),this.flipOrderTimer=void 0,this.cancelFlippingTimer=void 0,this.topLogsRef=Object(n.createRef)(),this.state={showLabels:u.a.getBool(k,!1),showTime:u.a.getBool(D,!0),wrapLogMessage:u.a.getBool(F,!0),dedupStrategy:l.LogsDedupStrategy.none,hiddenLogLevels:[],logsSortOrder:null,isFlipping:!1,showDetectedFields:[],forceEscape:!1},this.onChangeLogsSortOrder=()=>{this.setState({isFlipping:!0}),this.flipOrderTimer=setTimeout(()=>{this.setState(e=>null===e.logsSortOrder||e.logsSortOrder===l.LogsSortOrder.Descending?{logsSortOrder:l.LogsSortOrder.Ascending}:{logsSortOrder:l.LogsSortOrder.Descending})},0),this.cancelFlippingTimer=setTimeout(()=>this.setState({isFlipping:!1}),1e3)},this.onEscapeNewlines=()=>{this.setState(e=>({forceEscape:!e.forceEscape}))},this.onChangeDedup=e=>{this.setState({dedupStrategy:e})},this.onChangeLabels=e=>{const t=e&&e.target;if(t){const e=t.checked;this.setState({showLabels:e}),u.a.set(k,e)}},this.onChangeTime=e=>{const t=e&&e.target;if(t){const e=t.checked;this.setState({showTime:e}),u.a.set(D,e)}},this.onChangewrapLogMessage=e=>{const t=e&&e.target;if(t){const e=t.checked;this.setState({wrapLogMessage:e}),u.a.set(F,e)}},this.onToggleLogLevel=e=>{const t=e.map(e=>l.LogLevel[e]);this.setState({hiddenLogLevels:t})},this.onClickScan=e=>{e.preventDefault(),this.props.onStartScanning&&this.props.onStartScanning()},this.onClickStopScan=e=>{e.preventDefault(),this.props.onStopScanning&&this.props.onStopScanning()},this.showDetectedField=e=>{-1===this.state.showDetectedFields.indexOf(e)&&this.setState(t=>({showDetectedFields:t.showDetectedFields.concat(e)}))},this.hideDetectedField=e=>{this.state.showDetectedFields.indexOf(e)>-1&&this.setState(t=>({showDetectedFields:t.showDetectedFields.filter(t=>e!==t)}))},this.clearDetectedFields=()=>{this.setState(e=>({showDetectedFields:[]}))},this.checkUnescapedContent=Object(c.default)(e=>!!e.some(e=>e.hasUnescapedContent)),this.dedupRows=Object(c.default)((e,t)=>{const s=Object(h.b)(e,t),i=s.reduce((e,t)=>t.duplicates?e+t.duplicates:e,0);return{dedupedRows:s,dedupCount:i}}),this.filterRows=Object(c.default)((e,t)=>Object(h.c)(e,new Set(t))),this.scrollToTopLogs=()=>{var e;return null===(e=this.topLogsRef.current)||void 0===e?void 0:e.scrollIntoView()}}componentWillUnmount(){clearTimeout(this.flipOrderTimer),clearTimeout(this.cancelFlippingTimer)}render(){const{logRows:e,logsMeta:t,logsSeries:s,visibleRange:i,highlighterExpressions:n,loading:o=!1,onClickFilterLabel:r,onClickFilterOutLabel:c,timeZone:u,scanning:h,scanRange:p,showContextToggle:g,absoluteRange:j,onChangeTime:f,getFieldLinks:x,theme:v,logsQueries:y,clearCache:O,addResultsToCache:w}=this.props,{showLabels:S,showTime:C,wrapLogMessage:R,dedupStrategy:k,hiddenLogLevels:D,logsSortOrder:F,isFlipping:L,showDetectedFields:N,forceEscape:E}=this.state,M=z(v),B=e&&e.length>0,$=this.checkUnescapedContent(e),q=this.filterRows(e,D),{dedupedRows:A,dedupCount:P}=this.dedupRows(q,k),Q=p?"Scanning "+l.rangeUtil.describeTimeRange(p):"Scanning...";return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{className:M.infoText,children:"This datasource does not support full-range histograms. The graph is based on the logs seen in the response."}),s&&s.length?Object(b.jsx)(I.a,{data:s,height:150,tooltipDisplayMode:d.TooltipDisplayMode.Multi,absoluteRange:i||j,timeZone:u,onUpdateTimeRange:f,onHiddenSeriesChanged:this.onToggleLogLevel}):void 0,Object(b.jsxs)("div",{className:M.logOptions,ref:this.topLogsRef,children:[Object(b.jsxs)(d.InlineFieldRow,{children:[Object(b.jsx)(d.InlineField,{label:"Time",transparent:!0,children:Object(b.jsx)(d.InlineSwitch,{value:C,onChange:this.onChangeTime,transparent:!0})}),Object(b.jsx)(d.InlineField,{label:"Unique labels",transparent:!0,children:Object(b.jsx)(d.InlineSwitch,{value:S,onChange:this.onChangeLabels,transparent:!0})}),Object(b.jsx)(d.InlineField,{label:"Wrap lines",transparent:!0,children:Object(b.jsx)(d.InlineSwitch,{value:R,onChange:this.onChangewrapLogMessage,transparent:!0})}),Object(b.jsx)(d.InlineField,{label:"Dedup",transparent:!0,children:Object(b.jsx)(d.RadioButtonGroup,{options:Object.keys(l.LogsDedupStrategy).map(e=>({label:Object(a.capitalize)(e),value:e,description:l.LogsDedupDescription[e]})),value:k,onChange:this.onChangeDedup,className:M.radioButtons})})]}),Object(b.jsx)(d.Button,{variant:"secondary",disabled:L,title:F===l.LogsSortOrder.Ascending?"Change to newest first":"Change to oldest first","aria-label":"Flip results order",className:M.flipButton,onClick:this.onChangeLogsSortOrder,children:L?"Flipping...":"Flip results order"})]}),Object(b.jsx)(m,{logRows:e,meta:t||[],dedupStrategy:k,dedupCount:P,hasUnescapedContent:$,forceEscape:E,showDetectedFields:N,onEscapeNewlines:this.onEscapeNewlines,clearDetectedFields:this.clearDetectedFields}),Object(b.jsxs)("div",{className:M.logsSection,children:[Object(b.jsx)("div",{className:M.logRows,children:Object(b.jsx)(d.LogRows,{logRows:e,deduplicatedRows:A,dedupStrategy:k,getRowContext:this.props.getRowContext,highlighterExpressions:n,onClickFilterLabel:r,onClickFilterOutLabel:c,showContextToggle:g,showLabels:S,showTime:C,enableLogDetails:!0,forceEscape:E,wrapLogMessage:R,timeZone:u,getFieldLinks:x,logsSortOrder:F,showDetectedFields:N,onClickShowDetectedField:this.showDetectedField,onClickHideDetectedField:this.hideDetectedField})}),Object(b.jsx)(T,{logsSortOrder:F,visibleRange:null!=i?i:j,absoluteRange:j,timeZone:u,onChangeTime:f,loading:o,queries:null!=y?y:[],scrollToTopLogs:this.scrollToTopLogs,addResultsToCache:w,clearCache:O})]}),!o&&!B&&!h&&Object(b.jsxs)("div",{className:M.noData,children:["No logs found.",Object(b.jsx)(d.Button,{size:"xs",fill:"text",onClick:this.onClickScan,children:"Scan for older logs"})]}),h&&Object(b.jsxs)("div",{className:M.noData,children:[Object(b.jsx)("span",{children:Q}),Object(b.jsx)(d.Button,{size:"xs",fill:"text",onClick:this.onClickStopScan,children:"Stop scan"})]})]})}}const N=Object(d.withTheme)(L),z=Object(d.stylesFactory)(e=>({noData:r.css`
      > * {
        margin-left: 0.5em;
      }
    `,logOptions:r.css`
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      flex-wrap: wrap;
      background-color: ${e.colors.bg1};
      padding: ${e.spacing.sm} ${e.spacing.md};
      border-radius: ${e.border.radius.md};
      margin: ${e.spacing.md} 0 ${e.spacing.sm};
      border: 1px solid ${e.colors.border2};
    `,flipButton:r.css`
      margin: ${e.spacing.xs} 0 0 ${e.spacing.sm};
    `,radioButtons:r.css`
      margin: 0 ${e.spacing.sm};
    `,logsSection:r.css`
      display: flex;
      flex-direction: row;
      justify-content: space-between;
    `,logRows:r.css`
      overflow-x: scroll;
    `,infoText:r.css`
      font-size: ${e.typography.size.sm};
      color: ${e.colors.textWeak};
    `}))},h1VQ:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var i=s("q1tI"),n=s("vF1F"),o=s("kDLi"),r=s("nKUr");const a=e=>({metaContainer:n.css`
    flex: 1;
    color: ${e.colors.textWeak};
    margin-bottom: ${e.spacing.d};
    min-width: 30%;
    display: flex;
    flex-wrap: wrap;
  `,metaItem:n.css`
    margin-right: ${e.spacing.d};
    margin-top: ${e.spacing.xs};
    display: flex;
    align-items: baseline;

    .logs-meta-item__error {
      color: ${e.palette.red};
    }
  `,metaLabel:n.css`
    margin-right: calc(${e.spacing.d} / 2);
    font-size: ${e.typography.size.sm};
    font-weight: ${e.typography.weight.semibold};
  `,metaValue:n.css`
    font-family: ${e.typography.fontFamily.monospace};
    font-size: ${e.typography.size.sm};
  `}),c=Object(i.memo)((function(e){const t=Object(o.useStyles)(a),{label:s,value:i}=e;return Object(r.jsxs)("div",{className:t.metaItem,children:[s&&Object(r.jsxs)("span",{className:t.metaLabel,children:[s,":"]}),Object(r.jsx)("span",{className:t.metaValue,children:i})]})})),l=Object(i.memo)((function(e){const t=Object(o.useStyles)(a),{metaItems:s}=e;return Object(r.jsx)("div",{className:t.metaContainer,children:s.map((e,t)=>Object(r.jsx)(c,{label:e.label,value:e.value},`${t}-${e.label}`))})}))},"ir/c":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));s("q1tI");var i=s("vF1F"),n=s("kDLi"),o=s("nKUr");const r=Object(n.stylesFactory)(e=>({containerMargin:i.css`
      margin-top: ${e.spacing.md};
    `}));function a(e){const t=Object(n.useTheme)(),s=r(t);return Object(o.jsx)("div",{className:s.containerMargin,children:Object(o.jsxs)(n.HorizontalGroup,{children:[!e.addQueryRowButtonHidden&&Object(o.jsx)(n.Button,{variant:"secondary","aria-label":"Add row button",onClick:e.onClickAddQueryRowButton,disabled:e.addQueryRowButtonDisabled,icon:"plus",children:"Add query"}),Object(o.jsx)(n.Button,{variant:"secondary","aria-label":"Rich history button",className:Object(i.cx)({"explore-active-button":e.richHistoryButtonActive}),onClick:e.onClickRichHistoryButton,icon:"history",children:"Query history"}),Object(o.jsx)(n.Button,{variant:"secondary","aria-label":"Query inspector button",className:Object(i.cx)({"explore-active-button":e.queryInspectorButtonActive}),onClick:e.onClickQueryInspectorButton,icon:"info-circle",children:"Inspector"})]})})}},kYjj:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));s("q1tI");var i,n,o=s("kDLi"),r=s("nKUr");function a(e){const{canToggleEditorModes:t,onClickToggleEditorMode:s,onClickToggleDisabled:a,onClickRemoveButton:c,isDisabled:l,isNotStarted:d,latency:u}=e;return Object(r.jsxs)("div",{className:"gf-form-inline flex-shrink-0",children:[t&&Object(r.jsx)("div",{className:"gf-form",children:Object(r.jsx)("button",{"aria-label":"Edit mode button",className:"gf-form-label gf-form-label--btn",onClick:s,children:i||(i=Object(r.jsx)(o.Icon,{name:"pen"}))})}),Object(r.jsx)("div",{className:"gf-form",children:Object(r.jsx)("button",{disabled:!0,className:"gf-form-label",title:"Query row latency",children:(h=u,(h/1e3).toFixed(1)+"s")})}),Object(r.jsx)("div",{className:"gf-form",children:Object(r.jsx)("button",{disabled:d,className:"gf-form-label gf-form-label--btn",onClick:a,title:l?"Enable query":"Disable query",children:Object(r.jsx)(o.Icon,{name:l?"eye-slash":"eye"})})}),Object(r.jsx)("div",{className:"gf-form",children:Object(r.jsx)("button",{className:"gf-form-label gf-form-label--btn",onClick:c,title:"Remove query",children:n||(n=Object(r.jsx)(o.Icon,{name:"minus"}))})})]});var h}},"kd/b":function(e,t,s){"use strict";var i=s("q1tI"),n=s("Obii"),o=s("kDLi"),r=s("nKUr");function a(e){const{onClick:t,isSynced:s}=e;return Object(r.jsx)(o.Tooltip,{content:()=>{const{isSynced:t}=e,s=t?"Unsync all views":"Sync all views to this time range";return Object(r.jsx)(r.Fragment,{children:s})},placement:"bottom",children:Object(r.jsx)(o.ToolbarButton,{icon:"link",variant:s?"active":"default","aria-label":s?"Synced times":"Unsynced times",onClick:t})})}var c=s("3Tvq"),l=s("LCjV");function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}s.d(t,"a",(function(){return u}));class u extends i.Component{constructor(...e){super(...e),this.onMoveTimePicker=e=>{const{range:t,onChangeTime:s,timeZone:i}=this.props,{from:o,to:r}=Object(l.a)(e,t);s({from:Object(n.dateTimeForTimeZone)(i,o),to:Object(n.dateTimeForTimeZone)(i,r)})},this.onMoveForward=()=>this.onMoveTimePicker(1),this.onMoveBack=()=>this.onMoveTimePicker(-1),this.onChangeTimePicker=e=>{const t=n.dateMath.isMathString(e.raw.from)?e.raw.from:e.from,s=n.dateMath.isMathString(e.raw.to)?e.raw.to:e.to;this.props.onChangeTime({from:t,to:s})},this.onZoom=()=>{const{range:e,onChangeTime:t,timeZone:s}=this.props,{from:i,to:o}=Object(l.b)(e,2);t({from:Object(n.dateTimeForTimeZone)(s,i),to:Object(n.dateTimeForTimeZone)(s,o)})}}render(){const{range:e,timeZone:t,splitted:s,syncedTimes:i,onChangeTimeSync:n,hideText:o,onChangeTimeZone:l}=this.props,u=s?Object(r.jsx)(a,{onClick:n,isSynced:i}):void 0,h={value:e,timeZone:t,onMoveBackward:this.onMoveBack,onMoveForward:this.onMoveForward,onZoom:this.onZoom,hideText:o};return Object(r.jsx)(c.a,d({},h,{timeSyncButton:u,isSynced:i,onChange:this.onChangeTimePicker,onChangeTimeZone:l}))}}},lMcC:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));s("q1tI");var i=s("Wwog"),n=s("vF1F"),o=s("pQ8y"),r=s("nKUr");const a=Object(i.default)(()=>({logsEnter:n.css`
      label: logsEnter;
      position: absolute;
      opacity: 0;
      height: auto;
      width: 100%;
    `,logsEnterActive:n.css`
      label: logsEnterActive;
      opacity: 1;
      transition: opacity ${500}ms ease-out ${100}ms;
    `,logsExit:n.css`
      label: logsExit;
      position: absolute;
      opacity: 1;
      height: auto;
      width: 100%;
    `,logsExitActive:n.css`
      label: logsExitActive;
      opacity: 0;
      transition: opacity ${500}ms ease-out ${100}ms;
    `}));function c(e){const{visible:t,children:s}=e,i=a();return Object(r.jsx)(o.a,{in:t,mountOnEnter:!0,unmountOnExit:!0,timeout:600,classNames:{enter:i.logsEnter,enterActive:i.logsEnterActive,exit:i.logsExit,exitActive:i.logsExitActive},children:s})}},lz6F:function(e,t,s){"use strict";var i,n=s("q1tI"),o=function(e){var t=Object(n.useState)(e),s=t[0],i=t[1];return[s,Object(n.useCallback)((function(e){i("boolean"==typeof e?e:function(e){return!e})}),[i])]},r=s("kDLi"),a=s("Obii"),c=s("vF1F"),l=s("sQ2H"),d=s("/MKj"),u=s("Xc1M"),h=s("fSYD"),p=s("Jf/B"),g=s("nKUr");s.d(t,"a",(function(){return j}));const b=e=>({warningText:c.css`
    label: warningText;
    font-size: ${e.typography.bodySmall.fontSize};
    color: ${e.colors.text.secondary};
  `});const m={splitOpen:l.h},j=Object(d.connect)((function(e,{exploreId:t}){return{range:e.explore[t].range}}),m)((function(e){var t;const{dataFrames:s,range:n,splitOpen:c,withTraceView:l}=e,d=Object(u.b)(n,c),m=Object(r.useTheme2)(),j=Object(r.useStyles2)(b),f=Object(a.applyFieldOverrides)({fieldConfig:{defaults:{},overrides:[]},data:s,replaceVariables:e=>e,theme:m}),{nodes:x}=Object(p.a)(f),[v,y]=o(!1),O=l&&(null===(t=x[0])||void 0===t?void 0:t.length)>1e3?Object(g.jsxs)("span",{className:j.warningText,children:[" (",x[0].length," nodes, can be slow to load)"]}):null;return Object(g.jsx)(r.Collapse,{label:Object(g.jsxs)("span",{children:["Node graph",O," ",i||(i=Object(g.jsx)(r.Badge,{text:"Beta",color:"blue",icon:"rocket",tooltip:"This visualization is in beta"}))]}),collapsible:l,isOpen:!l||v,onToggle:l?()=>y():void 0,children:Object(g.jsx)("div",{style:{height:l?500:600},children:Object(g.jsx)(h.a,{dataFrames:f,getLinks:d})})})}))},nmUH:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));s("q1tI");var i=s("kDLi"),n=s("NPB1"),o=s("nKUr");function r(e){const{isSmall:t,loading:s,onRun:r,onChangeRefreshInterval:a,refreshInterval:c,showDropdown:l,isLive:d}=e,u=Object(n.a)().getValidIntervals(i.defaultIntervals);let h;return d?null:(t||(h=s?"Cancel":"Run query"),Object(o.jsx)(i.RefreshPicker,{onIntervalChanged:a,value:c,isLoading:s,text:h,intervals:u,isLive:d,onRefresh:()=>r(s),noIntervalPicker:!l,primary:!0}))}},sQnn:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));s("q1tI");var i=s("vF1F"),n=s("pQ8y"),o=s("kDLi"),r=s("nKUr");function a(e){const{start:t,pause:s,resume:i,isLive:a,isPaused:l,stop:d,splitted:u}=e,h=Object(o.useTheme)(),p=c(h),g=a&&!l?"active":"default",b=a?l?i:s:t;return Object(r.jsxs)(o.ButtonGroup,{children:[Object(r.jsx)(o.Tooltip,{content:a&&!l?Object(r.jsx)(r.Fragment,{children:"Pause the live stream"}):Object(r.jsx)(r.Fragment,{children:"Start live stream your logs"}),placement:"bottom",children:Object(r.jsx)(o.ToolbarButton,{iconOnly:u,variant:g,icon:!a||l?"play":"pause",onClick:b,children:a&&l?"Paused":"Live"})}),Object(r.jsx)(n.a,{mountOnEnter:!0,unmountOnExit:!0,timeout:100,in:a,classNames:{enter:p.stopButtonEnter,enterActive:p.stopButtonEnterActive,exit:p.stopButtonExit,exitActive:p.stopButtonExitActive},children:Object(r.jsx)(o.Tooltip,{content:Object(r.jsx)(r.Fragment,{children:"Stop and exit the live stream"}),placement:"bottom",children:Object(r.jsx)(o.ToolbarButton,{variant:g,onClick:d,icon:"square-shape"})})})]})}const c=Object(o.stylesFactory)(e=>({stopButtonEnter:i.css`
      label: stopButtonEnter;
      width: 0;
      opacity: 0;
      overflow: hidden;
    `,stopButtonEnterActive:i.css`
      label: stopButtonEnterActive;
      opacity: 1;
      width: 32px;
    `,stopButtonExit:i.css`
      label: stopButtonExit;
      width: 32px;
      opacity: 1;
      overflow: hidden;
    `,stopButtonExitActive:i.css`
      label: stopButtonExitActive;
      opacity: 0;
      width: 0;
    `}))},sguS:function(e,t,s){"use strict";(function(e){var i,n=s("q1tI"),o=s.n(n),r=s("0cfB"),a=s("vF1F"),c=s("ANjH"),l=s("/MKj"),d=s("jYz7"),u=s("Wwog"),h=s("Csm0"),p=s("kDLi"),g=s("Obii"),b=s("ajrG"),m=s("cAtN"),j=s("zLRG"),f=s("JW4h"),x=s("Mmix"),v=s("sQ2H"),y=s("CJUB"),O=s("vExC"),w=s("VVW4"),S=s("bkob"),C=s("TUgz"),T=s("1LJY"),R=s("ir/c"),I=s("aWEf"),k=s("WnTU"),D=s("lz6F"),F=s("QX5N"),L=s("UpVK"),N=s("nKUr");const z=Object(p.stylesFactory)(e=>({exploreMain:a.css`
      label: exploreMain;
      // Is needed for some transition animations to work.
      position: relative;
      margin-top: 21px;
    `,button:a.css`
      label: button;
      margin: 1em 4px 0 0;
    `,queryContainer:a.css`
      label: queryContainer;
      // Need to override normal css class and don't want to count on ordering of the classes in html.
      height: auto !important;
      flex: unset !important;
      padding: ${e.panelPadding}px;
    `}));var E;!function(e){e[e.RichHistory=0]="RichHistory",e[e.QueryInspector=1]="QueryInspector"}(E||(E={}));class M extends o.a.PureComponent{constructor(e){super(e),this.onChangeTime=e=>{const{updateTimeRange:t,exploreId:s}=this.props;t({exploreId:s,rawRange:e})},this.onClickExample=e=>{this.props.setQueries(this.props.exploreId,[e])},this.onCellFilterAdded=e=>{const{value:t,key:s,operator:i}=e;i===I.a&&this.onClickFilterLabel(s,t),i===I.b&&this.onClickFilterOutLabel(s,t)},this.onClickFilterLabel=(e,t)=>{this.onModifyQueries({type:"ADD_FILTER",key:e,value:t})},this.onClickFilterOutLabel=(e,t)=>{this.onModifyQueries({type:"ADD_FILTER_OUT",key:e,value:t})},this.onClickAddQueryRowButton=()=>{const{exploreId:e,queryKeys:t}=this.props;this.props.addQueryRow(e,t.length)},this.onModifyQueries=(e,t)=>{const{datasourceInstance:s}=this.props;if(null!=s&&s.modifyQuery){const i=(e,t)=>s.modifyQuery(e,t);this.props.modifyQueries(this.props.exploreId,e,i,t)}},this.onResize=e=>{this.props.changeSize(this.props.exploreId,e)},this.onStartScanning=()=>{this.props.scanStart(this.props.exploreId)},this.onStopScanning=()=>{this.props.scanStopAction({exploreId:this.props.exploreId})},this.onUpdateTimeRange=e=>{const{exploreId:t,updateTimeRange:s}=this.props;s({exploreId:t,absoluteRange:e})},this.toggleShowRichHistory=()=>{this.setState(e=>({openDrawer:e.openDrawer===E.RichHistory?void 0:E.RichHistory}))},this.toggleShowQueryInspector=()=>{this.setState(e=>({openDrawer:e.openDrawer===E.QueryInspector?void 0:E.QueryInspector}))},this.getNodeGraphDataFrames=Object(u.default)(e=>e.filter(e=>{var t;return"nodeGraph"===(null===(t=e.meta)||void 0===t?void 0:t.preferredVisualisationType)})),this.state={openDrawer:void 0}}renderEmptyState(){return i||(i=Object(N.jsx)("div",{className:"explore-container",children:Object(N.jsx)(C.a,{})}))}renderGraphPanel(){const{graphResult:e,absoluteRange:t,timeZone:s,splitOpen:i,queryResponse:n,loading:o}=this.props;return Object(N.jsx)(p.Collapse,{label:"Graph",loading:o,isOpen:!0,children:Object(N.jsx)(k.a,{data:e,height:400,tooltipDisplayMode:p.TooltipDisplayMode.Single,absoluteRange:t,timeZone:s,onUpdateTimeRange:this.onUpdateTimeRange,annotations:n.annotations,splitOpenFn:i})})}renderTablePanel(e){const{exploreId:t,datasourceInstance:s}=this.props;return Object(N.jsx)(j.a,{ariaLabel:h.selectors.pages.Explore.General.table,width:e,exploreId:t,onCellFilterAdded:null!=s&&s.modifyQuery?this.onCellFilterAdded:void 0})}renderLogsPanel(){const{exploreId:e,syncedTimes:t}=this.props;return Object(N.jsx)(b.a,{exploreId:e,syncedTimes:t,onClickFilterLabel:this.onClickFilterLabel,onClickFilterOutLabel:this.onClickFilterOutLabel,onStartScanning:this.onStartScanning,onStopScanning:this.onStopScanning})}renderNodeGraphPanel(){const{exploreId:e,showTrace:t,queryResponse:s}=this.props;return Object(N.jsx)(D.a,{dataFrames:this.getNodeGraphDataFrames(s.series),exploreId:e,withTraceView:t})}renderTraceViewPanel(){const{queryResponse:e,splitOpen:t,exploreId:s}=this.props,i=e.series.filter(e=>{var t;return"trace"===(null===(t=e.meta)||void 0===t?void 0:t.preferredVisualisationType)});return i.length&&Object(N.jsx)(L.a,{exploreId:s,dataFrames:i,splitOpenFn:t})}render(){const{datasourceInstance:e,datasourceMissing:t,exploreId:s,queryKeys:i,graphResult:n,queryResponse:o,isLive:r,theme:c,showMetrics:l,showTable:u,showLogs:h,showTrace:b,showNodeGraph:j}=this.props,{openDrawer:v}=this.state,y=z(c),O=o&&o.state!==g.LoadingState.NotStarted,w=v===E.RichHistory,C=v===E.QueryInspector;return Object(N.jsxs)(p.CustomScrollbar,{autoHeightMin:"100%",children:[Object(N.jsx)(S.a,{exploreId:s,onChangeTime:this.onChangeTime}),t?this.renderEmptyState():null,e&&Object(N.jsxs)("div",{className:"explore-container",children:[Object(N.jsxs)("div",{className:Object(a.cx)("panel-container",y.queryContainer),children:[Object(N.jsx)(m.a,{exploreId:s,queryKeys:i}),Object(N.jsx)(R.a,{addQueryRowButtonDisabled:r,addQueryRowButtonHidden:!1,richHistoryButtonActive:w,queryInspectorButtonActive:C,onClickAddQueryRowButton:this.onClickAddQueryRowButton,onClickRichHistoryButton:this.toggleShowRichHistory,onClickQueryInspectorButton:this.toggleShowQueryInspector}),Object(N.jsx)(F.a,{exploreId:s})]}),Object(N.jsx)(d.a,{onResize:this.onResize,disableHeight:!0,children:({width:e})=>0===e?null:Object(N.jsx)("main",{className:Object(a.cx)(y.exploreMain),style:{width:e},children:Object(N.jsxs)(p.ErrorBoundaryAlert,{children:[O&&Object(N.jsxs)(N.Fragment,{children:[l&&n&&Object(N.jsx)(p.ErrorBoundaryAlert,{children:this.renderGraphPanel()}),u&&Object(N.jsx)(p.ErrorBoundaryAlert,{children:this.renderTablePanel(e)}),h&&Object(N.jsx)(p.ErrorBoundaryAlert,{children:this.renderLogsPanel()}),j&&Object(N.jsx)(p.ErrorBoundaryAlert,{children:this.renderNodeGraphPanel()}),b&&Object(N.jsx)(p.ErrorBoundaryAlert,{children:this.renderTraceViewPanel()})]}),w&&Object(N.jsx)(f.a,{width:e,exploreId:s,onClose:this.toggleShowRichHistory}),C&&Object(N.jsx)(x.a,{exploreId:s,width:e,onClose:this.toggleShowQueryInspector})]})})})]})]})}}const B={changeSize:y.a,modifyQueries:w.h,scanStart:w.l,scanStopAction:w.m,setQueries:w.o,updateTimeRange:O.e,addQueryRow:w.a,splitOpen:v.h};t.a=Object(c.compose)(Object(r.hot)(e),Object(l.connect)((function(e,{exploreId:t}){const s=e.explore,{syncedTimes:i}=s,n=s[t],o=Object(T.a)(e.user),{datasourceInstance:r,datasourceMissing:a,queryKeys:c,isLive:l,graphResult:d,logsResult:u,showLogs:h,showMetrics:p,showTable:g,showTrace:b,absoluteRange:m,queryResponse:j,showNodeGraph:f,loading:x}=n;return{datasourceInstance:r,datasourceMissing:a,queryKeys:c,isLive:l,graphResult:d,logsResult:null!=u?u:void 0,absoluteRange:m,queryResponse:j,syncedTimes:i,timeZone:o,showLogs:h,showMetrics:p,showTable:g,showTrace:b,showNodeGraph:f,loading:x}}),B),p.withTheme)(M)}).call(this,s("3UD+")(e))},tLXD:function(e,t,s){"use strict";var i=s("q1tI");t.a=function(e){var t=Object(i.useRef)();return Object(i.useEffect)((function(){t.current=e})),t.current}},vGfD:function(e,t,s){"use strict";(function(e){var i=s("q1tI"),n=s("/MKj"),o=s("0cfB"),r=s("vF1F"),a=s("kDLi"),c=s("t8hP"),l=s("w9yp"),d=s("ljRM"),u=s("m257"),h=s("Xmxp"),p=s("iODs"),g=s("3SGO"),b=s("UvM7"),m=s("7oGG"),j=s("fD97"),f=s("VVW4"),x=s("xAj+"),v=s("nKUr");const y=Object(a.stylesFactory)((e,t)=>{const s=e.colors.bg2;return{queryCard:r.css`
      display: flex;
      flex-direction: column;
      border: 1px solid ${e.colors.border1};
      margin: ${e.spacing.sm} 0;
      background-color: ${s};
      border-radius: ${e.border.radius.sm};
      .starred {
        color: ${e.palette.orange};
      }
    `,cardRow:r.css`
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: ${e.spacing.sm};
      border-bottom: none;
      :first-of-type {
        border-bottom: 1px solid ${e.colors.border1};
        padding: ${e.spacing.xs} ${e.spacing.sm};
      }
      img {
        height: ${e.typography.size.base};
        max-width: ${e.typography.size.base};
        margin-right: ${e.spacing.sm};
      }
    `,datasourceContainer:r.css`
      display: flex;
      align-items: center;
      font-size: ${e.typography.size.sm};
      font-weight: ${e.typography.weight.semibold};
    `,queryActionButtons:r.css`
      max-width: ${"170px"};
      display: flex;
      justify-content: flex-end;
      font-size: ${e.typography.size.base};
      button {
        margin-left: ${e.spacing.sm};
      }
    `,queryContainer:r.css`
      font-weight: ${e.typography.weight.semibold};
      width: calc(100% - ${"240px"});
    `,queryRow:r.css`
      border-top: 1px solid ${e.colors.border1};
      word-break: break-all;
      padding: 4px 2px;
      :first-child {
        border-top: none;
        padding: 0 0 4px 0;
      }
    `,updateCommentContainer:r.css`
      width: calc(100% + ${"240px"});
      margin-top: ${e.spacing.sm};
    `,comment:r.css`
      overflow-wrap: break-word;
      font-size: ${e.typography.size.sm};
      font-weight: ${e.typography.weight.regular};
      margin-top: ${e.spacing.xs};
    `,commentButtonRow:r.css`
      > * {
        margin-right: ${e.spacing.sm};
      }
    `,textArea:r.css`
      width: 100%;
    `,runButton:r.css`
      max-width: ${"170px"};
      display: flex;
      justify-content: flex-end;
      button {
        height: auto;
        padding: ${e.spacing.xs} ${e.spacing.md};
        line-height: 1.4;
        span {
          white-space: normal !important;
        }
      }
    `}});const O={changeDatasource:j.a,updateRichHistory:m.d,setQueries:f.o};t.a=Object(o.hot)(e)(Object(n.connect)((function(e,{exploreId:t}){const s=e.explore,{datasourceInstance:i}=s[t];return{exploreId:t,datasourceInstance:i}}),O)((function(e){var t;const{query:s,dsImg:n,isRemoved:o,updateRichHistory:m,changeDatasource:j,exploreId:f,datasourceInstance:O,setQueries:w}=e,[S,C]=Object(i.useState)(!1),[T,R]=Object(i.useState)(s.comment),[I,k]=Object(i.useState)(void 0);Object(i.useEffect)(()=>{(async()=>{const e=await Object(c.getDataSourceSrv)().get(s.datasourceName);k(e)})()},[s.datasourceName]);const D=Object(a.useTheme)(),F=y(D,o),L=()=>{m(s.ts,"comment",T),C(!1)},N=()=>{C(!1),R(s.comment)},z=Object(v.jsxs)("div",{className:F.updateCommentContainer,"aria-label":T?"Update comment form":"Add comment form",children:[Object(v.jsx)(a.TextArea,{value:T,placeholder:T?void 0:"An optional description of what the query does.",onChange:e=>R(e.currentTarget.value),className:F.textArea}),Object(v.jsxs)("div",{className:F.commentButtonRow,children:[Object(v.jsx)(a.Button,{onClick:L,"aria-label":"Submit button",children:"Save comment"}),Object(v.jsx)(a.Button,{variant:"secondary",onClick:N,children:"Cancel"})]})]}),E=Object(v.jsxs)("div",{className:F.queryActionButtons,children:[Object(v.jsx)(a.IconButton,{name:"comment-alt",onClick:()=>C(!S),title:(null===(t=s.comment)||void 0===t?void 0:t.length)>0?"Edit comment":"Add comment"}),Object(v.jsx)(a.IconButton,{name:"copy",onClick:()=>{const e=s.queries.map(e=>Object(l.e)(e,I)).join("\n");Object(u.e)(e),Object(p.a)(Object(g.b)(Object(b.b)("Query copied to clipboard")))},title:"Copy query to clipboard"}),!o&&Object(v.jsx)(a.IconButton,{name:"share-alt",onClick:async()=>{const e=Object(l.f)(s);await Object(d.a)(e)},title:"Copy shortened link to clipboard"}),Object(v.jsx)(a.IconButton,{name:"trash-alt",title:"Delete query",onClick:()=>{s.starred?h.b.publish(new x.ShowConfirmModalEvent({title:"Delete",text:"Are you sure you want to permanently delete your starred query?",yesText:"Delete",icon:"trash-alt",onConfirm:()=>{m(s.ts,"delete"),Object(p.a)(Object(g.b)(Object(b.b)("Query deleted")))}})):(m(s.ts,"delete"),Object(p.a)(Object(g.b)(Object(b.b)("Query deleted"))))}}),Object(v.jsx)(a.IconButton,{name:s.starred?"favorite":"star",iconType:s.starred?"mono":"default",onClick:()=>{m(s.ts,"starred")},title:s.starred?"Unstar query":"Star query"})]});return Object(v.jsxs)("div",{className:F.queryCard,onKeyDown:e=>{"Enter"===e.key&&(e.shiftKey||e.ctrlKey)&&L(),"Escape"===e.key&&N()},children:[Object(v.jsxs)("div",{className:F.cardRow,children:[Object(v.jsxs)("div",{className:F.datasourceContainer,children:[Object(v.jsx)("img",{src:n,"aria-label":"Data source icon"}),Object(v.jsx)("div",{"aria-label":"Data source name",children:o?"Data source does not exist anymore":s.datasourceName})]}),E]}),Object(v.jsxs)("div",{className:Object(r.cx)(F.cardRow),children:[Object(v.jsxs)("div",{className:F.queryContainer,children:[s.queries.map((e,t)=>{const s=Object(l.e)(e,I);return Object(v.jsx)("div",{"aria-label":"Query text",className:F.queryRow,children:s},`${e}-${t}`)}),!S&&s.comment&&Object(v.jsx)("div",{"aria-label":"Query comment",className:F.comment,children:s.comment}),S&&z]}),!S&&Object(v.jsx)("div",{className:F.runButton,children:Object(v.jsx)(a.Button,{variant:"secondary",onClick:async()=>{const e=s.queries;s.datasourceName!==(null==O?void 0:O.name)?(await j(f,s.datasourceName,{importQueries:!0}),w(f,e)):w(f,e)},disabled:o,children:(null==O?void 0:O.name)===s.datasourceName?"Run query":"Switch data source and run query"})})]})]})})))}).call(this,s("3UD+")(e))},"x7/r":function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));s("q1tI");var i=s("WGjm"),n=s("vF1F"),o=s("kDLi"),r=s("nKUr");const a=n.keyframes`
  0% {
    transform: translateY(400px);
  }

  100% {
    transform: translateY(0px);
  }
`,c=Object(o.stylesFactory)(e=>({container:n.css`
      position: fixed !important;
      bottom: 0;
      background: ${e.colors.background.primary};
      border-top: 1px solid ${e.colors.border.weak};
      margin: ${e.spacing(0,-2,0,-2)};
      box-shadow: ${e.shadows.z3};
      z-index: ${e.zIndex.sidemenu};
    `,drawerActive:n.css`
      opacity: 1;
      animation: 0.5s ease-out ${a};
    `,rzHandle:n.css`
      background: ${e.colors.secondary.main};
      transition: 0.3s background ease-in-out;
      position: relative;
      width: 200px !important;
      height: 7px !important;
      left: calc(50% - 100px) !important;
      top: -4px !important;
      cursor: grab;
      border-radius: 4px;
      &:hover {
        background: ${e.colors.secondary.shade};
      }
    `}));function l(e){const{width:t,children:s,onResize:a}=e,l=Object(o.useTheme2)(),d=c(l),u=t+31.5+"px";return Object(r.jsx)(i.Resizable,{className:Object(n.cx)(d.container,d.drawerActive),defaultSize:{width:u,height:"400px"},handleClasses:{top:d.rzHandle},enable:{top:!0,right:!1,bottom:!1,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},maxHeight:"100vh",maxWidth:u,minWidth:u,onResize:a,children:s})}},y2tl:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var i=s("q1tI"),n=s("t8hP"),o=(s("Vw/f"),s("nKUr"));function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}class a extends i.PureComponent{constructor(...e){super(...e),this.element=void 0,this.component=void 0,this.angularScope=void 0}async componentDidMount(){if(!this.element)return;const{datasource:e,initialQuery:t,exploreEvents:s,range:i}=this.props,o=Object(n.getAngularLoader)(),a=r({datasource:e.name},t),c={ctrl:{datasource:e,target:a,range:i,refresh:()=>{setTimeout(()=>{var e,t,s,i;a.hide!==this.props.initialQuery.hide&&(a.hide=this.props.initialQuery.hide),null===(e=(t=this.props).onQueryChange)||void 0===e||e.call(t,a),null===(s=(i=this.props).onExecuteQuery)||void 0===s||s.call(i)},1)},onQueryChange:()=>{setTimeout(()=>{var e,t;null===(e=(t=this.props).onQueryChange)||void 0===e||e.call(t,a)},1)},events:s,panel:{datasource:e,targets:[a]},dashboard:{}}};this.component=o.load(this.element,c,'<plugin-component type="query-ctrl"> </plugin-component>'),this.angularScope=c.ctrl,setTimeout(()=>{var e,t,s,i;null===(e=(t=this.props).onQueryChange)||void 0===e||e.call(t,a),null===(s=(i=this.props).onExecuteQuery)||void 0===s||s.call(i)},1)}componentDidUpdate(e){const t=e.textEditModeEnabled!==this.props.textEditModeEnabled,s=e.error!==this.props.error;this.component&&(t&&this.angularScope&&this.angularScope.toggleEditorMode&&this.angularScope.toggleEditorMode(),this.angularScope&&(this.angularScope.range=this.props.range),(s||t)&&setTimeout(this.component.digest))}componentWillUnmount(){this.component&&this.component.destroy()}render(){return Object(o.jsx)("div",{className:"gf-form-query",ref:e=>this.element=e,style:{width:"100%"}})}}},zLRG:function(e,t,s){"use strict";(function(e){var i=s("q1tI"),n=s("0cfB"),o=s("/MKj"),r=s("kDLi"),a=s("sQ2H"),c=s("ZFWI"),l=s("eXZ6"),d=s("h1VQ"),u=s("Xc1M"),h=s("nKUr");class p extends i.PureComponent{getTableHeight(){const{tableResult:e}=this.props;return e&&0!==e.length?Math.max(Math.min(600,35*e.length)+35):200}render(){const{loading:e,onCellFilterAdded:t,tableResult:s,width:i,splitOpen:n,range:o,ariaLabel:a}=this.props,p=this.getTableHeight(),g=i-2*c.a.theme.panelPadding-l.j,b=null==s?void 0:s.length;if(s&&s.length)for(const e of s.fields)e.getLinks=t=>Object(u.a)({field:e,rowIndex:t.valueRowIndex,splitOpenFn:n,range:o});return Object(h.jsx)(r.Collapse,{label:"Table",loading:e,isOpen:!0,children:b?Object(h.jsx)(r.Table,{ariaLabel:a,data:s,width:g,height:p,onCellFilterAdded:t}):Object(h.jsx)(d.a,{metaItems:[{value:"0 series returned"}]})})}}const g={splitOpen:a.h};t.a=Object(n.hot)(e)(Object(o.connect)((function(e,{exploreId:t}){const s=e.explore[t],{loading:i,tableResult:n,range:o}=s;return{loading:!(n&&n.length>0)&&i,tableResult:n,range:o}}),g)(p))}).call(this,s("3UD+")(e))}}]);
//# sourceMappingURL=explore.de0e7cb4f02a375bece7.js.map