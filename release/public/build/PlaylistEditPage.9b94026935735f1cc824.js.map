{"version":3,"sources":["webpack:///./public/app/features/playlist/usePlaylist.tsx","webpack:///./public/app/features/playlist/PlaylistEditPage.tsx","webpack:///./node_modules/debounce-promise/dist/index.js","webpack:///./public/app/features/playlist/api.ts","webpack:///./public/app/core/components/Select/DashboardPicker.tsx","webpack:///./public/app/features/playlist/PlaylistTableRow.tsx","webpack:///./public/app/features/playlist/PlaylistTableRows.tsx","webpack:///./public/app/features/playlist/PlaylistTable.tsx","webpack:///./public/app/features/playlist/PlaylistForm.tsx","webpack:///./public/app/features/playlist/usePlaylistItems.tsx","webpack:///./public/app/features/playlist/styles.ts"],"names":["usePlaylist","playlistId","playlist","setPlaylist","useState","items","interval","name","loading","setLoading","useEffect","async","list","getPlaylist","initPlaylist","PlaylistEditPage","navModel","match","styles","useStyles2","getPlaylistStyles","params","id","Contents","isLoading","className","subHeading","description","onSubmit","updatePlaylist","locationService","push","connect","state","getNavModel","navIndex","getWait","wait","defer","deferred","promise","Promise","resolve","reject","module","exports","fn","arguments","length","undefined","options","lastCallAt","timer","pendingArgs","currentWait","currentTime","Date","getTime","isCold","_len","args","Array","_key","leading","accumulate","call","this","then","result","apply","concat","clearTimeout","setTimeout","flush","bind","argsIndex","results","thisDeferred","createPlaylist","withErrorHandling","getBackendSrv","post","put","get","apiCall","dispatch","notifyApp","createSuccessNotification","e","createErrorNotification","getDashboards","query","backendSrv","search","type","map","item","uid","value","label","folderTitle","title","DashboardPicker","onChange","width","isClearable","invalid","disabled","debouncedSearch","debounce","menuShouldPortal","defaultOptions","loadOptions","placeholder","noOptionsMessage","PlaylistTableRow","onDelete","onMoveDown","onMoveUp","first","last","useStyles","getStyles","aria-label","selectors","pages","PlaylistForm","itemRow","cx","td","itemIdType","itemTagType","TagBadge","removeIcon","count","settings","size","onClick","event","preventDefault","itemMoveUp","itemMoveDown","itemDelete","theme","css","spacing","xs","PlaylistTableRows","index","PlaylistTable","searchSrv","SearchSrv","propItems","addById","addByTag","deleteItem","moveDown","moveUp","playlistItems","setItems","useCallback","dashboard","find","newItem","toString","order","tags","tag","movePlaylistItem","offset","newItems","currentPosition","indexOf","newPosition","splice","filter","i","usePlaylistItems","validateOn","register","errors","isDisabled","Object","keys","error","message","required","defaultValue","TagFilter","hideValues","tagOptions","getDashboardTags","variant","href","config","appSubUrl"],"mappings":"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","file":"PlaylistEditPage.9b94026935735f1cc824.js","sourcesContent":["import { useEffect, useState } from 'react';\nimport { Playlist } from './types';\nimport { getPlaylist } from './api';\n\nexport function usePlaylist(playlistId?: number) {\n  const [playlist, setPlaylist] = useState<Playlist>({ items: [], interval: '5m', name: '' });\n  const [loading, setLoading] = useState<boolean>(true);\n\n  useEffect(() => {\n    const initPlaylist = async () => {\n      if (!playlistId) {\n        setLoading(false);\n        return;\n      }\n      const list = await getPlaylist(playlistId);\n      setPlaylist(list);\n      setLoading(false);\n    };\n    initPlaylist();\n  }, [playlistId]);\n\n  return { playlist, loading };\n}\n","import React, { FC } from 'react';\nimport { connect, MapStateToProps } from 'react-redux';\nimport { NavModel } from '@grafana/data';\nimport { locationService } from '@grafana/runtime';\nimport { useStyles2 } from '@grafana/ui';\n\nimport Page from 'app/core/components/Page/Page';\nimport { StoreState } from 'app/types';\nimport { GrafanaRouteComponentProps } from '../../core/navigation/types';\nimport { getNavModel } from 'app/core/selectors/navModel';\nimport { PlaylistForm } from './PlaylistForm';\nimport { updatePlaylist } from './api';\nimport { Playlist } from './types';\nimport { usePlaylist } from './usePlaylist';\nimport { getPlaylistStyles } from './styles';\n\ninterface ConnectedProps {\n  navModel: NavModel;\n}\n\nexport interface RouteParams {\n  id: number;\n}\n\ninterface Props extends ConnectedProps, GrafanaRouteComponentProps<RouteParams> {}\n\nexport const PlaylistEditPage: FC<Props> = ({ navModel, match }) => {\n  const styles = useStyles2(getPlaylistStyles);\n  const { playlist, loading } = usePlaylist(match.params.id);\n  const onSubmit = async (playlist: Playlist) => {\n    await updatePlaylist(match.params.id, playlist);\n    locationService.push('/playlists');\n  };\n\n  return (\n    <Page navModel={navModel}>\n      <Page.Contents isLoading={loading}>\n        <h3 className={styles.subHeading}>Edit playlist</h3>\n\n        <p className={styles.description}>\n          A playlist rotates through a pre-selected list of dashboards. A playlist can be a great way to build\n          situational awareness, or just show off your metrics to your team or visitors.\n        </p>\n\n        <PlaylistForm onSubmit={onSubmit} playlist={playlist} />\n      </Page.Contents>\n    </Page>\n  );\n};\n\nconst mapStateToProps: MapStateToProps<ConnectedProps, {}, StoreState> = (state: StoreState) => ({\n  navModel: getNavModel(state.navIndex, 'playlists'),\n});\n\nexport default connect(mapStateToProps)(PlaylistEditPage);\n","'use strict';\n\n/* global setTimeout, clearTimeout */\n\nmodule.exports = function debounce(fn) {\n  var wait = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  var lastCallAt = void 0;\n  var deferred = void 0;\n  var timer = void 0;\n  var pendingArgs = [];\n  return function debounced() {\n    var currentWait = getWait(wait);\n    var currentTime = new Date().getTime();\n\n    var isCold = !lastCallAt || currentTime - lastCallAt > currentWait;\n\n    lastCallAt = currentTime;\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    if (isCold && options.leading) {\n      return options.accumulate ? Promise.resolve(fn.call(this, [args])).then(function (result) {\n        return result[0];\n      }) : Promise.resolve(fn.call.apply(fn, [this].concat(args)));\n    }\n\n    if (deferred) {\n      clearTimeout(timer);\n    } else {\n      deferred = defer();\n    }\n\n    pendingArgs.push(args);\n    timer = setTimeout(flush.bind(this), currentWait);\n\n    if (options.accumulate) {\n      var argsIndex = pendingArgs.length - 1;\n      return deferred.promise.then(function (results) {\n        return results[argsIndex];\n      });\n    }\n\n    return deferred.promise;\n  };\n\n  function flush() {\n    var thisDeferred = deferred;\n    clearTimeout(timer);\n\n    Promise.resolve(options.accumulate ? fn.call(this, pendingArgs) : fn.apply(this, pendingArgs[pendingArgs.length - 1])).then(thisDeferred.resolve, thisDeferred.reject);\n\n    pendingArgs = [];\n    deferred = null;\n  }\n};\n\nfunction getWait(wait) {\n  return typeof wait === 'function' ? wait() : wait;\n}\n\nfunction defer() {\n  var deferred = {};\n  deferred.promise = new Promise(function (resolve, reject) {\n    deferred.resolve = resolve;\n    deferred.reject = reject;\n  });\n  return deferred;\n}\n//# sourceMappingURL=index.js.map","import { getBackendSrv } from '@grafana/runtime';\n\nimport { Playlist } from './types';\nimport { dispatch } from '../../store/store';\nimport { notifyApp } from '../../core/actions';\nimport { createErrorNotification, createSuccessNotification } from '../../core/copy/appNotification';\n\nexport async function createPlaylist(playlist: Playlist) {\n  await withErrorHandling(async () => await getBackendSrv().post('/api/playlists', playlist));\n}\n\nexport async function updatePlaylist(id: number, playlist: Playlist) {\n  await withErrorHandling(async () => await getBackendSrv().put(`/api/playlists/${id}`, playlist));\n}\n\nexport async function getPlaylist(id: number): Promise<Playlist> {\n  const result: Playlist = await getBackendSrv().get(`/api/playlists/${id}`);\n  return result;\n}\n\nasync function withErrorHandling(apiCall: () => Promise<void>) {\n  try {\n    await apiCall();\n    dispatch(notifyApp(createSuccessNotification('Playlist saved')));\n  } catch (e) {\n    dispatch(notifyApp(createErrorNotification('Unable to save playlist', e)));\n  }\n}\n","import React, { FC } from 'react';\nimport debounce from 'debounce-promise';\nimport { SelectableValue } from '@grafana/data';\nimport { AsyncSelect } from '@grafana/ui';\nimport { backendSrv } from 'app/core/services/backend_srv';\nimport { DashboardSearchHit } from 'app/features/search/types';\n\nexport interface DashboardPickerItem extends Pick<DashboardSearchHit, 'uid' | 'id'> {\n  value: number;\n  label: string;\n}\n\nexport interface Props {\n  onChange: (dashboard: DashboardPickerItem) => void;\n  value?: SelectableValue;\n  width?: number;\n  isClearable?: boolean;\n  invalid?: boolean;\n  disabled?: boolean;\n}\n\nconst getDashboards = (query = '') => {\n  return backendSrv.search({ type: 'dash-db', query }).then((result: DashboardSearchHit[]) => {\n    return result.map((item: DashboardSearchHit) => ({\n      id: item.id,\n      uid: item.uid,\n      value: item.id,\n      label: `${item?.folderTitle ?? 'General'}/${item.title}`,\n    }));\n  });\n};\n\nexport const DashboardPicker: FC<Props> = ({ onChange, value, width, isClearable = false, invalid, disabled }) => {\n  const debouncedSearch = debounce(getDashboards, 300);\n\n  return (\n    <AsyncSelect\n      menuShouldPortal\n      width={width}\n      isClearable={isClearable}\n      defaultOptions={true}\n      loadOptions={debouncedSearch}\n      onChange={onChange}\n      placeholder=\"Select dashboard\"\n      noOptionsMessage=\"No dashboards found\"\n      value={value}\n      invalid={invalid}\n      disabled={disabled}\n    />\n  );\n};\n","import React, { FC, MouseEvent } from 'react';\nimport { css, cx } from '@emotion/css';\nimport { Icon, IconButton, useStyles } from '@grafana/ui';\nimport { GrafanaTheme } from '@grafana/data';\n\nimport { TagBadge } from '../../core/components/TagFilter/TagBadge';\nimport { PlaylistItem } from './types';\nimport { selectors } from '@grafana/e2e-selectors';\n\ninterface PlaylistTableRowProps {\n  first: boolean;\n  last: boolean;\n  item: PlaylistItem;\n  onMoveUp: (item: PlaylistItem) => void;\n  onMoveDown: (item: PlaylistItem) => void;\n  onDelete: (item: PlaylistItem) => void;\n}\n\nexport const PlaylistTableRow: FC<PlaylistTableRowProps> = ({ item, onDelete, onMoveDown, onMoveUp, first, last }) => {\n  const styles = useStyles(getStyles);\n  const onDeleteClick = (event: MouseEvent) => {\n    event.preventDefault();\n    onDelete(item);\n  };\n  const onMoveDownClick = (event: MouseEvent) => {\n    event.preventDefault();\n    onMoveDown(item);\n  };\n  const onMoveUpClick = (event: MouseEvent) => {\n    event.preventDefault();\n    onMoveUp(item);\n  };\n\n  return (\n    <tr aria-label={selectors.pages.PlaylistForm.itemRow} key={item.title}>\n      {item.type === 'dashboard_by_id' ? (\n        <td className={cx(styles.td, styles.item)}>\n          <Icon name=\"apps\" aria-label={selectors.pages.PlaylistForm.itemIdType} />\n          <span>{item.title}</span>\n        </td>\n      ) : null}\n      {item.type === 'dashboard_by_tag' ? (\n        <td className={cx(styles.td, styles.item)}>\n          <Icon name=\"tag-alt\" aria-label={selectors.pages.PlaylistForm.itemTagType} />\n          <TagBadge key={item.id} label={item.title} removeIcon={false} count={0} />\n        </td>\n      ) : null}\n      <td className={cx(styles.td, styles.settings)}>\n        {!first ? (\n          <IconButton\n            name=\"arrow-up\"\n            size=\"md\"\n            onClick={onMoveUpClick}\n            aria-label={selectors.pages.PlaylistForm.itemMoveUp}\n            type=\"button\"\n          />\n        ) : null}\n        {!last ? (\n          <IconButton\n            name=\"arrow-down\"\n            size=\"md\"\n            onClick={onMoveDownClick}\n            aria-label={selectors.pages.PlaylistForm.itemMoveDown}\n            type=\"button\"\n          />\n        ) : null}\n        <IconButton\n          name=\"times\"\n          size=\"md\"\n          onClick={onDeleteClick}\n          aria-label={selectors.pages.PlaylistForm.itemDelete}\n          type=\"button\"\n        />\n      </td>\n    </tr>\n  );\n};\n\nfunction getStyles(theme: GrafanaTheme) {\n  return {\n    td: css`\n      label: td;\n      line-height: 28px;\n      max-width: 335px;\n      white-space: nowrap;\n      text-overflow: ellipsis;\n      overflow: hidden;\n    `,\n    item: css`\n      label: item;\n      span {\n        margin-left: ${theme.spacing.xs};\n      }\n    `,\n    settings: css`\n      label: settings;\n      text-align: right;\n    `,\n  };\n}\n","import React, { FC } from 'react';\n\nimport { PlaylistTableRow } from './PlaylistTableRow';\nimport { PlaylistItem } from './types';\n\ninterface PlaylistTableRowsProps {\n  items: PlaylistItem[];\n  onMoveUp: (item: PlaylistItem) => void;\n  onMoveDown: (item: PlaylistItem) => void;\n  onDelete: (item: PlaylistItem) => void;\n}\n\nexport const PlaylistTableRows: FC<PlaylistTableRowsProps> = ({ items, onMoveUp, onMoveDown, onDelete }) => {\n  if (items.length === 0) {\n    return (\n      <tr>\n        <td>\n          <em>Playlist is empty. Add dashboards below.</em>\n        </td>\n      </tr>\n    );\n  }\n\n  return (\n    <>\n      {items.map((item, index) => {\n        const first = index === 0;\n        const last = index === items.length - 1;\n        return (\n          <PlaylistTableRow\n            first={first}\n            last={last}\n            item={item}\n            onDelete={onDelete}\n            onMoveDown={onMoveDown}\n            onMoveUp={onMoveUp}\n            key={item.title}\n          />\n        );\n      })}\n    </>\n  );\n};\n","import React, { FC } from 'react';\n\nimport { PlaylistTableRows } from './PlaylistTableRows';\nimport { PlaylistItem } from './types';\n\ninterface PlaylistTableProps {\n  items: PlaylistItem[];\n  onMoveUp: (item: PlaylistItem) => void;\n  onMoveDown: (item: PlaylistItem) => void;\n  onDelete: (item: PlaylistItem) => void;\n}\n\nexport const PlaylistTable: FC<PlaylistTableProps> = ({ items, onMoveUp, onMoveDown, onDelete }) => {\n  return (\n    <div className=\"gf-form-group\">\n      <h3 className=\"page-headering\">Dashboards</h3>\n\n      <table className=\"filter-table\">\n        <tbody>\n          <PlaylistTableRows items={items} onMoveUp={onMoveUp} onMoveDown={onMoveDown} onDelete={onDelete} />\n        </tbody>\n      </table>\n    </div>\n  );\n};\n","import React, { FC } from 'react';\nimport { config } from '@grafana/runtime';\nimport { Button, Field, Form, HorizontalGroup, Input, LinkButton } from '@grafana/ui';\nimport { selectors } from '@grafana/e2e-selectors';\n\nimport { Playlist } from './types';\nimport { DashboardPicker } from '../../core/components/Select/DashboardPicker';\nimport { TagFilter } from '../../core/components/TagFilter/TagFilter';\nimport { SearchSrv } from '../../core/services/search_srv';\nimport { usePlaylistItems } from './usePlaylistItems';\nimport { PlaylistTable } from './PlaylistTable';\n\ninterface PlaylistFormProps {\n  onSubmit: (playlist: Playlist) => void;\n  playlist: Playlist;\n}\n\nconst searchSrv = new SearchSrv();\n\nexport const PlaylistForm: FC<PlaylistFormProps> = ({ onSubmit, playlist }) => {\n  const { name, interval, items: propItems } = playlist;\n  const { items, addById, addByTag, deleteItem, moveDown, moveUp } = usePlaylistItems(propItems);\n  return (\n    <>\n      <Form onSubmit={(list: Playlist) => onSubmit({ ...list, items })} validateOn={'onBlur'}>\n        {({ register, errors }) => {\n          const isDisabled = items.length === 0 || Object.keys(errors).length > 0;\n          return (\n            <>\n              <Field label=\"Name\" invalid={!!errors.name} error={errors?.name?.message}>\n                <Input\n                  type=\"text\"\n                  {...register('name', { required: 'Name is required' })}\n                  placeholder=\"Name\"\n                  defaultValue={name}\n                  aria-label={selectors.pages.PlaylistForm.name}\n                />\n              </Field>\n              <Field label=\"Interval\" invalid={!!errors.interval} error={errors?.interval?.message}>\n                <Input\n                  type=\"text\"\n                  {...register('interval', { required: 'Interval is required' })}\n                  placeholder=\"5m\"\n                  defaultValue={interval ?? '5m'}\n                  aria-label={selectors.pages.PlaylistForm.interval}\n                />\n              </Field>\n\n              <PlaylistTable items={items} onMoveUp={moveUp} onMoveDown={moveDown} onDelete={deleteItem} />\n\n              <div className=\"gf-form-group\">\n                <h3 className=\"page-headering\">Add dashboards</h3>\n\n                <Field label=\"Add by title\">\n                  <DashboardPicker onChange={addById} isClearable />\n                </Field>\n\n                <Field label=\"Add by tag\">\n                  <TagFilter\n                    isClearable\n                    tags={[]}\n                    hideValues\n                    tagOptions={searchSrv.getDashboardTags}\n                    onChange={addByTag}\n                    placeholder={''}\n                  />\n                </Field>\n              </div>\n\n              <HorizontalGroup>\n                <Button variant=\"primary\" disabled={isDisabled}>\n                  Save\n                </Button>\n                <LinkButton variant=\"secondary\" href={`${config.appSubUrl}/playlists`}>\n                  Cancel\n                </LinkButton>\n              </HorizontalGroup>\n            </>\n          );\n        }}\n      </Form>\n    </>\n  );\n};\n","import { useCallback, useState } from 'react';\n\nimport { PlaylistItem } from './types';\nimport { DashboardPickerItem } from '../../core/components/Select/DashboardPicker';\n\nexport function usePlaylistItems(playlistItems?: PlaylistItem[]) {\n  const [items, setItems] = useState<PlaylistItem[]>(playlistItems ?? []);\n\n  const addById = useCallback(\n    (dashboard: DashboardPickerItem) => {\n      if (items.find((item) => item.id === dashboard.id)) {\n        return;\n      }\n\n      const newItem: PlaylistItem = {\n        id: dashboard.id,\n        title: dashboard.label,\n        type: 'dashboard_by_id',\n        value: dashboard.id.toString(10),\n        order: items.length + 1,\n      };\n      setItems([...items, newItem]);\n    },\n    [items]\n  );\n\n  const addByTag = useCallback(\n    (tags: string[]) => {\n      const tag = tags[0];\n      if (!tag || items.find((item) => item.value === tag)) {\n        return;\n      }\n\n      const newItem: PlaylistItem = {\n        title: tag,\n        type: 'dashboard_by_tag',\n        value: tag,\n        order: items.length + 1,\n      };\n      setItems([...items, newItem]);\n    },\n    [items]\n  );\n\n  const movePlaylistItem = useCallback(\n    (item: PlaylistItem, offset: number) => {\n      const newItems = [...items];\n      const currentPosition = newItems.indexOf(item);\n      const newPosition = currentPosition + offset;\n\n      if (newPosition >= 0 && newPosition < newItems.length) {\n        newItems.splice(currentPosition, 1);\n        newItems.splice(newPosition, 0, item);\n      }\n      setItems(newItems);\n    },\n    [items]\n  );\n\n  const moveUp = useCallback(\n    (item: PlaylistItem) => {\n      movePlaylistItem(item, -1);\n    },\n    [movePlaylistItem]\n  );\n\n  const moveDown = useCallback(\n    (item: PlaylistItem) => {\n      movePlaylistItem(item, 1);\n    },\n    [movePlaylistItem]\n  );\n\n  const deleteItem = useCallback(\n    (item: PlaylistItem) => {\n      setItems(items.filter((i) => i !== item));\n    },\n    [items]\n  );\n\n  return { items, addById, addByTag, deleteItem, moveDown, moveUp };\n}\n","import { GrafanaTheme2 } from '@grafana/data';\nimport { css } from '@emotion/css';\n\nexport function getPlaylistStyles(theme: GrafanaTheme2) {\n  return {\n    description: css`\n      label: description;\n      width: 555px;\n      margin-bottom: 20px;\n    `,\n    subHeading: css`\n      label: sub-heading;\n      margin-bottom: ${theme.spacing(2)};\n    `,\n  };\n}\n"],"sourceRoot":""}